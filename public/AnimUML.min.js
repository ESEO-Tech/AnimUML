!function(t){function e(e){for(var n,i,a=e[0],o=e[1],c=0,l=[];c<a.length;c++)i=a[c],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&l.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);for(s&&s(e);l.length;)l.shift()()}var n={},r={0:0};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(t){var e=[],n=r[t];if(0!==n)if(n)e.push(n[2]);else{var a=new Promise((function(e,i){n=r[t]=[e,i]}));e.push(n[2]=a);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=function(t){return i.p+""+t+".AnimUML.min.js"}(t);var s=new Error;o=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=r[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,n[1](s)}r[t]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(e)},i.m=t,i.c=n,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i.oe=function(t){throw console.error(t),t};var a=window.webpackJsonp=window.webpackJsonp||[],o=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var s=o;i(i.s=23)}([function(t,e,n){"use strict";function r(t,e){return t[0]<e[0]?-1:1}function i(t){return Array.from(new Set(t))}function a(t){return t[t.length-1]}function o(t){return t&&t.replace(/\\/,"\\\\").replace(/\n/g,"\\n    ").replace(/{/g,"<U+007B>")}function c(t,e){return t.map((t,n)=>[t,e[n]])}function s(t,e){var n,r,i=0;return(n=t.split(""),r=e.split(""),c(n,r).map((t,e)=>{var[n,r]=t;return((t,e)=>t===e)(n,r)})).every(t=>t&&++i),[t.slice(i),e.slice(i)]}function l(t,e){t&&Object.entries(t).forEach(t=>{var[n,r]=t;return e(n,r)})}function u(t){return t&&t.length&&0<t.length}function d(t,e){var n=t.indexOf(e);0<=n&&t.splice(n,1)}function p(t){var e;return null===(e=t.selectedOptions[0])||void 0===e?void 0:e.innerText}function f(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i of n){var a=t(i);globalThis[i]=a}}n.d(e,"b",(function(){return r})),n.d(e,"j",(function(){return i})),n.d(e,"h",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"k",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"c",(function(){return f}))},function(t,e,n){"use strict";function r(t){function e(t){return t.replace(new RegExp("^".concat(c),"mg"),"")}function n(t){return"number"==typeof t?t:t.replace(/\n/g,"\n".concat(l))}for(var r=arguments.length,i=Array(1<r?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o=t[0].replace(/\s*\n/,""),c=o.replace(/^(\s*)[\s\S]*$/,"$1"),s=e(o),l="";return i.forEach((r,a)=>{var o=e(t[a+1]);""===(r=Array.isArray(r)?r.map(n).join("\n".concat(l)):0==r||r?n(r):"")?s.match(/\n\s*$/)&&o.match(/^\s*\n/)&&(s=s.replace(/\n\s*$/,"")):s+=r,a==i.length-1&&(o=o.trimEnd()),s+=o,l=o.replace(/^[\s\S]*\n/,"")}),s}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){var e=t.replace(/ /g,"_SPACE_");return 1<t.length&&(e=e.replace(/\[/g,"_LSQUARE_").replace(/]/g,"_RSQUARE_")),e}function i(t,e){return t+"\0".repeat(e-t.length)}function a(t,e){return t+"\0".repeat(e-t.length)}function o(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"0000644",r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"00000000000",o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"0000000",c=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"0000000",s="";s+=a(t,100),s+=a(n,8),s+=a(o,8),s+=a(c,8),s+=a(e.length.toString(8),12);var l=(s+=a(r,12)).length;s+=a("        ",8),s+=a("0",1),s=i(s+=a("",100),512);var u=Array.prototype.map.call(s,t=>t.charCodeAt(0)).reduce((t,e)=>t+e).toString(8).padStart(6,"0")+"\0 ";return s=s.slice(0,l)+u+s.slice(l+8),s=i(s+=e,512*(Math.floor((s.length-1)/512)+1))}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var r="&#9003;";function i(t){return t?"\n\t\tskinparam hyperlinkColor black\n\t\tskinparam hyperlinkUnderline false\n\t":""}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(0);function i(t){var e=Object.values(t.connectorByName||{}).flatMap(t=>t.ends.map(t=>t.name||t)),n=t.objects?t.objects.map(o).slice(0).filter(t=>!(JSON.stringify(t).match(/^{"name":"[^"]*"}$/)&&e.includes(t.name))):void 0,i={name:t.name,objects:Object(r.f)(n)?n:void 0};return Object.entries(t.connectorByName||{}).forEach(t=>{var[e,n]=t;i.connectorByName=i.connectorByName||{};var a={ends:n.ends.map(t=>t.name||t),endNames:n.endNames,incomingTag:n.incomingTag};if(n.possibleMessages){var o=Object(r.f)(n.possibleMessages.forward),c=Object(r.f)(n.possibleMessages.reverse);(o||c)&&(a.possibleMessages={},o&&(a.possibleMessages.forward=n.possibleMessages.forward.slice()),c&&(a.possibleMessages.reverse=n.possibleMessages.reverse.slice()))}i.connectorByName[e]=a}),t.interactions&&(i.interactions=t.interactions),t.settings&&(i.settings=t.settings),i}function a(t,e,n){n[e]&&(t[e]=n[e])}function o(t){var e=function(t){var e={name:t.name};return a(e,"isActor",t),Object.assign(e,function t(e){function n(){return r.stateByName=r.stateByName||{}}var r={},i={};return Object.entries(e.stateByName||{}).forEach(e=>{var[r,o]=e,c={};a(c,"entry",o),a(c,"exit",o),a(c,"doActivity",o),a(c,"type",o),a(c,"kind",o),Object.assign(c,t(o)),Object.entries(o.internalTransitions||{}).forEach(t=>{var[e,n]=t;(c.internalTransitions=c.internalTransitions||{})[e]={trigger:n.trigger,ports:n.ports,guard:n.guard,effect:n.effect}}),0<Object.entries(c).length?n()[r]=c:i[r]=c}),Object.entries(e.transitionByName||{}).filter(t=>{var[e,n]=t;return!n.isInternal}).forEach(t=>{function e(t){if("string"==typeof t)return t;for(var e=t.name,n=t.region;n!==a.region;)e="".concat(n.name,".").concat(e),n=n.region;return e}var[n,a]=t,o=e(a.source),c=e(a.target);delete i[o],delete i[c],(r.transitionByName=r.transitionByName||{})[n]={source:o,target:c,trigger:a.trigger,ports:a.ports,guard:a.guard,effect:a.effect}}),Object.keys(i).forEach(t=>{n()[t]={}}),r}(t))}(t);return a(e,"type",t),a(e,"class",t),Object(r.d)(t.operationByName,(t,n)=>{e.operationByName=e.operationByName||{};var r={};n.method&&(r.method=n.method),n.parameters&&(r.parameters=n.parameters),n.private&&(r.private=n.private),e.operationByName[t]=r}),e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return t.objects||t.connectorByName?(t.objects||(t.objects=[]),t.objects.forEach(t=>{i(t),t.operations=[],Object.entries(t.operationByName||{}).forEach(e=>{var[n,r]=e;r.name=n,r.class=t,t.operations=t.operations||[],t.operations.push(r)})}),t.connectors=[],Object(r.d)(t.connectorByName,(e,n)=>{t.connectors=t.connectors||[],t.connectors.push(n),n.name=e,n.ends=n.ends.map(e=>{var n=e;return"string"==typeof e&&(!(n=t.objects.find(t=>t.name==e))&&(n={name:e},t.objects.push(n))),n})}),t):(t.states=[],t.transitions=[],Object.keys(t.stateByName||{}).forEach(e=>{function n(e){if("string"==typeof e){var n=t.transitionByName[e];return n||(n={},t.transitionByName[e]=n),n}return e}var r=t.stateByName[e];r.region=t,i(r),r.name=e,r.incoming=(r.incoming||[]).map(n),r.incoming.forEach(t=>{t.target=r}),r.outgoing=(r.outgoing||[]).map(n),r.outgoing.forEach(t=>{t.source=r}),t.states.push(r),Object.entries(r.internalTransitions||{}).forEach(t=>{var[e,n]=t;e="__internal__".concat(e,"__"),n.region=r,n.isInternal=!0,n.source=r,n.target=r,n.name=e,r.transitionByName=r.transitionByName||{},r.transitionByName[e]=n})}),Object.keys(t.transitionByName||{}).forEach(e=>{function n(n,i){var a=r[n];if(!a){var o=/^(.+)2(.+?)(_[0-9]+)?$/;a="source"===n?e.replace(o,"$1"):e.replace(o,"$2")}if("string"==typeof a){var c=function(e){var n=e.split("."),r=void 0;return n.forEach(e=>{r=(r||t).stateByName[e]}),r}(a);c||(c={name:a,states:[],transitions:[],region:t},t.stateByName[a]=c,t.states.push(c)),r[n]=c,c[i]||(c[i]=[]),c[i].push(r)}}var r=t.transitionByName[e];r.isInternal||(r.name=e,t.transitions.push(r),r.region=t,n("source","outgoing"),n("target","incoming"))}),t)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Editor})),__webpack_require__.d(__webpack_exports__,"b",(function(){return initEditor})),__webpack_require__.d(__webpack_exports__,"c",(function(){return updateStates}));var _Utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),model,contextStates,sourceStates,targetStates,pseudostateSelect,textInput,inputBlock;class Editor{constructor(){}setModel(t){model=t}}function initEditor(t){model=t,editBlock.innerHTML='\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li id="addToState">add one of the following in <select id="contextState"></select>:\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li>a <a href="javascript:addState()">state</a></li>\n\t\t\t\t\t\t\t\t<li>a\n\t\t\t\t\t\t\t\t\t<a href="javascript:addPseudostate()">pseudostate</a>(<select id="pseudostate">\n\t\t\t\t\t\t\t\t\t\t<option>initial</option>\n\t\t\t\t\t\t\x3c!--\tTODO\n\t\t\t\t\t\t\t\t\t\t<option>deepHistory</option>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t\t\t\t\t<option>shallowHistory</option>\n\t\t\t\t\t\t\t\t\t\t<option>join</option>\n\t\t\t\t\t\t\t\t\t\t<option>fork</option>\n\t\t\t\t\t\t\x3c!--\tTODO\n\t\t\t\t\t\t\t\t\t\t<option>junction</option>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t\t\t\t\t<option>choice</option>\n\t\t\t\t\t\t\t\t\t\t<option>entrypoint</option>\n\t\t\t\t\t\t\t\t\t\t<option>exitpoint</option>\n\t\t\t\t\t\t\t\t\t\t<option>terminate</option>\n\t\t\t\t\t\t\t\t\t</select>)</li>\n\t\t\t\t\t\t\t\t<li id="internalTransition">an <a href="javascript:addInternalTransition()">internal transition</a></li>\n\t\t\t\t\t\t\t\t<li id="entryOrExit">an <a href="javascript:addEntry()">entry</a> or <a href="javascript:addExit()">exit</a></li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li id="addATransition">add a\n\t\t\t\t\t\t\t<a top href="javascript:addTransition()">transition</a>(<select id="sourceState"></select>-><select id="targetState"></select>)\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>add a\n\t\t\t\t\t\t\t<a top href="javascript:addObject(false)">passive</a>\n\t\t\t\t\t\t\tor an\n\t\t\t\t\t\t\t<a top href="javascript:addObject(true)">active</a>\n\t\t\t\t\t\t\tobject\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li id="inputBlock" style="display: none">edit the clicked element:\n\t\t\t\t\t\t\t<input id="textInput"/>\n\t\t\t\t\t\t\t<button id="inputOk">Ok</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t',document.getElementById("inputOk").onclick=okListener,(textInput=document.getElementById("textInput")).onkeypress=t=>{13===t.keyCode&&okListener(t)},(contextStates=document.getElementById("contextState")).onchange=()=>{var t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates);t&&[internalTransition,entryOrExit].forEach(e=>{2>t.split(".").length?hide(e):show(e)})},(sourceStates=document.getElementById("sourceState")).onchange=()=>{var t,e=null===(t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(sourceStates))||void 0===t?void 0:t.split(".")[0];Array.prototype.forEach.call(targetStates.options,t=>{t.disabled=!t.innerText.startsWith(e)}),targetStates.selectedIndex=Array.prototype.findIndex.call(targetStates.options,t=>!t.disabled)},targetStates=document.getElementById("targetState"),pseudostateSelect=document.getElementById("pseudostate"),inputBlock=document.getElementById("inputBlock")}function updateStates(){function t(t,e){var n,r=null===(n=Array.prototype.map.call(t.options,(t,e)=>({i:e,e:t})).find(t=>t.e.innerText==e))||void 0===n?void 0:n.i;t.selectedIndex=r}var e=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates),n=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(sourceStates),r=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(targetStates);contextStates.innerHTML="",sourceStates.innerHTML="",targetStates.innerHTML="";var i=displayedObjects.filter(model.isActive);i.forEach(t=>{addOption(contextStates,t.name),function t(e){(e.states||[]).forEach(e=>{"terminate"!=e.kind&&addOption(sourceStates,model.stateFullName(e)),"initial"!=e.kind&&addOption(targetStates,model.stateFullName(e)),e.kind||addOption(contextStates,model.stateFullName(e)),t(e)})}(t)}),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.f)(i)?show(addToState):hide(addToState),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.f)(targetStates)?show(addATransition):hide(addATransition),t(contextStates,e),t(sourceStates,n),t(targetStates,r),contextStates.onchange(),sourceStates.onchange(),updateExport(model)}var editedElement=void 0,editedProperty=void 0,update=void 0,okListener=()=>{editedElement[editedProperty]=textInput.value.replace(/\\n/g,"\n"),update&&update(textInput.value),update=void 0,inputBlock.style="display: none",updateFig(),updateStates()};function editTransition(t,e){var n=(t=model.getTransition(t))[e]||"";textInput.value=n.replace(/\\/,"\\\\").replace(/\n/g,"\\n"),editedElement=t,editedProperty=e,update=void 0,showInputBlock()}function showInputBlock(){inputBlock.style="",textInput.focus()}function editProperty(t,e){var n=model.getState(t);editedElement=n,editedProperty=e,textInput.value=n[e]||"",update=void 0,showInputBlock()}function addEntry(){editProperty(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates),"entry")}function addExit(){editProperty(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates),"exit")}function editState(t){var e=model.getState(t);textInput.value=e.name,editedElement=e,editedProperty="name";var n=e.name;update=function(t){delete e.region.stateByName[n],e.region.stateByName[t]=e},showInputBlock()}function getOperation(t){var e=t.split("."),n=model.getObject(e[0]);t=e[1];return n.operationByName[t]}function editOperation(t){var e=getOperation(t);textInput.value=e.name,editedElement=e,editedProperty="name";var n=e.name;update=function(t){delete e.class.operationByName[n],e.class.operationByName[t]=e},showInputBlock()}function editMethod(t){var e=getOperation(t);textInput.value=e.method||"",editedElement=e,editedProperty="method",update=void 0,showInputBlock()}function editObject(t){var e=model.getObject(t);textInput.value=e.name,editedElement=e,editedProperty="name";var n=e.name;update=t=>{function e(e){e.currentState[t]=e.currentState[n],delete e.currentState[n]}t!==n&&(e(builtInEngine.configuration),sysHistory.forEach(r=>{e(r.configuration),r.messages.forEach(e=>{e.source==n&&(e.source=t),e.target==n&&(e.target=t)})}),updateObjects())},showInputBlock()}function addVertex(t){var e,n=model.getState(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates));for(n.stateByName=n.stateByName||{};n.stateByName[e="S".concat(stateCounter++)];);t.name=e,t.region=n,n.states=n.states||[],n.states.push(t),n.stateByName[t.name]=t}var stateCounter=0;function addState(){addVertex({incoming:[],outgoing:[]}),updateFig(),updateStates()}function addPseudostate(){addVertex({type:"Pseudostate",kind:Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(pseudostateSelect),incoming:[],outgoing:[]}),updateStates(),updateFig()}var objectCounter=1;function addObject(t){for(var e;model.getObject(e="NewObject".concat(objectCounter++)););var n=t?Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_1__.a)({name:e,stateByName:{init:{type:"Pseudostate",kind:"initial"}},transitionByName:{}}):{name:e};model.objects.push(n),t&&model.setInitialState(n),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(objectSelect)==ALL_OBJECTS?(displayedObjects.push(n),updateFig()):switchToObject(e),updateObjects(),updateStates()}function makePassive(t){var e=model.getObject(t);delete e.stateByName,delete e.transitionByName,delete e.states,delete e.transitions,delete builtInEngine.configuration.currentState[e.name],updateStates(),updateFig()}function makeActive(t){var e=model.getObject(t);e.stateByName={init:{name:"init",type:"Pseudostate",kind:"initial",region:e,outgoing:[]}},e.transitionByName={},e.states=[e.stateByName.init],e.transitions=[],builtInEngine.configuration.currentState[e.name]=[model.getInitial(e)],updateStates(),updateFig()}function newName(t,e){for(var n,r=1;!e(n=t+r);)r++;return n}function addOperation(t){var e=model.getObject(t);e.operations=e.operations||[],e.operationByName=e.operationByName||{};var n={name:newName("newOperation",t=>!e.operations.find(e=>e.name==t)),class:e};e.operations.push(n),e.operationByName[n.name]=n,updateFig(),updateExport(model)}function removeObject(t){if(1===model.objects.length)alert("Cannot remove an object when there is only one left in a model.");else{var e=model.getObject(t);Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(model.objects,e),model.connectors.filter(t=>t.ends.includes(e)).forEach(t=>{Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(model.connectors,t),delete model.connectorByName[t.name]}),displayedObjects.includes(e)&&(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(displayedObjects,e),0==displayedObjects.length&&(defaultsToAllObjects?displayedObjects=model.objects.slice():displayedObjects=[model.objects[0]]),updateFig()),updateObjects(),updateStates(),updateExport(model)}}function removeTransition(t){removeTransitionInternal(t=model.getTransition(t)),updateFig(),updateExport(model)}function removeTransitionInternal(t){Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(t.region.transitions,t),delete t.region.transitionByName[t.name],t.isInternal&&delete t.region.internalTransitions[t.name.replace(/^__internal__/,"").replace(/__$/,"")],Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(t.source.outgoing,t),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(t.target.incoming,t)}function removeState(t){var e=model.getState(t);(e.incoming||[]).slice(0).forEach(t=>{removeTransitionInternal(t)}),(e.outgoing||[]).slice(0).forEach(t=>{removeTransitionInternal(t)}),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(e.region.states,e),delete e.region.stateByName[e.name],updateFig(),updateStates()}function removeOperation(t){var e=getOperation(t);Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(e.class.operations,e),delete e.class.operationByName[e.name],updateFig(),updateExport(model)}var transitionCounter=0;function nextTransName(){return"T".concat(transitionCounter++)}function addTransition(){function t(t){return model.getState(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(t))}if(!(0>targetStates.selectedIndex)){var e,n=t(sourceStates),r=t(targetStates),i=n.region;for(i.transitionByName=i.transitionByName||{};i.transitionByName[e=nextTransName()];);var a={name:e,source:n,target:r,region:i};i.transitions=i.transitions||[],i.transitions.push(a),i.transitionByName[a.name]=a,n.outgoing.push(a),r.incoming.push(a),updateFig(),updateExport(model)}}function addInternalTransition(){var t,e=model.getState(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates));for(e.transitionByName=e.transitionByName||{};e.transitionByName[t=nextTransName()];);var n={name:t,source:e,target:e,region:e,isInternal:!0};e.transitionByName[n.name]=n,e.internalTransitions=e.internalTransitions||{},e.internalTransitions[n.name]=n,updateFig()}Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.c)(symbol=>eval(symbol),"addState","addPseudostate","addTransition","addInternalTransition","addObject","addEntry","addExit","editState","editTransition","removeTransition","removeState","removeObject","makeActive","makePassive","addOperation","removeOperation","editMethod","editOperation","editObject")},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.j)(t.transitions.filter(t=>t.trigger).map(t=>t.trigger))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return l}));var r=n(0),i=n(2),a=n(3),o=n(9);function c(t,e,n,c,l){function u(t,e,n){return"javascript:".concat(b).concat(t,"('").concat(encodeURIComponent(l.stateFullName(e)),"'").concat(n?",'".concat(n,"'"):"",")")}function d(t,e){return"[[".concat(c.getTransURI("editTransition",t,e)," ").concat(Object(r.g)(t[e])||"<add ".concat(e,">"),"]]")}function p(t,n){function i(e){return t.ports?" from ".concat(t.ports.join(", ")).concat(e?" ":""):""}var o,s="";if(E&&!e)s="".concat(d(t,"trigger")).concat(i(!0),"[&#8203;").concat(d(t,"guard"),"]/").concat(d(t,"effect")," [[").concat(c.getTransURI("removeTransition",t)," ").concat(a.b,"]]");else{if(t.trigger||t.guard||t.effect){s="".concat((o=function(){var n=t.trigger;return!e&&(c.isActivable(t)&&!c.eventMatched(t)||n&&y)&&(n="<color:".concat(O.noEventColor,"><s>").concat(n,"</s></color>")),n}(),o||"")).concat(i(t.guard)).concat(t.guard?"[".concat(function(){var n=t.guard;return c.isActivable(t)&&c.eventMatched(t)&&!(e||c.isFireable(t))&&(n="<color:".concat(O.falseGuardColor,"><s>").concat(n,"</s></color>")),n}(),"]"):"").concat(t.effect?"/".concat(Object(r.g)(t.effect)):"")}!e&&(y||c.isFireable(t))&&(""==s&&(s="// fire"),s="[[".concat(c.getFireURI(t)," ").concat(s,"]]"))}return""==s?(n?":":"")+s:": ".concat(s)}function f(t){return"[[".concat(u("editState",t)," ").concat(t.name,"]] [[").concat(u("removeState",t)," ").concat(a.b,"]]")}function h(t){return g(t,"Current pseudostate",O.currentStateColor)}function g(t,e,n){var r="".concat(l.stateFullName(t),"Note");return'\n\t\t\tnote "'.concat(e,'" as ').concat(r," ").concat(n?"#".concat(n):"","\n\t\t\t").concat("initial"==t.kind?"[*] --\x3e ".concat(r):"".concat(r," --\x3e ").concat(v(t)))}function _(t,n,i){var a="".concat(i||"").concat(Object(r.g)(t[n]));return E&&!e&&(a="[[".concat(u("editProperty",t,n)," ").concat(a,"]]")),a}function m(t){return y?t.kind&&!0:c.isCurrent(t)}function v(t){switch(t.kind+""){case"shallowHistory":return"".concat(v(t.region),"[H]");case"initial":return"[*]";default:return Object(i.b)(l.stateFullName(t))}}var{callPrefix:b,forAnimation:y,editing:E,colors:O,hideLinks:j}=n;return"\n\t\t@startuml\n\t\t'skinparam monochrome true\n\t\t".concat(Object(a.a)(j),"\n\t\t").concat(s(E)&&!e?"left header Warning, showing as explicit state machine,\\nbut execution actually proceeds on the original state machine.\\nExplicit-specific function calls will not appear in history.\\nIf an history node or any other error is visible, then your state\\nmachine is not supported yet.":"",'\n\n\t\tstate "').concat(function(n){if(E&&!e){var r=encodeURIComponent(t.name);return"[[javascript:".concat(b,"editObject('").concat(r,"') ").concat(n,"]] [[javascript:").concat(b,"removeObject('").concat(r,"') ").concat(a.b,"]]")}return n}(t.name),'" as ').concat(Object(i.b)(t.name)," {\n\t\t\t").concat(function t(n,r){return"\n\t\t\t".concat((n.states||[]).map(n=>{var i=n.kind;switch(n.kind){case"junction":case"deepHistory":console.log('Unsupported "%s" Pseudostate: %s',n.kind,n);break;case"shallowHistory":E&&!e&&r.push(g(n,"&#171;".concat(n.kind,"&#187; ").concat(f(n))));break;case"initial":if(E&&!e)return g(n,"&#171;".concat(n.kind,"&#187; ").concat(f(n)))+(m(n)?"#".concat(O.currentStateColor):"");if(m(n)&&!e)return h(n);break;case"terminate":i="end";case"join":case"fork":case"choice":case"entrypoint":case"exitpoint":return"\n\t\t\t\t\t\tstate ".concat(v(n)," <<").concat(i,">>\n\t\t\t\t\t\t").concat(E&&!e?"note left of ".concat(v(n)," ").concat(m(n)?"#".concat(O.currentStateColor):""," : &#171;").concat(n.kind,"&#187; ").concat(f(n)):e?"":"".concat(h(n),"\n\t\t\t\t\t\t\t").concat(m(n)?"":"hide ".concat(l.stateFullName(n),"Note"),"\n\t\t\t\t\t\t"));default:var a=[];return"\n\t\t\t\t\t\t".concat(n.entry?"".concat(v(n)," : ").concat(_(n,"entry","entry/")):"","\n\t\t\t\t\t\t").concat(n.exit?"".concat(v(n)," : ").concat(_(n,"exit","exit/")):"","\n\t\t\t\t\t\t").concat(n.doActivity?"".concat(v(n)," : ").concat(_(n,"doActivity","do/")):"","\n\t\t\t\t\t\t").concat(Object.values(n.internalTransitions||{}).map(t=>"\n\t\t\t\t\t\t\t".concat(v(n)," ").concat(p(t,!0))).join(""),"\n\t\t\t\t\t\tstate ").concat(function(t){return E&&!e?'"'.concat(f(t),'" as ').concat(v(t)):'"'.concat(t.name,'" as ').concat(v(t))}(n)," ").concat(m(n)&&!e?"#".concat(O.currentStateColor):""," {\n\t\t\t\t\t\t\t").concat(t(n,a),"\n\t\t\t\t\t\t}\n\t\t\t\t\t\t").concat(a.join(""))}}).join(""),"\n\t\t\t").concat((n.transitions||[]).map(t=>"\n\t\t\t\t".concat(v(t.source)," -").concat(e||!c.isFireable(t)||y?"":"[#".concat(O.fireableTransitionColor,"]"),"-> ").concat(v(t.target)," ").concat(p(t))).join(""),"\n\t\t")}(function(t,e,n){return s(n)?Object(o.a)(t,e):t}(t,l,E),[]),"\n\t\t}\n\t\t@enduml\n\t")}function s(t){return showExplicitSM.checked&&!t}function l(t,e,n,o,s){var{displayedObjects:l,editing:u,callPrefix:d,colors:p,hideLinks:f}=s,h=l.filter(t=>showPorts.checked||!n.isPort(t));if(hideClasses.checked){var g=h.filter(n.isActive),_=g.map(r=>c(r,t,{callPrefix:d,forAnimation:e,editing:u,colors:p,hideLinks:f},o,n)).join("");return g.forEach(t=>{M&&(_+="".concat(Object(i.b)(M.name)," -[hidden]-> ").concat(Object(i.b)(t.name),"\n")),M=t}),_}function m(t){return encodeURIComponent("".concat(t.class.name,".").concat(t.name))}function v(e){var n="".concat(e.name,"()");return u&&!t?n="[[javascript:".concat(d,"editOperation('").concat(m(e),"') ").concat(n,"]] [[javascript:").concat(d,"removeOperation('").concat(m(e),"') ").concat(a.b,"]]"):function(t){return!checkEvents.checked||o.findMessage(t.name,t.class.name)}(e)&&!t&&(n="[[javascript:".concat(d,"callOperation('").concat(m(e),"')").concat(e.method?"{".concat(Object(r.g)(e.method).replace(/<U\+007B>/g,"{"),"}"):""," ").concat(n,"]]")),n="".concat(e.private?"-":"+").concat(n)}function b(t){return Object(i.b)(t).replace(/\./,"__")}function y(e){var n=function(t){return t.class?"".concat(t.name," : ").concat(t.class):t.name}(e);return n=t?'"'.concat(n,'" as ').concat(b(e.name)):u?'"[[javascript:'.concat(d,"editObject('").concat(e.name,"') ").concat(n,"]] [[javascript:").concat(d,"removeObject('").concat(e.name,"') ").concat(a.b,']]" as ').concat(b(e.name)):'"[[javascript:'.concat(d,"setSender('").concat(e.name,"') ").concat(n,']]" as ').concat(b(e.name))}function E(e,n){return r=>{var i=r;return!t&&(u||checkEvents.checked&&!e.isActor||(i="[[javascript:".concat(d,"callOperation('").concat(n.name,".").concat(i.replace(/ /g,"%20"),"','").concat(e.name,"') ").concat(i,"]]"))),i}}function O(e){if(hideMethods.checked)return"";var n=e.method;return u&&!t&&(n="[[javascript:".concat(d,"editMethod('").concat(m(e),"') ").concat(n?Object(r.g)(n):"<add method>","]]")),n&&(n="\n\t\t\t\t\t\tnote right of ".concat(b(e.class.name),"::").concat(e.name,"\n").concat(n,"\n\t\t\t\t\t\tend note")),n}function j(t){return t.ends.every(t=>h.includes(t))}var k,M;_="allowmixing\n"+h.map(r=>{function i(){return n.isActive(r)&&!hideStateMachines.checked?"\n\t\t\t\t\t\tnote right of ".concat(b(r.name),"\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t").concat(c(r,t,{callPrefix:d,forAnimation:e,editing:u,colors:p,hideLinks:f},o,n),"\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tend note\n\t\t\t\t\t"):""}return r.isActor?"\n\t\t\t\t\tactor ".concat(y(r),"\n\t\t\t\t\t").concat(i()):"\n\t\t\t\t\tclass ".concat(y(r)," ").concat(function(e){return n.isActive(e)?u&&!t?"<<[[javascript:".concat(d,"makePassive('").concat(e.name,"') makePassive]]>>"):"<<active>>":u&&!t?"<<[[javascript:".concat(d,"makeActive('").concat(e.name,"') makeActive]]>>"):""}(r)," {\n\t\t\t\t\t\t").concat(Object.entries(o.getSlots(r)).map(t=>{var[e,n]=t;return e.match(/__.*__/)&&!e.startsWith("__EMI__")?"":"".concat(e.replace(/^__EMI__/,"")," = ").concat(function(t){try{return t.valueOfProperty?t.valueOfProperty:JSON.stringify(t)}catch(t){return"<error>"}}(n))}).join("\n"),"\n\t\t\t\t\t\t").concat((r.operations||[]).map(t=>"\n\t\t\t\t\t\t\t".concat(v(t))).join(""),"\n\t\t\t\t\t\t").concat(u&&!t?"[[javascript:".concat(d,"addOperation('").concat(r.name,"') ADD]] an operation()"):"","\n\t\t\t\t\t}\n\t\t\t\t\t").concat((r.operations||[]).map(O).join(""),"\n\t\t\t\t\t").concat(i(),"\n\t\t\t\t")}).join("")+(n.connectors||[]).filter(j).concat(showPorts.checked?[]:(k=[],h.flatMap(t=>n.getConnectors(t).filter(e=>!k.includes(e)&&n.isPort(n.getOtherEnd(e,t))).map(e=>{var i=n.navigateThroughPorts(t,n.getOtherEnd(e,t));Array.prototype.push.apply(k,i.traversedConnectors);var a=Object(r.h)(i.traversedConnectors),o=[e.endNames?e.endNames[e.ends.indexOf(t)]:" ",a.endNames?a.endNames[a.ends.indexOf(i.target)]:" "];return{name:"VIRTUAL CONNECTOR",ends:[t,i.target],endNames:o}}))).filter(j)).map(t=>{var e,n,i="",a=null===(e=t.possibleMessages)||void 0===e?void 0:e.forward,o=null===(n=t.possibleMessages)||void 0===n?void 0:n.reverse,c=Object(r.f)(o),s=(i="",showEndNames.checked&&t.endNames?'"'.concat(t.endNames[0],'" '):""),l=showEndNames.checked&&t.endNames?' "'.concat(t.endNames[1],'"'):"";return Object(r.f)(a)&&(i+="\n\t\t\t\t\t".concat(b(t.ends[0].name)," ").concat(s,"-").concat(c?"[#transparent]":"","-").concat(l," ").concat(b(t.ends[1].name)," : > ").concat(a.map(E(t.ends[0],t.ends[1])).join("\\n"))),c&&(i+="\n\t\t\t\t\t".concat(b(t.ends[0].name)," ").concat(s,"--").concat(l," ").concat(b(t.ends[1].name)," : < ").concat(o.map(E(t.ends[1],t.ends[0])).join("\\n"))),""==i&&(i+="\n\t\t\t\t\t".concat(b(t.ends[0].name)," ").concat(s,"--").concat(l," ").concat(b(t.ends[1].name))),i}).join("");n.connectors&&0!=n.connectors.length||h.forEach(t=>{M&&(_+="".concat(b(M.name)," -[hidden]-> ").concat(b(t.name),"\n")),M=t});return"\n\t\t\thide circle\n\t\t\t".concat(Object(a.a)(f),"\n\t\t\t").concat(_,"\n\t\t")}},function(t,e,n){"use strict";function r(t,e){function n(t){return t.trigger.replace(e.afterRegex,"$1")}function r(t){return"TO".concat(t)}function i(t){return O.filter(e=>e.source==t)}function a(t){return O.filter(e=>e.target==t)}function o(t){var a=t.entry||"";return i(t).filter(t=>(t.trigger||"").match(e.afterRegex)).forEach(t=>{var e=n(t),i=r(e);a+="setTimer(".concat(i,", ").concat(e,");")}),a}function c(t){return t.exit||""}function s(t){return t.states&&0<t.states.length}function l(t,e,n){return(t.states||[]).filter(t=>!(e&&"initial"==t.kind)&&"shallowHistory"!=t.kind).flatMap(t=>{var e=l(t,!0,n);return 0==e.length?[t]:n?[t].concat(e):e})}function u(t,n){return(t.transitions||[]).flatMap(r=>{var i=s(r.target)?e.getInitial(r.target).outgoing[0].target:r.target,a=s(r.target)?_(r.effect,e.getInitial(r.target).outgoing[0].effect):r.effect;if("initial"==r.source.kind){if(!n||t!=n)return[];var o=r.source;return[{region:n||t,name:p(r),source:o,target:i,trigger:r.trigger,guard:r.guard,effect:a}]}if(s(r.source))return l(r.source,!0).filter(t=>!t.kind).map((e,o)=>({region:n||t,name:"".concat(p(r)).concat(b?"":"_".concat(o)),source:e,target:"shallowHistory"==i.kind&&i.region==e.region?e:i,trigger:r.trigger,guard:r.guard,effect:a}));o=r.source;return[{region:n||t,name:p(r),source:o,target:i,trigger:r.trigger,guard:r.guard,effect:a}]})}function d(t){return!t.region}function p(t){return d(t.region)?t.name:"".concat(p(t.region)).concat(b?".":"_").concat(t.name)}function f(n){if(n){var r=e.stateFullName(n),o=y.states[r];return o||(o={},y.states[r]=o,o.region=f(t),o.name=p(n),o.incoming=a(n).map(v),o.outgoing=i(n).map(v),o.kind="choice"==n.kind?void 0:n.kind,o.doActivity=n.doActivity,o.internalTransitions={},Object.entries(n.internalTransitions||{}).map(t=>{var[e,n]=t;o.internalTransitions[e]=v(n),o.internalTransitions[e].isInternal=!0})),o}}function h(t){var a="";return(i(t.source)||[]).filter(n=>t!=n&&(n.trigger||"").match(e.afterRegex)).forEach(t=>{var e=r(n(t));a="resetTimer(".concat(e,"); ").concat(a)}),a}function g(t){var i="choice"==t.source.kind?"when(".concat(t.guard,")"):t.trigger||"";i.match(e.afterRegex)?i=r(n(t)):i.match(e.whenRegex);return""==i?void 0:i}function _(t,e){return t&&""!=t?e&&""!=e?"".concat(t,"\n").concat(e):t:e&&""!=e?e:void 0}function m(t){function e(t){n=_(n,""==t?void 0:t)}var n;return t.isInternal||(e(h(t)),e(c(t.source))),e(t.effect||""),t.isInternal||e(o(t.target)),""==n?void 0:n}function v(t){return{region:f(t.region),name:t.name,source:f(t.source),target:f(t.target),trigger:g(t),guard:"choice"==t.source.kind?void 0:t.guard,effect:m(t)}}var b=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],y={states:{},transitions:{}},E={};y.states[e.stateFullName(t)]=E;var O=[t].concat(l(t,!0,!0)).flatMap(e=>u(e,t));return E.name=t.name,E.states=l(t).map(f),E.transitions=O.map(v),b||(E.stateByName=Object.fromEntries(E.states.map(t=>[t.name,t])),E.transitionByName=Object.fromEntries(E.transitions.map(t=>[t.name,t]))),E}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(1),i=n(7),a=n(0);function o(){var t=h(["\n\t\t\t\t\tclass "," {\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t}\n\t\t\t\t"]);return o=function(){return t},t}function c(){var t=h(["\n\t\t\t\t\t\t\t\t\t\tstate ","\n\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t"]);return c=function(){return t},t}function s(){var t=h([""," -> "," : "," : ",""," / ",";"]);return s=function(){return t},t}function l(){var t=h(["\n\t\t\t\t\tclass |","| behavesAs SM receives "," {\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t\tstateMachine SM {\n\t\t\t\t\t\t\tregion R {\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t"]);return l=function(){return t},t}function u(){var t=h(["\n\t\t\t\tassociation "," {\n\t\t\t\t\t","\n\t\t\t\t}\n\t\t\t"]);return u=function(){return t},t}function d(){var t=h(["\n\t\t\t\tsignal ",";\n\t\t\t\tsignalEvent "," of ",";\n\t\t\t"]);return d=function(){return t},t}function p(){var t=h(["\n\t\tmodel "," {\n\t\t\tinstance instMain of Main {}\n\t\t\tclass Main {\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t}\n\t\t\t","\n\t\t\t","\n\t\t\t","\n\t\t}\n\t"]);return p=function(){return t},t}function f(){var t=h([""," operation ","()",";"]);return f=function(){return t},t}function h(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function g(t){function e(t){return t.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)&&!m.includes(t)?t:'"'.concat(t,'"')}function n(t){return e("".concat(t.name,"_method"))}function h(t){return(t.operations||[]).map(t=>Object(r.a)(f(),t.isPrivate?"private":"public",e(t.name),t.method&&" behavesAs ".concat(n(t))))}function g(t,e){return"opaqueBehavior ".concat(e&&"".concat(e," "),"= '").concat(t,"' in AnimUML;")}function _(t){return(t.operations||[]).filter(t=>t.method).map(t=>g(t.method,n(t)))}var m=["choice","class","opaqueBehavior","opaqueExpression","constraint","state","behavesAs","model"];return Object(r.a)(p(),e(t.name),t.objects.map(t=>"public composite ".concat(e(t.name),"[1-1] : ").concat(e(t.name),";")),(t.connectors||[]).map(t=>"connector ".concat(e(t.name)," : ").concat(e(t.name)," between ").concat(e(t.ends[0].name)," and ").concat(e(t.ends[1].name),";")),Object(a.j)(t.objects.filter(t.isActive).flatMap(t=>Object(i.a)(t))).map(t=>Object(r.a)(d(),e(t),e("".concat(t,"_SE")),e(t))),(t.connectors||[]).map(t=>Object(r.a)(u(),e(t.name),t.ends.map(n=>"".concat(e(n.name),"[1-1] : ").concat(e(n.name)," in ").concat(e(t.name),";")))),t.objects.map(n=>t.isActive(n)?Object(r.a)(l(),e(n.name),Object(i.a)(n).map(t=>"".concat(e(t),"(").concat(e(t),")")).join(", "),h(n),_(n),n.transitions.map(t=>Object(r.a)(s(),e(t.source.name),e(t.target.name),e(t.name),t.trigger&&"".concat(e("".concat(t.trigger,"_SE"))),t.guard&&'[constraint "guard" is opaqueExpression = \''.concat(t.guard,"' in AnimUML;]"),t.effect&&g(t.effect))),n.states.filter(t=>t.kind||t.entry||t.exit||t.doActivity).map(t=>t.kind?"".concat(t.kind," pseudoState ").concat(e(t.name),";"):Object(r.a)(c(),e(t.name),t.entry&&"entry / ".concat(g(t.entry))))):Object(r.a)(o(),e(n.name),h(n),_(n))))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(7),i=n(2),a=n(1);function o(){var t=p(["\n\t\t\t\t\n\t\t\t"]);return o=function(){return t},t}function c(){var t=p(["\n\t\t\t\t// WARNING: this file has been generated by an unfinished C code generator\n\n\t\t\t\t#include <mqueue.h>\n\n\t\t\t\tstruct "," {\n\t\t\t\t\tmqd_t mq,\n\t\t\t\t\tpthread_t thread\n\t\t\t\t};\n\n\n\t\t\t\tenum State {};\n\n\t\t\t\ttransitions[][] = {\n\t\t\t\t};\n\n\t\t\t\t","_start("," * this) {\n\t\t\t\t\tpthread_create()\n\t\t\t\t\tpthread_start(","_run);\n\t\t\t\t}\n\t\t\t\t","_run("," * this) {\n\t\t\t\t\tState currentState = ...;\n\t\t\t\t\twhile(true) {\n\t\t\t\t\t\tmq_receive(msg)\n\t\t\t\t\t\ttransition = transitions[currentState][msg.event]\n\t\t\t\t\t\tif(transition.action) {\n\t\t\t\t\t\t\tcurrentState = transition.targetState;\n\t\t\t\t\t\t\ttransition.action()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","_stop("," * this) {\n\t\t\t\t\tmq_send(STOP)\n\t\t\t\t\tpthread_join(thread)\n\t\t\t\t}\n\n\t\t\t\t","\n\n\t\t\t\t","\n\t\t\t"]);return c=function(){return t},t}function s(){var t=p(["\n\t\t\t\t\n\t\t\t"]);return s=function(){return t},t}function l(){var t=p(["\n\t\t\t\ttypedef struct "," ",";\n\t\t\t"]);return l=function(){return t},t}function u(){var t=p(["\n\t\t\tvoid ","_","() {\n\t\t\t}\n\t\t"]);return u=function(){return t},t}function d(){var t=p(["\n\t\t\tvoid ","_","() {\n\t\t\t\tmq_send();\n\t\t\t}\n\t\t"]);return d=function(){return t},t}function p(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function f(t){function e(t){return Object(a.a)(u(),t.class.name,t.name)}function n(n){return t.isActive(n)?Object(a.a)(c(),n.name,n.name,n.name,n.name,n.name,n.name,n.name,n.name,Object(r.a)(n).map(t=>function(t,e){return Object(a.a)(d(),t.name,e)}(n,t)),(n.operations||[]).map(e)):Object(a.a)(o())}[].fill(0,0,256);var p="".concat(t.name,"/");return t.objects.map(e=>Object(i.a)("".concat(p).concat(e.name,".c"),n(e))+Object(i.a)("".concat(p).concat(e.name,".h"),function(e){return t.isActive(e)?Object(a.a)(l(),e.name,e.name):Object(a.a)(s())}(e))).join("")+Object(i.a)("".concat(p,"main.c"),"\n\t\tint main(int argc, char ** argv) {\n\t\t}\n\t")}},function(t,e,n){"use strict";function r(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){function o(t){r(s,i,a,o,c,"next",t)}function c(t){r(s,i,a,o,c,"throw",t)}var s=t.apply(e,n);o(void 0)}))}}n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o}));class a{constructor(t){var e,n=this,r=new Promise(n=>{var r=new WebSocket(t);r.onopen=()=>n(r),r.onmessage=t=>{e&&e(t.data),e=void 0}});this.askCommands=i((function*(){return new Promise(function(){var t=i((function*(t){e=t,n.sendCommand("ASK_COMMANDS")}));return function(){return t.apply(this,arguments)}}()).then(JSON.parse)})),this.sendCommand=i((function*(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=JSON.stringify(e);(yield r).send(i)})),this.close=i((function*(){(yield r).close()}))}}class o{constructor(t,e){function n(t){o.send(t)}function r(){return a.apply(this,arguments)}function a(){return(a=i((function*(){return new Promise(t=>{c.push(t)})}))).apply(this,arguments)}var o=new WebSocket(t),c=[];this.close=()=>{o.close()},o.onerror=function(t){console.log("WebSocket Error: %s",t)},o.onclose=function(){var t;null==e||null===(t=e.onclose)||void 0===t||t.call(e)};var s=Promise.resolve();o.onmessage=t=>{(function(){var a,o,l,u=this,d=c.shift();if(d)d(t.data);else{var p=t.data.split(":"),f=p[0],h=p.slice(1).join(":");switch(f+""){case"RESET":this.engine.reset();break;case"GET_CONFIGURATION":s=s.then(()=>this.engine.getConfiguration().then(function(){var t=i((function*(t){yield n(t),(null==e?void 0:e.ongetconfig)&&(yield e.ongetconfig(t))}));return function(){return t.apply(this,arguments)}}()));break;case"PARSE_CONFIGURATION":Promise.all([r(),s]).then(function(){var t=i((function*(t){var[e]=t;n(yield u.engine.parseConfiguration(e))}));return function(){return t.apply(this,arguments)}}());break;case"GET_FIREABLES":s=s.then(()=>this.engine.getFireables().then(t=>{for(var e of(n(""+t.length),t))n(e)}));break;case"PARSE_TRANSITION":Promise.all([r(),s]).then(function(){var t=i((function*(t){var[e]=t;n(yield u.engine.parseTransition(e))}));return function(){return t.apply(this,arguments)}}());break;case"FIRE":s=Promise.all([r(),s]).then(function(){var t=i((function*(t){var[n]=t;yield u.engine.fire(n),(null==e?void 0:e.onfired)&&(yield e.onfired(n))}));return function(){return t.apply(this,arguments)}}());break;case"SET_CONFIGURATION":s=Promise.all([r(),s]).then(t=>{var[e]=t;return this.engine.setConfiguration(e)});break;case"EVALUATE_ATOMS":s=s.then(()=>Promise.all(h.split(";").map(function(){var t=i((function*(t){try{return yield u.engine.evaluateAtom(t)}catch(t){return!1}}));return function(){return t.apply(this,arguments)}}()))).then(t=>n(JSON.stringify(t)));break;case"UUID":null==e||null===(a=e.onuuid)||void 0===a||a.call(e,h);break;case"RESULTS":null==e||null===(o=e.onresults)||void 0===o||o.call(e,t.data);break;case"PROGRESS":null==e||null===(l=e.onprogress)||void 0===l||l.call(e,t.data);break;default:console.log("Unsupported request from server: %s",t.data)}}}).bind(this)()}}setEngine(t){this.engine=t}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2),i=n(0);function a(t,e,n,a){function o(t){return"]"==t?"_LOST_":"["==t?"_FOUND_":Object(r.b)(t)}function c(t,e){return n.fullStateDisplay(p[t.name])!==n.fullStateDisplay(e)}var{callPrefix:s,stateOfIn:l,hideSets:u}=a,d=0,p={};return"\n\t\t'hide time-axis\n\t\tscale 1 as ".concat(timingScale.value,' pixels\n\t\trobust "Unknown source" as _FOUND_\n\t\t').concat(n.objects.map(t=>{return'concise ":'.concat((i=t.name,a=i,e||(a="[[javascript:".concat(s,"switchToObject('").concat(i,"') ").concat(i,"]]")),a),'" as ').concat(Object(r.b)(t.name),"\n\t\t\t").concat(n.isActive(t)?"":"\n\t\t\t\t@0\n\t\t\t\t".concat(Object(r.b)(t.name)," is {-}\n\t\t\t"),"\n\t\t");var i,a}).join(""),'\n\t\trobust "Unknown target" as _LOST_\n\t\t').concat(e?"":'concise "History" as _HISTORY_','\n\t\t@0\n\t\t        _LOST_ is  "                            "\n\t\t        _FOUND_ is "                            "\n\t\t').concat(t.map((t,a)=>{var f="\n\t\t\t\t@".concat(d,"\n\t\t\t\t").concat(e?"":"_HISTORY_ is ".concat(function(t,n){return e?t:"".concat(t," : [[javascript:").concat(s,"backTo(").concat(n,") goto]]")}(a,a)),"\n\t\t\t\t").concat(n.objects.filter(e=>n.isActive(e)&&(t.configuration&&c(e,l(e,t))||e==t.activeObject)).map(e=>(p[e.name]=l(e,t),showPseudostateInvariants.checked||t.configuration&&!Object(i.h)(l(e,t)).kind?"".concat(Object(r.b)(e.name)," is ").concat(n.fullStateDisplay(l(e,t)),"\n"):"")).join(""),"\n\t\t\t");return d+=1,t.logicalTime=d,f+="\n\t\t\t\t@".concat(d,"\n\t\t\t\t").concat((t.messages||[]).filter(t=>!u||"set"!==t.type).filter(t=>!t.receivedAt||t.receivedAt.logicalTime&&t.receivedAt.logicalTime==d).map(e=>e.signature.match(/^after\(/)?"\n\t\t\t\t\t\t".concat(Object(r.b)(t.activeObject.name),"@").concat(d-1," <-> @").concat(d," : ").concat(e.signature,"\n\t\t\t\t\t\t@").concat(d):"\n\t\t\t\t\t\t".concat(o(e.source),"@").concat(e.sentAt?e.sentAt.logicalTime:d,"->").concat(o(e.target)," : ").concat(e.signature).concat(e.receivedAt?"":" ?")).join(""),"\n\t\t\t")}).join(""),"\n\t\t@").concat(d,"\n\t\t").concat(n.objects.filter(t=>n.isActive(t)&&c(t,builtInEngine.configuration.currentState[t.name])).map(t=>"".concat(Object(r.b)(t.name)," is ").concat(n.fullStateDisplay(builtInEngine.configuration.currentState[t.name]),"\n\t\t")).join(""),"\n\t\t").concat(e?"":"_HISTORY_ is {hidden}","\n\t")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(3),a=n(2);function o(t,e,n,o){function c(n,i,o){var c=t[i-1];return g?"":e.objects.filter(t=>e.isActive(t)&&o.activeObject===t&&(showPseudostateInvariants.checked||!Object(r.h)(s(t,n)).kind)&&(y||!c||e.fullStateDisplay(s(t,n))!==b[t.name])).map(t=>{var r=e.fullStateDisplay(s(t,n));return b[t.name]=r,"hnote over ".concat(Object(a.b)(t.name)," : ").concat(function(t,e){return f?t:"[[javascript:".concat(d,"backTo(").concat(e,") ").concat(t,"]]")}(r,i),"\n\t\t")}).join("/")}var{stateOfIn:s,ALL_OBJECTS:l,configuration:u,callPrefix:d,participants:p,raw:f,colors:h,hideStates:g,hideSets:_,hideLinks:m}=o,v=p||e.objects.filter(t=>!e.isPort(t)),b={},y=!f;return"\n\t\t".concat(Object(i.a)(m),"\n\t\t").concat(v.map(t=>{return"\n\t\t\t".concat(t.isActor?"actor":"participant",' "').concat((e=t.name,n=e,f||(n="[[javascript:".concat(d,"switchToObject('").concat(e,"') ").concat(e,"]]")),n)," : ").concat(t.class?t.class:"",'" as ').concat(Object(a.b)(t.name));var e,n}).join(""),"\n\t\t").concat(1<e.objects.length?"participant Ether":"","\n\t\t").concat(t.map((e,n)=>e.PlantUML?"\n\t\t\t".concat(e.PlantUML,"\n\t\t"):"\n\t\t\t".concat(c(e,n,t[n-1]||e),"\n\t\t\t").concat(e.messages.filter(t=>!_||"set"!==t.type).map(t=>t.signature.match(/^after\(/)?"\n\t\t\t\t\t... ".concat(t.signature,"..."):"\n\t\t\t\t\t".concat(function(t,e){return e.sentAt!==t&&e.sentAt&&e.receivedAt!==e.sentAt?"["===e.source?"":"Ether":Object(a.b)(e.source)}(e,t)).concat("["===t.source?"o":"","->").concat(t.ignored?"o ":"").concat(function(t,e){return e.receivedAt!==t&&e.receivedAt!==e.sentAt?"Ether":Object(a.b)(e.target)}(e,t)," : ").concat(t.signature)).join(""))).join(""),"\n\t\t").concat("","\n\t\t").concat(f||!hideStateMachines.checked&&Object(r.e)(objectSelect)==l?"":v.filter(e.isActive).map(t=>"note over ".concat(Object(a.b)(t.name),"\n\t\t\t\tFireable triggers:\n\t\t\t\t").concat(n.getFireable(t).map(t=>"*[[javascript:".concat(d,"fire('").concat(e.transFullName(t),"'){").concat(function(t){var e="".concat(t.source.name," -> ").concat(t.target.name);return(t.trigger||t.guard||t.effect)&&(e+=" : ".concat(Object(r.g)(t.trigger)||"").concat(t.ports?" from ".concat(t.ports.join(", ")).concat(t.guard?" ":""):"").concat(t.guard?"[".concat(Object(r.g)(t.guard),"]"):"").concat(t.effect?"/".concat(Object(r.g)(t.effect)):"")),e}(t),"} ").concat(t.trigger?t.trigger:t.guard?"[".concat(t.guard,"]"):t.effect&&15>t.effect.length?"/".concat(t.effect):"// fire","]]\n\t\t\t\t")).join(""),"Other triggers:\n\t\t\t\t").concat(n.getFireable(t,n.isActivable).filter(t=>!n.eventMatched(t)).map(t=>"*<color:".concat(h.noEventColor,"><s>").concat(t.trigger?t.trigger:t.guard?"[".concat(t.guard,"]"):"// fire","</s></color>\n\t\t\t\t")).join("")+n.getFireable(t,n.isActivable).filter(n.eventMatched).filter(t=>!n.isFireable(t)).map(t=>"*<color:".concat(h.noEventColor,"><s>").concat(t.trigger?t.trigger:t.guard?"[".concat(t.guard,"]"):"// fire","</s></color>\n\t\t\t\t")).join(""),"\n\t\t\t end note\n\t\t")).join("/")+v.filter(t=>t.isActor&&!e.isActive(t)).map(t=>"/note over ".concat(Object(a.b)(t.name),"\n\t\t\t\tCallable operations:\n\t\t\t\t").concat(e.connectors.filter(e=>e.ends.some(e=>e==t)).map(e=>{var n;return null===(n=e.possibleMessages)||void 0===n?void 0:n.forward.map(n=>{return r=e.ends.find(e=>e!=t).name,"* [[javascript:".concat(d,"callOperation('").concat(r,".").concat(n,"','").concat(t.name,"') ").concat(r,".").concat(n,"]]");var r}).join("\n\t\t\t\t")}).join("\n\t\t\t\t"),"\n\t\t\tend note\n\t\t")).join(""),"\n\t")}},function(t,e,n){"use strict";function r(t,e,n){var r="";return r+=i(63&t>>2),r+=i(63&((3&t)<<4|e>>4)),r+=i(63&((15&e)<<2|n>>6)),r+=i(63&n)}function i(t){return 10>t?String.fromCharCode(48+t):26>(t-=10)?String.fromCharCode(65+t):26>(t-=26)?String.fromCharCode(97+t):0==(t-=26)?"-":1==t?"_":"?"}function a(t,e){return t+"svg/"+function(t){for(var e="",n=0;n<t.length;n+=3)e+=n+2==t.length?r(t.charCodeAt(n),t.charCodeAt(n+1),0):n+1==t.length?r(t.charCodeAt(n),0,0):r(t.charCodeAt(n),t.charCodeAt(n+1),t.charCodeAt(n+2));return e}(pako.deflateRaw(e,{level:9,to:"string"}))}n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){return Object(r.j)(t.events.flatMap(t=>[t.from,t.to,t.object].filter(t=>t))).sort()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1);function i(){var t=o(["\n\t\t\t\t\ta[*|href] > text {\n\t\t\t\t\tfill: blue; text-decoration: underline;\n\t\t\t\t}"]);return i=function(){return t},t}function a(){var t=o(['\n\t\t<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:c="http://myconstraints" width="500" height="500">\n\t\t\t<script>\n\t\t\t\tfunction eventConstraints(ev, on) {\n\t\t\t\t\tev.outline.center.x.eq(on.line.p1.x).add();\n\t\t\t\t\teventConstraintsY(ev, on);\n\t\t\t\t}\n\t\t\t\tfunction eventConstraintsY(ev, on) {\n\t\t\t\t\ton.line.p2.y.ge(ev.outline.y).add();\n\t\t\t\t\tif(ev.after) {\n\t\t\t\t\t\tev.outline.y.eq(ev.after.outline.y.plus(',")).add();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tev.outline.y.eq(on.line.p1.y.plus(",")).add();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfunction participantConstraints(part) {\n\t\t\t\t\tif(part.x) {\n\t\t\t\t\t\tpart.outline.x.eq(part.x * 1).add();\n\t\t\t\t\t\tpart.outline.y.eq(part.y * 1).add();\n\t\t\t\t\t}\n\n\t\t\t\t\tif(part.after) {\n\t\t\t\t\t\tpart.outline.bottom.p1.y.eq(part.after.outline.bottom.p1.y).add();\n\t\t\t\t\t\tpart.outline.center.x.ge(part.after.outline.center.x.plus(part.outline.width.plus(part.after.outline.width).div(2).plus(INTER_OBJECT_MARGIN))).add();\n\n\t\t\t\t\t\tpart.line.p2.y.eq(part.after.line.p2.y).add();\n\t\t\t\t\t}\n\n\t\t\t\t\tpart.line.p1.eq(part.outline.bottom.center).add();\n\n\t\t\t\t\tpart.line.p2.x.eq(part.line.p1.x).add();\n\n\t\t\t\t\tpart.line.p2.y.ge(part.line.p1.y.plus(20)).add();\n\n\t\t\t\t\ttextOutline(part.outline, part.name);\n\t\t\t\t\ttextOutline(part.outline2, part.name2);\n\n\t\t\t\t\tpart.line2.p1.eq(part.line.p2).add();\n\t\t\t\t\tpart.line2.p2.eq(part.line2.p1.plus(0, 40)).add();\n\t\t\t\t\tpart.line2.p2.eq(part.outline2.top.center).add();\n\t\t\t\t}\n\n\t\t\t\tfunction textOutline(outline, name) {\n\t\t\t\t\toutline.width.ge(name.width.plus(MARGIN.times(2))).add();\n\t\t\t\t\tname.center.eq(outline.center).add();\n\t\t\t\t\toutline.height.ge(name.height.plus(MARGIN)).add();\n\t\t\t\t}\n\t\t\t<\/script>\n\t\t\t<style>\n\t\t\t\t.participant {\n\t\t\t\t\tfill: #FEFECE;\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tstroke-width: 1.5;\n\t\t\t\t}\n\t\t\t\t.actor {\n\t\t\t\t\tfill: #FEFECE;\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tstroke-width: 2;\n\t\t\t\t}\n\t\t\t\t.invariant {\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tfill: #FBFB77;\n\t\t\t\t}\n\t\t\t\t.note {\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tfill: #FBFB77;\n\t\t\t\t}\n\t\t\t\t.lifeline {\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tstroke-width: 1.0;\n\t\t\t\t}\n\t\t\t\t.messagePart {\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tstroke-width: 1.0;\n\t\t\t\t}\n\t\t\t\t.messageArrow {\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tstroke-width: 1.0;\n\t\t\t\t\tmarker-end: url(#arrowHead);\n\t\t\t\t}\n\t\t\t\t.messageArrowHead {\n\t\t\t\t\tfill: #A80036;\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t\tstroke-width: 1.0;\n\t\t\t\t}\n\t\t\t\t.circle {\n\t\t\t\t\tstroke: #A80036;\n\t\t\t\t}\n\t\t\t\t",'\n\t\t\t</style>\n\t\t\t<defs>\n\t\t\t\t<marker id="arrowHead" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">\n\t\t\t\t\t<polygon class="messageArrowHead" points="0,0,10,4,0,8,6,4"/>\n\t\t\t\t</marker>\n\t\t\t\t<pattern id="horizontalWhiteStripes" patternUnits="userSpaceOnUse" width="4" height="4">\n\t\t\t\t\t<line x1="-5" y1="0" x2="9" y2="0" style="stroke-width: 4; stroke: white;"/>\n\t\t\t\t</pattern>\n\t\t\t\t<g id="object">\n\t\t\t\t\t<line class="lifeline" id=".line" stroke="black"/>\n\n\t\t\t\t\t<rect class="participant" id=".outline" fill="none" stroke="param(color) black"/>\n\t\t\t\t\t<text class="participantName" id=".name" content-value="param(name)">test</text>\n\n\t\t\t\t\t<line class="lifeline" id=".line2" stroke="black"/>\n\n\t\t\t\t\t<rect class="participant" id=".outline2" fill="none" stroke="param(color) black"/>\n\t\t\t\t\t<text class="participantName" id=".name2" content-value="param(name)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tparticipantConstraints(this);\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="actor">\n\t\t\t\t\t<line class="lifeline" id=".line" stroke="black"/>\n\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" display="none"/>\n\t\t\t\t\t<text class="participantName" id=".name" content-value="param(name)">test</text>\n\t\t\t\t\t<circle class="actor" id=".head" fill="none" stroke="param(color) black"/>\n\t\t\t\t\t<line class="actor" id=".body" stroke="black"/>\n\t\t\t\t\t<line class="actor" id=".arms" stroke="black"/>\n\t\t\t\t\t<line class="actor" id=".leftLeg" stroke="black"/>\n\t\t\t\t\t<line class="actor" id=".rightLeg" stroke="black"/>\n\n\t\t\t\t\t<line class="lifeline" id=".line2" stroke="black"/>\n\n\t\t\t\t\t<rect id=".outline2" fill="none" stroke="param(color) black" display="none"/>\n\t\t\t\t\t<text class="participantName" id=".name2" content-value="param(name)">test</text>\n\t\t\t\t\t<circle class="actor" id=".head2" fill="none" stroke="param(color) black"/>\n\t\t\t\t\t<line class="actor" id=".body2" stroke="black"/>\n\t\t\t\t\t<line class="actor" id=".arms2" stroke="black"/>\n\t\t\t\t\t<line class="actor" id=".leftLeg2" stroke="black"/>\n\t\t\t\t\t<line class="actor" id=".rightLeg2" stroke="black"/>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tparticipantConstraints(this);\n\n\t\t\t\t\t\tconst HEAD_R = 8;\n\t\t\t\t\t\tconst BODY_LENGTH = 27;\n\t\t\t\t\t\tconst ARM_LENGTH = 26;\n\t\t\t\t\t\tconst HEAD2ARMS = 8;\n\t\t\t\t\t\tconst LEG_HEIGHT = 15;\n\n\t\t\t\t\t\tfunction actor(head, body, arms, leftLeg, rightLeg) {\n\t\t\t\t\t\t\thead.r.eq(HEAD_R).add();\n\t\t\t\t\t\t\tbody.p1.eq(head.center.plus(0, HEAD_R)).add();\n\t\t\t\t\t\t\tbody.p2.eq(body.p1.plus(0, BODY_LENGTH)).add();\n\t\t\t\t\t\t\tarms.p1.eq(body.p1.plus(-ARM_LENGTH/2, HEAD2ARMS)).add();\n\t\t\t\t\t\t\tarms.p2.eq(body.p1.plus(ARM_LENGTH/2, HEAD2ARMS)).add();\n\t\t\t\t\t\t\tleftLeg.p1.eq(body.p2).add();\n\t\t\t\t\t\t\tleftLeg.p2.eq(leftLeg.p1.plus(-ARM_LENGTH/2, LEG_HEIGHT)).add();\n\t\t\t\t\t\t\trightLeg.p1.eq(body.p2).add();\n\t\t\t\t\t\t\trightLeg.p2.eq(rightLeg.p1.plus(ARM_LENGTH/2, LEG_HEIGHT)).add();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tactor(this.head, this.body, this.arms, this.leftLeg, this.rightLeg);\n\t\t\t\t\t\tthis.outline.top.center.eq(this.body.p2.plus(0, LEG_HEIGHT)).add();\n\n\t\t\t\t\t\tactor(this.head2, this.body2, this.arms2, this.leftLeg2, this.rightLeg2);\n\t\t\t\t\t\tthis.outline2.bottom.center.eq(this.head2.center.plus(0, -HEAD_R)).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="call">\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\teventConstraints(this, this.on);\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="accept">\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<line class="messageArrow" id=".line" stroke="param(color) black"/>\n\t\t\t\t\t<text class="messageSignature" id=".text" content-value="param(signature)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\teventConstraints(this, this.on);\n\n\t\t\t\t\t\tthis.line.p1.eq(this.call.outline.center).add();\n\t\t\t\t\t\tthis.line.p2.eq(this.outline.center).add();\n\n\t\t\t\t\t\tthis.text.bottom.center.eq(this.line.center).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="selfaccept">\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<line class="messagePart" id=".line1" stroke="param(color) black"/>\n\t\t\t\t\t<line class="messagePart" id=".line2" stroke="param(color) black"/>\n\t\t\t\t\t<line class="messageArrow" id=".line3" stroke="param(color) black"/>\n\t\t\t\t\t<text class="messageSignature" id=".text" content-value="param(signature)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tconst dx = 20;\n\t\t\t\t\t\teventConstraints(this, this.on);\n\t\t\t\t\t\tthis.line1.p1.eq(this.call.outline.center).add();\n\t\t\t\t\t\tthis.line1.p2.eq(this.line1.p1.plus(dx, 0)).add();\n\t\t\t\t\t\tthis.line2.p1.eq(this.line1.p2).add();\n\t\t\t\t\t\tthis.line3.p1.eq(this.line2.p2).add();\n\t\t\t\t\t\tthis.line3.p2.eq(this.line3.p1.plus(-dx, 0)).add();\n\t\t\t\t\t\tthis.line3.p2.eq(this.outline.center).add();\n\n\t\t\t\t\t\tthis.text.left.center.eq(this.line2.center.plus(5, 0)).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="unaccepted">\n\t\t\t\t\t<line class="messageArrow" id=".line" stroke="param(color) black"/>\n\t\t\t\t\t<text class="messageSignature" id=".text" content-value="param(signature)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tthis.line.p1.eq(this.call.outline.center).add();\n\t\t\t\t\t\tthis.line.p2.y.eq(this.line.p1.y).add();\n\t\t\t\t\t\tthis.line.p2.x.eq(this.rightmost.line.p1.x.plus(150)).add();\n\n\t\t\t\t\t\tthis.text.bottom.center.eq(this.line.center).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="found">\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<line class="messageArrow" id=".line" stroke="param(color) black"/>\n\t\t\t\t\t<text class="messageSignature" id=".text" content-value="param(signature)">test</text>\n\t\t\t\t\t<circle class="circle" id=".circle" fill="none" stroke="param(color) black" r="5"/>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\teventConstraints(this, this.on);\n\t\t\t\t\t\tthis.line.p1.x.eq(this.leftmost.line.p1.x.minus(150)).add();\n\t\t\t\t\t\tthis.line.p1.y.eq(this.line.p2.y).add();\n\t\t\t\t\t\tthis.line.p2.eq(this.outline.center).add();\n\t\t\t\t\t\tthis.circle.center.plus(5, 0).eq(this.line.p1).add();\n\n\t\t\t\t\t\tthis.text.bottom.center.eq(this.line.center).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="set">\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<line class="messagePart" id=".line1" stroke="param(color) black"/>\n\t\t\t\t\t<line class="messagePart" id=".line2" stroke="param(color) black"/>\n\t\t\t\t\t<line class="messageArrow" id=".line3" stroke="param(color) black"/>\n\t\t\t\t\t<text class="messageSignature" id=".text" content-value="param(signature)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tconst dx = 20;\n\t\t\t\t\t\tconst dy = 15;\n\t\t\t\t\t\teventConstraints(this, this.on);\n\t\t\t\t\t\tthis.line1.p1.eq(this.outline.center).add();\n\t\t\t\t\t\tthis.line1.p2.eq(this.line1.p1.plus(dx, 0)).add();\n\t\t\t\t\t\tthis.line2.p1.eq(this.line1.p2).add();\n\t\t\t\t\t\tthis.line2.p2.eq(this.line2.p1.plus(0, dy)).add();\n\t\t\t\t\t\tthis.line3.p1.eq(this.line2.p2).add();\n\t\t\t\t\t\tthis.line3.p2.eq(this.line3.p1.plus(-dx, 0)).add();\n\n\t\t\t\t\t\tthis.text.left.center.eq(this.line2.center.plus(5, 0)).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="after">\n\t\t\t\t\t<rect id=".outline" fill="url(#horizontalWhiteStripes)" stroke="none"/>\n\t\t\t\t\t<text class="messageSignature" id=".text" content-value="param(signature)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tif(!Array.isArray(this.on)) {\n\t\t\t\t\t\t\tthis.on = [this.on];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.on.forEach(on => {\n\t\t\t\t\t\t\teventConstraintsY(this, on);\n\t\t\t\t\t\t\ton.outline.center.x.ge(this.outline.x.plus(5, 0)).add();\n\t\t\t\t\t\t\ton.outline.center.x.le(this.outline.topRight.x.plus(-5, 0)).add();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.outline.height.ge(this.text.height.times(2)).add();\n\t\t\t\t\t\tthis.text.center.eq(this.outline.center).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="note">\n\t\t\t\t\t<rect class="note" id=".outline" stroke="black" fill="none"/>\n\t\t\t\t\t<text id=".text" content-value="param(note)">test</text>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\tif(!Array.isArray(this.on)) {\n\t\t\t\t\t\t\tthis.on = [this.on];\n\t\t\t\t\t\t}\n\t\t\t\t\t\teventConstraintsY(this, this.on[0]);\n\t\t\t\t\t\tfunction last(e) {\n\t\t\t\t\t\t\treturn e[e.length - 1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.outline.center.x.eq(last(this.on).outline.center.x.plus(this.on[0].outline.center.x).div(2)).add();\n\n\t\t\t\t\t\tRectangle.prototype.enlarge = function(m) {\n\t\t\t\t\t\t\treturn new Rectangle(this.x.minus(m), this.y.minus(m), this.width.plus(m.times(2)), this.height.plus(m.times(2)));\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.text.center.eq(this.outline.center).add();\n\t\t\t\t\t\tthis.outline.mustContain(this.text.enlarge(MARGIN.div(3))).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t\t<g id="invariant">\n\t\t\t\t\t<rect id=".outline" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<rect id=".helper" fill="none" stroke="param(color) black" width="10" height="10" display="none"/>\n\t\t\t\t\t<polygon class="invariant" id=".polygon" fill="none" stroke="param(color) black"/>\n\t\t\t\t\t<a params="href:param(link) javascript:">\n\t\t\t\t\t\t<text class="invariantText" id=".text" content-value="param(invariant)">test</text>\n\t\t\t\t\t</a>\n\t\t\t\t\t<constraints>\n\t\t\t\t\t\teventConstraints(this, this.on);\n\t\t\t\t\t\tconst width = this.text.width;\n\t\t\t\t\t\tconst height = this.text.height.plus(MARGIN.times(2));\n\t\t\t\t\t\tthis.polygon.makeTEllipse(\n\t\t\t\t\t\t\tthis.helper.x, this.helper.y,\n\t\t\t\t\t\t\twidth.plus(height.div(2)),\n\t\t\t\t\t\t\twidth\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.polygon.center.eq(this.outline.center).add();\n\t\t\t\t\t\tthis.text.center.eq(this.outline.center).add();\n\t\t\t\t\t</constraints>\n\t\t\t\t</g>\n\t\t\t</defs>\n\n\t\t\t','\n\n\t\t\t<script xlink:href="','tcsvg/c.js"/>\n\t\t\t<script xlink:href="','tcsvg/TCSVG.min.js"/>\n\t\t</svg>\n\t']);return a=function(){return t},t}function o(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function c(t,e){var{origin:n,scale:o,hideLinks:c}=e;return o=o/1.7||30,Object(r.a)(a(),o,o,c?"":Object(r.a)(i()),t,n,n).replace(/([^:])\/\/[^\n]*/g,"$1\n").replace(/\t/g," ")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(0);function r(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){function o(t){r(s,i,a,o,c,"next",t)}function c(t){r(s,i,a,o,c,"throw",t)}var s=t.apply(e,n);o(void 0)}))}}function a(){return o.apply(this,arguments)}function o(){return(o=i((function*(t){return(yield Promise.all(t.map(function(){var t=i((function*(t){return"function"==typeof t?yield t():[t]}));return function(){return t.apply(this,arguments)}}()))).flatMap(t=>t)}))).apply(this,arguments)}function c(t){return i((function*(){for(var e,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var[o,...c]=r;("diff"===o||(null==t||null===(e=t[o])||void 0===e?void 0:e.call(t,{type:o,args:c})))&&console.log.apply(console,yield a(r))}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),i=n(5);class a{constructor(t,e){var n,a=/after\(([^)]*)\)/,o=/when\(([^)]*)\)/;if(!(t=Object(i.a)(t)).objects){var c=t;t={name:c.name,objects:[t]},c.settings&&(t.settings=c.settings,delete c.settings)}Object.assign(this,t),Object.assign(this,{getObject(t){return this.objects.find(e=>e.name==t)},getConnectors(t){var e;return(null===(e=this.connectors)||void 0===e?void 0:e.filter(e=>e.ends.includes(t)))||[]},getInitial(t){return this.isActive(t)?t.states.find(t=>"initial"==t.kind):void 0},getState(t){var e=t.split("."),n=this.getObject(e[0]);return(e=e.slice(1)).forEach(t=>{n=n.stateByName[t]}),n},getTransition(t){var e=t.split("."),n=this.getObject(e[0]);return(e=e.slice(1)).slice(0,e.length-1).forEach(t=>{n=n.stateByName[t]}),(n=n.transitionByName[Object(r.h)(e).replace(/__DOT__/g,".")])||console.log("Could not find transition: ",t),n},getObjectRelative(t,e){var n=this.connectors.filter(e=>e.endNames&&e.ends.includes(t)).map(n=>{switch(n.ends.indexOf(t)){case 0:if(e===n.endNames[1])return n.ends[1];break;case 1:if(e===n.endNames[0])return n.ends[0]}}).filter(t=>t);return 1==n.length?n[0]:0==n.length?void 0:n},fullState(t){if(t.region){var e=this.fullState(t.region);return e.push(t),e}return[]},noEventTrigger:t=>!t.trigger||t.trigger.match(a)||t.trigger.match(o),isActive:t=>Object(r.f)(t.states),isPort:t=>"Port"==t.type,stateFullName(t){return"".concat(t.region?"".concat(this.stateFullName(t.region),"."):"").concat(t.name)},transFullName(t){return"".concat(this.stateFullName(t.region),".").concat(t.name.replace(/\./g,"__DOT__"))},fullStateDisplay:t=>t?t.map(t=>t.name).join("."):t,getOtherEnd:(t,e)=>t.ends.find(t=>t!=e),getStateObject(t){for(var e=t.region;e.region;)e=e.region;return e},getTransObject(t){for(var e=t.region;e.region;)e=e.region;return e},navigateThroughPorts(t,e,n){for(var r,i=[],a=t,o=e;this.isPort(o);){var c=this.getConnectors(o).find(t=>!t.ends.includes(a));i.push(c),a=o,o=this.getOtherEnd(c,o),c.incomingTag&&c.ends[0]==o&&(r=c.incomingTag),c.outgoingTag&&c.ends[1]==o&&(r=c.outgoingTag),n&&console.log("Navigating from ",a.name," through ",c.name," to ",o.name)}return{target:o,tag:r,traversedConnectors:i}},setInitialState(t){var n;null==e||null===(n=e.onaddobject)||void 0===n||n.call(e,t)},get afterRegex(){return a},get whenRegex(){return o}}),null==e||null===(n=e.onload)||void 0===n||n.call(e,t)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r,i,a,o,c=n(0);function s(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){function a(t){s(c,r,i,a,o,"next",t)}function o(t){s(c,r,i,a,o,"throw",t)}var c=t.apply(e,n);a(void 0)}))}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e,n=1;n<arguments.length;n++)e=null==arguments[n]?{}:arguments[n],n%2?u(Object(e),!0).forEach((function(n){p(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}globalThis.disableEther=!1;var f=/([^]*)\(([^)]*)\)/;class h{constructor(t,e){this.setModel(t),this.settings=e,o=e,this.nbMessagesToKeepInEther=(null==e?void 0:e.nbMessagesToKeepInEther)||0}setModel(t){this.currentModel=t,a=t,globalThis.currentModel=t}copyConfig(t){var e=Object.assign({},t);return e.currentState={},Object.entries(t.currentState).forEach(t=>{var[n,r]=t;e.currentState[n]=r.slice(0)}),e.histories={},Object.entries(t.histories).forEach(t=>{var[n,r]=t;e.histories[n]=r.slice(0)}),e.objectState={},Object.entries(t.objectState).forEach(t=>{var[n,r]=t;e.objectState[n]=d({},r),r.__EP__&&(e.objectState[n].__EP__=r.__EP__.slice(0))}),e.ether=d({},e.ether),e}get configuration(){return i}get sysHistory(){return r}set sysHistory(t){r=t}serializeConfig(t){return JSON.stringify(this.treeifyConfig(t))}treeifyConfig(t,e){function n(t){return{source:e?t.source:"[",target:t.target,signature:t.signature,tag:t.tag}}var r={currentState:{},histories:{},objectState:Object.fromEntries(Object.entries(t.objectState).map(t=>{var[e,r]=t;return[e,Object.fromEntries(Object.entries(r).sort(c.b).map(t=>{var[e,r]=t;return"__EP__"===e?[e,r.map(n)]:[e,r]}))]}).sort(c.b)),ether:Object.fromEntries(Object.entries(t.ether).map(t=>{var[e,r]=t;return[e,r.map(n)]}).sort(c.b))};return this.currentModel.objects.filter(t=>this.currentModel.isActive(t)).forEach(e=>{r.currentState[e.name]=t.currentState[e.name].map(t=>this.currentModel.stateFullName(t))}),Object.entries(t.histories||{}).forEach(t=>{var[e,n]=t;r.histories[e]=n.map(t=>this.currentModel.stateFullName(t))}),r}addToEther(t){var e;if(!disableEther)if(t.target&&"]"!==t.target&&(null===(e=this.settings)||void 0===e?void 0:e.enableEventPools)){var n=i.objectState[t.target];n.__EP__=n.__EP__||[],n.__EP__.push(t)}else{var r,a=t.signature.replace(f,"$1"),o=i.ether[a]||[];if(null===(r=this.settings)||void 0===r?void 0:r.keepOneMessagePerTrigger){var c=0==this.nbMessagesToKeepInEther?o.length:-this.nbMessagesToKeepInEther;o.slice(0,c).forEach(t=>{t.ignored=!0}),o=o.slice(c)}t.ignored=!1,o.push(t),i.ether[a]=o}}removeFromEther(t){var e=t.signature.replace(f,"$1"),n=this.getEP(t.target);if(n.some(e=>e==t))1===n.length?delete this.getObjectState(t.target).__EP__:Object(c.i)(this.getEP(t.target),t);else{var r=i.ether[e];1===r.length?delete i.ether[e]:Object(c.i)(r,t)}}getObjectState(t){return i.objectState[t]}getEP(t){return this.getObjectState(t).__EP__||[]}findMessageInEP(t,e,n){return this.getEP(e).find(e=>e.signature.replace(f,"$1")===t&&(!n||n.includes(e.tag)))}findMessage(t,e,n){t=t.replace(f,"$1");var r=this.findMessageInEP(t,e,n);if(r)return r;var a=i.ether[t];return a&&0<a.length?e?a.find(t=>"]"===t.target||t.target===e):a[0]:void 0}backToInternal(t){i=r[t].configuration,r.slice(t).forEach(t=>{t.messages.forEach(t=>{delete t.receivedAt,t.targeted||(t.target="]")})}),r=r.slice(0,t)}isActivable(t){var e=i.currentState[this.currentModel.getTransObject(t).name],n=Object(c.h)(e);return n.kind?this.currentModel.stateFullName(t.source)===this.currentModel.stateFullName(n):e.map(t=>this.currentModel.stateFullName(t)).includes(this.currentModel.stateFullName(t.source))}eventMatched(t){var e;return this.currentModel.noEventTrigger(t)||!(null!==(e=this.settings)&&void 0!==e)||!e.checkEvents||this.findMessage(t.trigger,this.currentModel.getTransObject(t).name,t.ports)}isCurrentState(t){return i.currentState[this.currentModel.getStateObject(t).name].map(t=>this.currentModel.stateFullName(t)).includes(this.currentModel.stateFullName(t))}setInitialState(t){i.currentState[t.name]=[this.currentModel.getInitial(t)]}getFireable(t,e){return e=e||(t=>this.isFireable(t)),i.currentState[t.name].flatMap(t=>(t.outgoing||[]).concat(Object.values(t.internalTransitions||{})).filter(e))}callOperation(t,e,n){var o=t.split("."),c=a.getObject(o[0]),s=o[1],l={cause:"operation:".concat(t).concat(e?":".concat(e):n?":".concat(n.name):""),activeObject:c,configuration:this.copyConfig(i),messages:[]},u=this.findMessage(s,c.name),d=c.operationByName&&c.operationByName[s];!u||e||n?(u={source:e||(n?n.name:"["),target:autoReceiveDisabled.checked?"]":c.name,signature:"".concat(s),receivedAt:autoReceiveDisabled.checked?void 0:l,sentAt:l},l.messages.push(u),this.currentModel.isActive(c)&&(!d||!d.method)&&this.addToEther(u)):(u.receivedAt=l,u.target=c.name,l.messages.push(u),this.removeFromEther(u)),d&&d.method&&y(d.method,l,c),r.push(l)}fireInternal(t){var e;if(this.isFireable(t)){i.histories=i.histories||{},i.objectState=i.objectState||{};var n=this.currentModel.getTransObject(t);i.objectState[n.name]=i.objectState[n.name]||{};var a={cause:"transition:".concat(this.currentModel.transFullName(t)),activeObject:n,configuration:this.copyConfig(i),messages:[]},o=i.currentState[n.name];if("shallowHistory"==t.target.kind){var s=i.histories[this.currentModel.stateFullName(t.target.region)];i.currentState[n.name]=s||this.currentModel.fullState(t.target.region)}else t.isInternal||(i.currentState[n.name]=this.currentModel.fullState(t.target));for(;0<(Object(c.h)(i.currentState[n.name]).states||[]).length;)i.currentState[n.name].push(this.currentModel.getInitial(Object(c.h)(i.currentState[n.name])));var l,u=this.currentModel.stateFullName(i.currentState[n.name][0]),d=[i.currentState[n.name][0]];i.currentState[n.name].slice(1).forEach(t=>{var e=Object(c.h)(d).states.some(t=>"shallowHistory"===t.kind);d.push(t),e&&(i.histories[u]=d.slice(0)),u+="."+t.name}),t.trigger&&((l=this.findMessage(t.trigger,n.name,t.ports))?(l.receivedAt=a,l.target=n.name,a.messages.push(l),this.removeFromEther(l)):a.messages.push({source:"[",target:n.name,signature:t.trigger,receivedAt:a}));for(var p=i.currentState[n.name].slice(),h=0;h<p.length&&h<o.length&&p[h]===o[h]&&(t.source!=p[h]||t.isInternal);h++);if(o=o.slice(h),p=p.slice(h),o.forEach(t=>{t.exit&&y(t.exit,a,n)}),l){var g=l.signature.match(f);if(g){i.objectState[n.name].__OP_NAME__=g[1];var _=g[2].split(",").map(t=>t.trim());if(i.objectState[n.name].__ARGS__=_,t.trigger.match(f)){var m=t.trigger.replace(f,"$2").trim();if(m){var v=m.split(",").map(t=>t.trim());i.objectState[n.name].__NAMED_ARGS__=Object.fromEntries(Object(c.k)(v,_.map(t=>1*t)))}}}}t.effect&&y(t.effect,a,n);var b=Object(c.h)(i.currentState[n.name]);if(b.kind||(i.objectState[n.name].__OP_NAME__=void 0,i.objectState[n.name].__ARGS__=void 0,i.objectState[n.name].__NAMED_ARGS__=void 0),p.forEach(t=>{t.entry&&y(t.entry,a,n)}),r.push(a),(null===(e=this.settings)||void 0===e?void 0:e.fireInitialTransitions)&&"initial"==b.kind){var E=b.outgoing[0];this.fireInternal(E)}return l}console.log("Tried to fire a non-fireable transition: ",this.currentModel.transFullName(t))}evalGuard(t){var e;return!("else"!=t.guard&&!(null===(e=this.settings)||void 0===e?void 0:e.considerGuardsTrue))||y(t.guard,{messages:[]},this.currentModel.getTransObject(t))}isFireable(t){return this.isActivable(t)&&this.eventMatched(t)&&(!t.guard||this.evalGuard(t))}getFireableTransitions(){var t,e=this.currentModel.objects.filter(t=>this.currentModel.isActive(t)).flatMap(t=>{var e,n,r,a=this.getFireable(t);if(null===(e=this.settings)||void 0===e?void 0:e.matchFirst){var o,c=(i.objectState[t.name].__EP__||[]).map(t=>t.signature.replace(f,"$1")),s=null===(o=(n=a.filter(t=>t.trigger),r=t=>c.indexOf(t.trigger.replace(f,"$1")),n.sort((t,e)=>{var n=r(t),i=r(e);return n<i?-1:n>i?1:0}))[0])||void 0===o?void 0:o.trigger;s&&(a=a.filter(t=>this.currentModel.noEventTrigger(t)||t.trigger===s))}return a});return(null===(t=this.settings)||void 0===t?void 0:t.reactiveSystem)&&e.some(t=>!this.currentModel.getTransObject(t).isActor)&&(e=e.filter(t=>!this.currentModel.getTransObject(t).isActor)),e}getFireables(){var t=this;return l((function*(){return t.getFireableTransitions().map(e=>t.currentModel.transFullName(e))}))()}getConfiguration(){var t=this;return l((function*(){return t.serializeConfig(i,!1)}))()}setConfiguration(t){var e=JSON.parse(t);i={currentState:Object.fromEntries(Object.entries(e.currentState).map(t=>{var[e,n]=t;return[e,n.map(t=>this.currentModel.getState(t))]})),histories:Object.fromEntries(Object.entries(e.histories).map(t=>{var[e,n]=t;return[e,n.map(t=>this.currentModel.getState(t))]})),objectState:e.objectState,ether:e.ether}}fire(t){var e=this;return l((function*(){var n=e.currentModel.getTransition(t);for(e.fireInternal(n);(null===(r=o)||void 0===r?void 0:r.autoFireAfterChoice)&&"choice"===n.target.kind;){var r,i=e.currentModel.getTransObject(n),a=e.getFireable(i);if(1!=a.length&&(a=a.filter(t=>"else"!==t.guard)),1!=a.length)throw"There should be exactly one fireable transition";n=a[0],e.fireInternal(n)}}))()}reset(){var t;r=[],i={currentState:{},histories:{},objectState:Object.fromEntries(this.currentModel.objects.map(t=>[t.name,{}])),ether:{}},this.currentModel.objects.forEach(t=>this.setInitialState(t)),(null===(t=this.settings)||void 0===t?void 0:t.fireInitialTransitions)&&this.currentModel.objects.filter(t=>this.currentModel.isActive(t)).forEach(t=>{var e=this.getFireable(t);1!==e.length&&alert("Expected only one initial transition"),"initial"!==e[0].source.kind&&alert("Expected source of initial transition to be an initial Pseudostate"),this.fireInternal(e[0])})}get modelName(){var t;return null===(t=this.currentModel)||void 0===t?void 0:t.name}get name(){return"AnimUML"}parseTransition(t){return l((function*(){return t}))()}parseConfiguration(t){return l((function*(){return t}))()}showTransition(t){var e=this;return l((function*(){var n=e.currentModel.getTransition(t);return{object:e.currentModel.getTransObject(n).name,name:n.name,source:n.source.name,target:n.target.name}}))()}showConfiguration(t){return l((function*(){return JSON.parse(t)}))()}evaluateAtom(t,e){return l((function*(){return y(t,{},{},e)}))()}}function g(t){return"__EMI__".concat(t)}function _(t){return null==t?void 0:t.replace(/__EMI__/g,"")}function m(){function t(){return r[n]}var e,n=r.length-1,i=[t()];if(null===(e=o)||void 0===e?void 0:e.autoFireAfterChoice)for(;t().cause.startsWith("transition:")&&"choice"===a.getTransition(t().cause.replace(/^transition:/,"")).source.kind;)i.unshift(r[--n]);return i}var v={};v={FALSE:0,TRUE:1,getters:{params(t){var e,n=i.objectState[t.name],r=n.__OP_NAME__,a=n.__ARGS__,o={},c=null===(e=t.operationByName)||void 0===e?void 0:e[r];return c&&c.parameters&&c.parameters.forEach((t,e)=>{o[t]=1*a[e]}),o}},SEND(t,e){t[e.valueOfProperty].apply(this,Array.prototype.slice.call(arguments,2))},GET(t,e){var n,r=t;if(t.name&&a.getObject(t.name)&&(r=i.objectState[t.name]),t!=this&&e.valueOfProperty){var o,c=_(t.valueOfProperty);c==(null===(o=a.getObject(c))||void 0===o?void 0:o.name)&&(r=i.objectState[c])}return null==n&&(n=r[g(e.valueOfProperty)]),null==n&&(n=!1),n},SET(t,e,n){t.name&&a.getObject(t.name)&&(t=i.objectState[t.name]),t[g(e.valueOfProperty)]=n,n||delete t[g(e.valueOfProperty)]},AT:(t,e)=>t[e],CALL(t,e){return t[e.valueOfProperty].apply(this,Array.prototype.slice(arguments,2))},INC(t,e,n){t[g(e.valueOfProperty)]+=n},DEC(t,e,n){t[g(e.valueOfProperty)]-=n,t[g(e.valueOfProperty)]||delete t[g(e.valueOfProperty)]},IS_IN_STATE(t,e){var n=i.currentState[_(t.valueOfProperty)].includes(a.getState(_(e.valueOfProperty)));return n},MESSAGES:()=>m().flatMap(t=>t.messages),SENT_MESSAGES:()=>m().flatMap(t=>t.messages.filter(e=>e.sentAt==t)),RECEIVED_MESSAGES:()=>m().flatMap(t=>t.messages.filter(e=>e.receivedAt==t)),EP_IS_EMPTY(t){var e=_(t.valueOfProperty);e.startsWith("ROOT_")&&(e=e.replace(/^ROOT_instMain\./,"").replace(/\./g,"_"));var n=Object.values(i.ether).flatMap(t=>t.map(t=>t.target)).includes(e);return!Object(c.f)(i.objectState[e].__EP__)&&!n},EP_CONTAINS(t,e){_(t.valueOfProperty);var n,r=e.valueOfProperty.replace(/^SIGNAL_/,"");return 0<(null===(n=i.ether[r.replace(/^SIGNAL_/,"")])||void 0===n?void 0:n.length)},printf(){console.log.apply(console,arguments)}};var b=/^uninitializedValue\((.*)\)$/;function y(t,e,n,r){function c(t){return _("function"==typeof t&&t.valueOfProperty?t.valueOfProperty:"object"==typeof t&&t.returnValueOf?t.returnValueOf.signature:JSON.stringify(t))}function s(t){var e;return t==d?"this":"object"==typeof t&&t.returnValueOf?"".concat(t.returnValueOf.signature):!t.valueOfProperty||null!==(e=o)&&void 0!==e&&e.symbolicValues?c(t):0}function l(t,r,o){if(t.valueOfProperty){var s=a.getObjectRelative(n,_(t.valueOfProperty));s&&s==a.getObject(s.name)&&(t=i.objectState[s.name],r=r.split(".")[1])}if("object"==typeof o&&o.returnValueOf){var l=o.returnValueOf;l.target=n.name;var u,d=l.signature.replace(f,"$1"),p=n.operationByName&&n.operationByName[d];p&&p.method&&(u=y(p.method,e,n)),o.returnValueOf.signature="".concat(_(r)," = ").concat(_(o.returnValueOf.signature)).concat(u?" : ".concat(c(u)):""),"function"==typeof u&&u.valueOfProperty&&(u="uninitializedValue(".concat(u.valueOfProperty,")")),u?t[r]=u:delete t[r]}else{o?t[r]=o:delete t[r];var h={source:n.name,target:n.name,signature:"".concat(_(r)," = ").concat(c(o)),sentAt:e,receivedAt:e,type:"set"};e.messages.push(h)}return!0}var u=n.name?i.objectState[n.name]:n,d=new Proxy(u,{get(t,i){var c;if("console"==i)return console;if(i in t||"symbol"==typeof i)return t[i];var p=u.__NAMED_ARGS__;if(null==p?void 0:p.hasOwnProperty(i))return p[i];if(r&&r.hasOwnProperty(i)){var f=r[i];return f.bind&&f.bind(d),f}if(v.hasOwnProperty(i)){var h=v[i];return h.bind&&h.bind(d),h}return(null===(c=v.getters)||void 0===c?void 0:c.hasOwnProperty(i))?v.getters[i].bind(d)(n):function t(r){function i(t){return"".concat(r).concat(t.match(/^[0-9]*$/)?"[".concat(t,"]"):t.match(b)?"[".concat(t.replace(b,"$1"),"]"):"."+t)}var c=function(){};return c.toString=()=>!1,c.valueOfProperty=r,new Proxy(c,{apply(t,i,o){var c,l,u=_(r.toString()),d="]",p=u.split(/\./),f=!1;2==p.length&&((c=a.getObject(p[0]))||(c=a.getObject(p[0].replace(/\[([0-9]+)\]$/,"$1")))||(c=a.getObjectRelative(n,p[0])))&&(({target:c,tag:l}=a.navigateThroughPorts(n,c,!1)),d=c.name,u=p[1],f=!0);var h={source:n.name,target:d,signature:"".concat(u,"(").concat(Array.prototype.map.call(o,s).join(", "),")"),sentAt:e};return l&&(h.tag=l),f&&(h.targeted=!0),e.messages.push(h),builtInEngine.addToEther(h),{returnValueOf:h}},get(e,n){var a;return n==Symbol.toPrimitive&&(null===(a=o)||void 0===a?void 0:a.symbolicValues)?()=>"uninitializedValue(".concat(r,")"):n in e||"symbol"==typeof n?e[n]:t(i(n))},has:(t,e)=>!0,set:(t,e,n)=>l(t,i(e),n)})}(i)},has:(t,e)=>!["console","alert"].includes(e),set:(t,e,n)=>l(t,e,n)});return contextualEval.call(d,t)}globalThis.evalActions=y},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(1),i=n(0),a=n(17);function o(){var t=g(['\n\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\txlink:href="#unaccepted"\n\t\t\t\t\t','\n\t\t\t\t\tcall="msg[',']"\n\t\t\t\t\trightmost="','"\n\t\t\t\t>\n\t\t\t\t\t<param name="signature" value="','"/>\n\t\t\t\t</use>\n\t\t\t']);return o=function(){return t},t}function c(){var t=g(['\n\t\t\t\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\t\t\t\txlink:href="#invariant"\n\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<param name="on" value="','"/>\n\t\t\t\t\t\t\t\t<param name="invariant" value="','"/>\n\t\t\t\t\t\t\t\t<param name="link" value="javascript:backTo(',');"/>\n\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t']);return c=function(){return t},t}function s(){var t=g(['\n\t\t\t\t\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\t\t\t\t\txlink:href="#found"\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\tleftmost="','"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<param name="on" value="','"/>\n\t\t\t\t\t\t\t\t\t<param name="signature" value="','"/>\n\t\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t\t']);return s=function(){return t},t}function l(){var t=g(['\n\t\t\t\t\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\t\t\t\t\txlink:href="#','accept"\n\t\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t\t\tcall="msg[',']"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<param name="on" value="','"/>\n\t\t\t\t\t\t\t\t\t<param name="signature" value="','"/>\n\t\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t\t']);return l=function(){return t},t}function u(){var t=g(['\n\t\t\t\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\t\t\t\txlink:href="#call"\n\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<param name="on" value="','"/>\n\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t']);return u=function(){return t},t}function d(){var t=g(['\n\t\t\t\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\t\t\t\txlink:href="#set"\n\t\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<param name="on" value="','"/>\n\t\t\t\t\t\t\t\t<param name="signature" value="','"/>\n\t\t\t\t\t\t\t</use>\n\t\t\t\t\t\t']);return d=function(){return t},t}function p(){var t=g(['\n\t\t\t\t\t\t<use\tid="msg[',']"\n\t\t\t\t\t\t\txlink:href="#after"\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<param name="on" value="','"/>\n\t\t\t\t\t\t\t<param name="signature" value="','"/>\n\t\t\t\t\t\t</use>\n\t\t\t\t\t']);return p=function(){return t},t}function f(){var t=g(['\n\t\t\t\t<use id="','" xlink:href="#','" ','>\n\t\t\t\t\t<param name="name" value="'," : ",'"/>\n\t\t\t\t</use>\n\t\t\t']);return f=function(){return t},t}function h(){var t=g(["\n\t\t","\n\n\n\t\t","\n\t\t","\n\t"]);return h=function(){return t},t}function g(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function _(t,e,n){function g(){return 0<k?'after="msg['.concat(k-1,']"'):""}function _(t){return t.replace(/"/g,"&quot;")}var{origin:m,scale:v,hideSets:b,hideStates:y,showPseudostateInvariants:E,hideLinks:O}=n,j=e.objects.filter(t=>!e.isPort(t)),k=-1,M={},T=[],x={};return Object(a.a)(Object(r.a)(h(),j.map((t,e)=>Object(r.a)(f(),t.name,t.isActor?"actor":"object",0==e?'x="100" y="0"':'after="'.concat(j[e-1].name,'"'),t.name,t.class||"")),t.flatMap((t,n)=>{var a=[].concat((t.messages||[]).map(e=>{var n="";return e.signature.match(/^after\(/)?(k++,n+=Object(r.a)(p(),k,g(),j.map(t=>t.name).join(","),e.signature)):"set"===e.type?(b||(k++,n+=Object(r.a)(d(),k,g(),e.source,_(e.signature))),n):(e.sentAt==t&&"["!==e.source&&(k++,e.callId=k,n+=Object(r.a)(u(),k,g(),e.source),T.push(k),x[k]=e.signature),e.receivedAt==t&&("callId"in e?(k++,n+=Object(r.a)(l(),k,e.source===e.target?"self":"",g(),e.callId,e.target,_(e.signature)),Object(i.i)(T,e.callId)):(k++,n+=Object(r.a)(s(),k,g(),j[0].name,e.target,_(e.signature)))),n)}));if(t.activeObject){var o=t.activeObject.name;if(!y){var f=function(t){if(t.cause.startsWith("transition:")){var n=t.cause.replace(/^transition:/,""),r=e.getTransition(n).target;if(!r.kind||E)return e.fullState(r).map(t=>t.name).join(".")}}(t);f&&(0==n||f!==M[o])&&(k++,a.push(Object(r.a)(c(),k,g(),o,_(f),n+1)),M[o]=f)}}return a}).join("\n"),T.map(t=>(k++,Object(r.a)(o(),k,g(),t,Object(i.h)(j).name,_(x[t])))).join("\n")),{origin:m,scale:v,hideLinks:O})}},function(t,e,n){"use strict";function r(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){function o(t){r(s,i,a,o,c,"next",t)}function c(t){r(s,i,a,o,c,"throw",t)}var s=t.apply(e,n);o(void 0)}))}}n.d(e,"a",(function(){return l}));var a={connect:(t,e)=>new Promise(n=>{var r=new WebSocket(t);r.onclose=null==e?void 0:e.onclose,r.onopen=()=>{n(new function(){function e(t){r.send(t)}function n(){return a.apply(this,arguments)}function a(){return(a=i((function*(){return new Promise(t=>{s.push(t)})}))).apply(this,arguments)}function o(t){var r=n();return e("PARSE_CONFIGURATION"),e(t),r}var c=this,s=[];r.onmessage=function(){var t=i((function*(t){var e=s.shift();e?e(t.data):console.log("Unexpected message from remote engine: %s",t.data)}));return function(){return t.apply(this,arguments)}}(),this.reset=()=>{e("RESET")},this.getConfiguration=i((function*(){var t=n();return e("GET_CONFIGURATION"),t})),this.evaluateAtom=function(){var t=i((function*(t){var r=n();return e("EVALUATE_ATOMS:".concat(t)),r.then(t=>JSON.parse(t)[0])}));return function(){return t.apply(this,arguments)}}(),this.getFireables=i((function*(){var t=n().then(function(){var t=i((function*(t){for(var e=[],r=0;r<t;r++)e.push(yield n());return e}));return function(){return t.apply(this,arguments)}}());return e("GET_FIREABLES"),t})),this.setConfiguration=t=>{e("SET_CONFIGURATION"),e(t)},this.fire=t=>{e("FIRE"),e(t)},this.parseTransition=t=>{var r=n();return e("PARSE_TRANSITION"),e(t),r},this.parseConfiguration=function(){var t=i((function*(t){return c.useHash?(t.arrayBuffer&&(t=yield t.arrayBuffer()),String.fromCharCode.apply(null,new Uint8Array(yield crypto.subtle.digest(c.useHash,t)))):yield o(t)}));return function(){return t.apply(this,arguments)}}(),this.showConfiguration=function(){var t=i((function*(t){var e=yield o(t);return JSON.parse(e)}));return function(){return t.apply(this,arguments)}}(),this.showTransition=function(){var t=i((function*(t){return JSON.parse(yield c.parseTransition(t))}));return function(){return t.apply(this,arguments)}}(),this.close=()=>{r.close()},Object.assign(this,{get modelName(){return t},get name(){return"RemoteEngine"}})})}})},o=n(0);function c(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){function a(t){c(s,r,i,a,o,"next",t)}function o(t){c(s,r,i,a,o,"throw",t)}var s=t.apply(e,n);a(void 0)}))}}var l={connect:(t,e)=>s((function*(){var n=yield a.connect(t,e);return{isFireable(){throw"unsupported"},getFireables:()=>s((function*(){return yield n.getFireables()}))(),getConfiguration:()=>s((function*(){return yield n.getConfiguration()}))(),setConfiguration:t=>s((function*(){yield n.setConfiguration(t)}))(),fire:t=>s((function*(){yield n.fire(t)}))(),reset:()=>s((function*(){yield n.reset()}))(),get modelName(){return n.modelName},get name(){return"EMI"},parseTransition:t=>s((function*(){return yield n.parseTransition(t)}))(),parseConfiguration:t=>s((function*(){var e=yield n.parseConfiguration(t);return e=function(t){return function t(e,n){if(e.hasOwnProperty("value"))n[e.name]=e.value;else{if(!e.children)throw console.log("Cannot convert EMI configuration node (it has neither value nor children):",e),"Cannot convert EMI configuration node";var r={};n[e.name]=r,e.children.forEach(e=>{t(e,r)})}return n}(JSON.parse(t),{})}(e),JSON.stringify(function(t){return{currentState:Object.fromEntries(Object.entries(t.store).filter(t=>{var[e,n]=t;return n.cs}).map(t=>{var[e,n]=t;return[e=e.replace(/^instMain_/,""),["".concat(e,".").concat(n.cs)]]})),histories:{},objectState:Object.fromEntries(Object.entries(t.store).filter(t=>{var[e,n]=t;return e.startsWith("instMain_")&&currentModel.getObject(e.replace(/^instMain_/,""))}).map(t=>{var e,[n,r]=t;return[n=n.replace(/^instMain_/,""),Object.fromEntries(Object.entries(r.od||{}).filter(t=>{var[e,n]=t;return 0!=JSON.parse(n)}).map(t=>{var[e,n]=t;return["__EMI__".concat(e),JSON.parse(n)]}).concat(1*(null===(e=r.ep)||void 0===e?void 0:e.nbEvents)?[["__EP__",Object.values(r.ep.eventOccurred).slice(0,r.ep.nbEvents).map((t,e)=>({source:"[",target:n,signature:"".concat(t.signalEventId.replace(/_SE$/,""),"(").concat(r.ep_params?Object.values(Object.values(r.ep_params.eventOccurred)[e].union["".concat(t.signalEventId.replace(/_SE$/,""),"_params")]||{}).join(", "):"",")"),tag:"(no port)"===t.portId?void 0:t.portId}))]]:[]).sort(o.b))]}).sort(o.b)),ether:{}}}(e))}))(),showConfiguration(t){var e=this;return s((function*(){var n=yield e.parseConfiguration(t);return JSON.parse(n)}))()},showTransition:t=>s((function*(){var e=(yield n.showTransition(t))[0];return{object:e.activeObject.replace(/^instMain_/,""),name:e.transitions[0],source:e.source,target:e.target}}))(),evaluateAtom:t=>s((function*(){return n.evaluateAtom(t)}))(),close(){n.close()}}}))()}},function(t,e,n){n(24),t.exports=n(25)},function(t,e){!function(e){"use strict";var n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag",s="object"==typeof t,l=e.regeneratorRuntime;if(l)s&&(t.exports=l);else{(l=e.regeneratorRuntime=s?t.exports:{}).wrap=g;var u={},d={};d[a]=function(){return this};var p=Object.getPrototypeOf,f=p&&p(p(T([])));f&&f!==n&&r.call(f,a)&&(d=f);var h=b.prototype=m.prototype=Object.create(d);v.prototype=h.constructor=b,b.constructor=v,b[c]=v.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(h),t},l.awrap=function(t){return{__await:t}},y(E.prototype),E.prototype[o]=function(){return this},l.AsyncIterator=E,l.async=function(t,e,n,r){var i=new E(g(t,e,n,r));return l.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},y(h),h[c]="Generator",h[a]=function(){return this},h.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=T,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}}}function g(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),o=new M(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return x()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var c=O(o,n);if(c){if(c===u)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=_(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===u)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,o),a}function _(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function m(){}function v(){}function b(){}function y(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function E(t){var e;this._invoke=function(n,i){function a(){return new Promise((function(e,a){!function e(n,i,a,o){var c=_(t[n],t,i);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,a,o)}),(function(t){e("throw",t,a,o)})):Promise.resolve(l).then((function(t){s.value=t,a(s)}),o)}o(c.arg)}(n,i,e,a)}))}return e=e?e.then(a,a):a()}}function O(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=_(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"testExport",(function(){return testExport})),__webpack_require__.d(__webpack_exports__,"testComparedExecutions",(function(){return testComparedExecutions})),__webpack_require__.d(__webpack_exports__,"sysHistoryEngine",(function(){return sysHistoryEngine})),__webpack_require__.d(__webpack_exports__,"toggle",(function(){return toggle})),__webpack_require__.d(__webpack_exports__,"disconnectFromEMI",(function(){return disconnectFromEMI})),__webpack_require__.d(__webpack_exports__,"disconnectFromTool",(function(){return disconnectFromTool})),__webpack_require__.d(__webpack_exports__,"backTo",(function(){return backTo})),__webpack_require__.d(__webpack_exports__,"fire",(function(){return fire})),__webpack_require__.d(__webpack_exports__,"emiFire",(function(){return emiFire})),__webpack_require__.d(__webpack_exports__,"exportDynamicSymbols",(function(){return exportDynamicSymbols}));var _Export2tUML_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),_Export2C_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11),_RemoteTool_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(12),_EMIRemoteEngine_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(22),_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(4),_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),_TransformStateMachine2Explicit_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9),_History2PlantUMLTiming_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(13),_History2PlantUMLSequence_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(14),_PlantUMLURI_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(15),_ExportUtils_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2),_Utils_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);__webpack_require__.d(__webpack_exports__,"diffInternal",(function(){return _Utils_js__WEBPACK_IMPORTED_MODULE_11__.a}));var _DiffExplorer_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(18),_TestCases_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(26),_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(5),_Editor_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6),_Model_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(19),_AnimUMLEngine_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(20),_InteractionEngine_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(28),_SynchronousCompositionEngine_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(29),_AnimUMLSmallerStepsEngine_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(30),_History2TCSVGSequence_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(21);function asyncGeneratorStep(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){function a(t){asyncGeneratorStep(c,r,i,a,o,"next",t)}function o(t){asyncGeneratorStep(c,r,i,a,o,"throw",t)}var c=t.apply(e,n);a(void 0)}))}}__webpack_require__.d(__webpack_exports__,"last",(function(){return _Utils_js__WEBPACK_IMPORTED_MODULE_11__.h}));var startAndNoExportAtEOF=!0;function start(){if(doExportSymbols(),document.location.hash)try{var t=JSON.parse(decodeURIComponent(document.location.hash.slice(1)));t.name="Imported_".concat(t.name.replace(/^Imported_/,"")),t=Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t),examples.unshift(t)}catch(t){throw console.log("Error importing model from URL: %s",t),t}init(),window.builtInEngine=new _AnimUMLEngine_js__WEBPACK_IMPORTED_MODULE_17__.a(void 0,{get checkEvents(){return checkEvents.checked},get enableEventPools(){return enableEventPools.checked},get keepOneMessagePerTrigger(){return keepOneMessagePerTrigger.checked},get fireInitialTransitions(){return fireInitialTransitions.checked||Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.b)()},get autoFireAfterChoice(){return autoFireAfterChoice.checked||Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.b)()},get considerGuardsTrue(){return considerGuardsTrue.checked},get matchFirst(){return matchFirst.checked},get reactiveSystem(){return reactiveSystem.checked},get symbolicValues(){return symbolicValues.checked}}),window.engine=builtInEngine,loadFirstValidExample()}var plantumlServer="www.plantuml.com";plantumlServer=location.host;var plantumlPrefix="/plantuml/",pu=document.location.protocol+"//"+plantumlServer+plantumlPrefix,svgNS="http://www.w3.org/2000/svg",xlinkNS="http://www.w3.org/1999/xlink",wsHost=document.location.hostname,wsProt=document.location.protocol.match(/https/)?"wss":"ws",wsPort=0==document.location.port.length?"":":".concat(document.location.port);toolURL.value="".concat(wsProt,"://").concat(wsHost).concat(wsPort,"/obp2");var emiURLPrefix="".concat(wsProt,"://").concat(wsHost).concat(wsPort,"/emi");emiURL.value="".concat(emiURLPrefix,"/LevelCrossing.emi/");var currentModel,defaultsToAllObjects=!0,testCSSAnimation=!1,colors={currentStateColor:"lightgreen",fireableTransitionColor:"green",noEventColor:"red",falseGuardColor:"red"},editing=!1;window.displayedObjects=void 0;var participants,callPrefix="",objectSelect=document.getElementById("objectSelect"),ALL_OBJECTS="All objects";function getObjectSelectIndex(t){return currentModel.objects.map(t=>t.name).indexOf(t)+(defaultsToAllObjects?1:0)}function switchToObject(t){objectSelect.selectedIndex=getObjectSelectIndex(t),displayedObjects=[currentModel.getObject(t)],Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.c)(currentModelWrapper),updateFig()}objectSelect.onchange=()=>{var t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.e)(objectSelect);t==ALL_OBJECTS?(displayedObjects=currentModel.objects.slice(),Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.c)(currentModelWrapper),updateFig()):switchToObject(t)};var currentModelWrapper,oldCurrentModelWrapper={},hideEmptyHistory=!1,changeSVGLinksIntoListeners=!1;function load(){return _load.apply(this,arguments)}function _load(){return(_load=_asyncToGenerator((function*(t){var e=yield internalLoad(t);return updateFig(),e}))).apply(this,arguments)}function setHistoryType(t){historyType.selectedIndex=Array.prototype.map.call(historyType.options,t=>t.value).indexOf(t)}function internalLoad(){return _internalLoad.apply(this,arguments)}function _internalLoad(){return(_internalLoad=_asyncToGenerator((function*(t){function e(t){if(t.loop)for(var n=0;n<t.loop;n++)t.causes.forEach(e);else{var r=t.split(":");switch(r[0]+""){case"transition":builtInEngine.fireInternal(currentModel.getTransition(r[1]));break;case"operation":builtInEngine.callOperation(r[1],r[2]);break;case"PlantUML":builtInEngine.sysHistory.push({cause:t,PlantUML:r.slice(1).join(":")});break;default:console.log("Unknown history step cause: ".concat(r[0]," in ").concat(t))}}}var n=t.historyCauses;if(t=new _Model_js__WEBPACK_IMPORTED_MODULE_16__.a(t,{onload(){},onaddobject(t){builtInEngine.setInitialState(t)}}),currentModel=t,currentModelWrapper=t,builtInEngine.setModel(t),displayedObjects=defaultsToAllObjects?currentModel.objects.slice():[currentModel.objects[0]],participants=currentModel.objects.slice(),editor.setModel(t),checkEvents.checked=1<t.objects.length,emiURL.value="".concat(emiURLPrefix,"/").concat(t.name.replace(/^(Imported_)?(UML2AnimUML_)?/,""),".emi/"),updateObjects(),updateExport(t),Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.c)(t),window!=window.parent&&(changeSVGLinksIntoListeners=!0),t.settings){var r,i=t.settings.interface,a=t.settings.display,o=t.settings.semantics;if(i){if(i.iframe&&(callPrefix="get('".concat(i.iframe,"').")),i.hideEmptyHistory&&(hideEmptyHistory=!0),i.disableExperimental){var c=document.getElementsByClassName("experimental");for(var s of c)hide(s)}if(i.disableModelSelection&&(hide(modelSelection),t.name=t.name.replace(/^Imported_/,""),t.objects[0].name=t.objects[0].name.replace(/^Imported_/,"")),i.disableObjectSelection&&hide(objectSelection),i.disableDoc&&hide(docButton),i.disableSettings&&hide(settingsButtons),i.disableHistorySettings&&hide(historySettings),i.disableReset&&hide(resetButton),i.disableSwitchDiagram&&hide(switchDiagram),i.disableExports&&(hide(modelExports),hide(historyExports)),i.hideHistory&&hide(seqDiag),i.disableEdit&&hide(editButton),i.historyType&&setHistoryType(i.historyType),i.mainWidth&&(mainDiag.style.width=i.mainWidth),i.histWidth&&(seqDiag.style.width=i.histWidth),i.load){var l;if(i.load.match(/^#/)){var u=i.load.replace(/^#/,"");try{try{l=parent.document.getElementById(u).innerHTML}catch(s){l=parent.getModel(u).innerText}}catch(s){i.iframe&&(callPrefix=""),l=yield new Promise(t=>{window.onmessage=e=>{switch(e.data.reply+""){case"getModel":t(e.data.model);break;default:console.log("Unexpected message: ",e)}},parent.postMessage({action:"getModel",id:u},"*")})}l=JSON.parse(l)}else l=examples.find(t=>t.name==i.load);t.settings.overrides&&Object.entries(t.settings.overrides).forEach(t=>{var[e,n]=t,r=l.objects.findIndex(t=>t.name===e);if(0<=r)l.objects[r]=n;else{var i=e.split("."),a=l,o=function(t){a=Array.isArray(a)?a.find(e=>e.name===t):a[t]};for(var c of i.slice(0,-1))o(c);var s=i.slice(-1)[0];if(Array.isArray(a)){var u=a.findIndex(t=>t.name===s);a[u]=n}else a[s]=n}}),!n&&t.objects[0].historyCauses&&(n=t.objects[0].historyCauses);var d,p=t;if(t=yield internalLoad(l),n&&(t.historyCauses=n),p.settings.defaultToolValues)t.settings.defaultToolValues=(null===(d=t.settings)||void 0===d?void 0:d.defaultToolValues)||{},Object.assign(t.settings.defaultToolValues,p.settings.defaultToolValues)}i.displayedObjects&&(displayedObjects=i.displayedObjects.map(e=>t.getObject(e)),participants=displayedObjects.slice(0),1==displayedObjects.length&&(objectSelect.selectedIndex=getObjectSelectIndex(displayedObjects[0].name)))}if(a&&(hideClasses.checked=a.hideClasses,hideStates.checked=a.hideStates,hideSets.checked=a.hideSets,hideMethods.checked=a.hideMethods,hideStateMachines.checked=a.hideStateMachines,showPseudostateInvariants.checked=a.showPseudostateInvariants,showPorts.checked=a.showPorts,showExplicitSM.checked=a.showExplicitSM,hideLinks.checked=a.hideLinks),o){for(var f of["fireInitialTransitions","autoFireAfterChoice","autoReceiveDisabled","considerGuardsTrue","checkEvents","keepOneMessagePerTrigger","enableEventPools","matchFirst","symbolicValues","reactiveSystem"])f in o&&(document.getElementById(f).checked=o[f])}(null===(r=t.settings)||void 0===r?void 0:r.defaultToolValues)&&(globalThis.defaultToolValues=t.settings.defaultToolValues)}return builtInEngine.reset(),(t.historyCauses||[]).forEach(t=>{e(t)}),t}))).apply(this,arguments)}function updateObjects(){objectSelect.innerHTML="",defaultsToAllObjects&&addOption(objectSelect,ALL_OBJECTS),currentModel.objects.forEach(t=>{addOption(objectSelect,t.name)}),objectSelect.selectedIndex=1<displayedObjects.length?0:currentModel.objects.indexOf(displayedObjects[0])+0}function switchExample(t){load(examples.find(e=>e.name==t))}globalThis.testInteractions=_asyncToGenerator((function*(){currentModel.interactions&&_asyncToGenerator((function*(){for(var[t,e]of Object.entries(currentModel.interactions)){var n=(yield __webpack_require__.e(1).then(__webpack_require__.bind(null,32))).interaction2TCSVGSequence(e,{origin:"".concat(document.location.origin,"/")});seqFigo.data="data:image/svg+xml;utf8,".concat(n)}}))()})),resetButton.onclick=()=>{builtInEngine.reset(),updateFig()};var editor,exampleSelect=document.getElementById("exampleSelect");function init(){editor=new _Editor_js__WEBPACK_IMPORTED_MODULE_15__.a,Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.b)(currentModelWrapper),examples.forEach(t=>{addExample(t)}),exampleSelect.onchange=()=>{switchExample(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.e)(exampleSelect))}}function toggle(t,e){"none"==t.style.display?show(t,e):hide(t)}function hide(t){t.style.display="none"}function show(t,e){t.style.display=e||""}function firstToUpper(t){return t[0].toUpperCase()+t.slice(1)}var checkEvents=document.getElementById("checkEvents");function fire(t){builtInEngine.fireInternal(currentModel.getTransition(t)),updateFig()}function setSender(t){globalThis.sender=currentModel.getObject(t)}function callOperation(t,e){builtInEngine.callOperation(t,e,globalThis.sender),updateFig(),globalThis.sender=void 0}function edit(){editing?(editing=!1,editBlock.style="display: none",seqDiag.style="width: 45%; float: right",inputBlock.style="display: none"):(editing=!0,editBlock.style="display: inline",seqDiag.style="display: none"),updateFig()}function toPlantUMLCom(){return"\n\t\tobject\n\t"}function stateOfIn(t,e){return e.configuration.currentState[t.name]}checkEvents.onchange=()=>updateFig(),considerGuardsTrue.onchange=updateFig,globalThis.sender=void 0,showExplicitSM.onchange=updateFig;var timingScaleDiv=document.getElementById("timingScaleDiv"),timingScale=document.getElementById("timingScale");function backTo(t){t<sysHistory.length&&(builtInEngine.backToInternal(t),updateFig())}timingScale.onchange=()=>{updateHistoryFig()},showPseudostateInvariants.onchange=()=>updateFig(),hideStates.onchange=()=>updateFig(),hideSets.onchange=()=>updateFig();var noCache=0;function updateOneFig(t,e,n){var r=testCSSAnimation&&!editing&&currentModel.name.endsWith("BoutonLampe")&&"state"===e?"".concat(document.location.origin,"/samples/BoutonLampe.svg"):testCSSAnimation&&!editing&&currentModel.name.endsWith("PubliphoneV6")&&"state"===e?"".concat(document.location.origin,"/samples/PubliphoneV6.svg"):Object(_PlantUMLURI_js__WEBPACK_IMPORTED_MODULE_9__.a)(pu,t())+"?nocache=1",i=document.getElementById("".concat(e,"Figo"));i.data!==r&&(i.data=r);var a,o=document.getElementById("".concat(e,"PlantUML"));o.href="#clickLinkToUpdateIt",o.removeAttribute("download"),o.onclick=()=>{o.href=a=a||(n?Object(_PlantUMLURI_js__WEBPACK_IMPORTED_MODULE_9__.a)(pu,n()):r).replace(/svg/,"uml")}}var withAnnotations=document.getElementById("plantUMLType");withAnnotations.checked&&show(forAnimationDiv,"inline"),withAnnotations.onchange=()=>{updateFig(),toggle(forAnimationDiv,"inline")},forAnimation.onchange=()=>{updateFig()},hideLinks.onchange=updateFig;var historyType=document.getElementById("historyType");function updateHistoryFig(){var t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.e)(historyType);if(seqFigo.hidden=!1,seqFigo.data="",seqFigs.innerHTML="",!hideEmptyHistory||0!=sysHistory.length)if("sequence"===t)updateOneFig(()=>Object(_History2PlantUMLSequence_js__WEBPACK_IMPORTED_MODULE_8__.a)(sysHistory,currentModelWrapper,currentEngine,{stateOfIn:stateOfIn,ALL_OBJECTS:ALL_OBJECTS,configuration:builtInEngine.configuration,callPrefix:callPrefix,participants:participants,colors:colors,hideStates:hideStates.checked,hideSets:hideSets.checked,hideLinks:hideLinks.checked}),"seq",()=>Object(_History2PlantUMLSequence_js__WEBPACK_IMPORTED_MODULE_8__.a)(sysHistory,currentModelWrapper,currentEngine,{stateOfIn:stateOfIn,ALL_OBJECTS:ALL_OBJECTS,configuration:builtInEngine.configuration,callPrefix:callPrefix,participants:participants,colors:colors,raw:!withAnnotations.checked,hideStates:hideStates.checked,hideSets:hideSets.checked})),timingScaleDiv.style="display: none;";else if("TCSVG sequence"===t){function e(t){return new Promise(e=>{var n=document.createElementNS(svgNS,"script");n.onload=()=>{e()},t.type&&(n.type=t.type),t.href.baseVal?n.href.baseVal=t.href.baseVal:t.textContent&&(n.textContent=t.textContent),t.parentNode.replaceChild(n,t),t.href.baseVal||e()})}function n(){return(n=_asyncToGenerator((function*(t){for(var n of Array.prototype.slice.call(t.getElementsByTagName("script"),0))yield e(n);for(var r of seqFigo.getElementsByTagName("a"))console.log(r.getAttribute("href"))}))).apply(this,arguments)}seqFigo.hidden=!0;var r=Object(_History2TCSVGSequence_js__WEBPACK_IMPORTED_MODULE_21__.a)(sysHistory,currentModelWrapper,{origin:"".concat(document.location.origin,"/"),scale:timingScale.value,hideSets:hideSets.checked,hideStates:hideStates.checked,showPseudostateInvariants:showPseudostateInvariants.checked,hideLinks:hideLinks.checked});seqFigs.innerHTML=r;var i=!1;new IntersectionObserver(()=>{seqFigs.offsetParent&&!i&&(i=!0,function(){n.apply(this,arguments)}(seqFigs))}).observe(seqFigs);var a=document.getElementById("seqPlantUML");a.href="#clickLinkToUpdateIt",a.onclick=()=>{var t=r;plantUMLType.checked||(seqFigs.querySelectorAll("use,defs>g,script,constraints,[display=none]").forEach(t=>t.remove()),seqFigs.querySelectorAll("[params]").forEach(t=>t.removeAttribute("params")),seqFigs.querySelectorAll("[content-value]").forEach(t=>t.removeAttribute("content-value")),t=(t=seqFigs.innerHTML).replace(/(<a .*)xlink:href="[^"]*"/g,"$1")),a.href=URL.createObjectURL(new Blob([t],{type:"image/svg+xml"})),a.download="diagram.svg"}}else updateOneFig(()=>Object(_History2PlantUMLTiming_js__WEBPACK_IMPORTED_MODULE_7__.a)(sysHistory,!1,currentModelWrapper,{stateOfIn:stateOfIn,callPrefix:callPrefix,hideSets:hideSets.checked}),"seq",()=>Object(_History2PlantUMLTiming_js__WEBPACK_IMPORTED_MODULE_7__.a)(sysHistory,!withAnnotations.checked,currentModelWrapper,{stateOfIn:stateOfIn,callPrefix:callPrefix,hideSets:hideSets.checked,hideLinks:hideLinks.checked})),timingScaleDiv.style="display: inline;"}historyType.onchange=()=>updateFig();var hideClasses=document.getElementById("hideClasses"),hideStateMachines=document.getElementById("hideStateMachines"),stateFigoStyle;function updateFig(){if(testCSSAnimation&&(currentModel.name.endsWith("BoutonLampe")||currentModel.name.endsWith("PubliphoneV6"))){function stateId(t){return"initial"===t.kind?"*start*".concat(currentModel.stateFullName(t.region)):currentModel.stateFullName(t)}function transId(t){return"".concat(stateId(t.source),"->").concat(stateId(t.target)).replace(/([*.>])/g,"\\$1")}function allTransitions(t){return(t.transitions||[]).concat((t.states||[]).flatMap(allTransitions))}function updateState(){if(!editing){var t=Object.entries(engine.configuration.currentState).flatMap(t=>{var[e,n]=t;return n.map(t=>"\n\t\t\t\t\t#".concat(t.name," > rect {\n\t\t\t\t\t\tfill: ").concat(colors.currentStateColor,";\n\t\t\t\t\t}\n\t\t\t\t"))}).join("")+"\n\t\t\t\ta > text {\n\t\t\t\t\tfill: black; text-decoration: none;\n\t\t\t\t}\n\t\t\t"+currentModel.objects.flatMap(allTransitions).filter(t=>engine.isFireable(t)).map(t=>"\n\t\t\t\t#".concat(transId(t)," {\n\t\t\t\t\tstroke: ").concat(colors.fireableTransitionColor," !important;\n\t\t\t\t}\n\t\t\t\t#").concat(transId(t)," + polygon {\n\t\t\t\t\tfill: ").concat(colors.fireableTransitionColor,";\n\t\t\t\t\tstroke: ").concat(colors.fireableTransitionColor," !important;\n\t\t\t\t}\n\t\t\t\t#").concat(transId(t)," + polygon + a > text {\n\t\t\t\t\tfill: #0000EE; text-decoration: underline;\n\t\t\t\t}\n\t\t\t")).join("");stateFigoStyle.textContent=t}}if(stateFigoStyle)updateState();else{var obj=document.getElementById("stateFigo");obj.addEventListener("load",()=>{var t=obj.contentDocument.getElementsByTagName("svg")[0],e=document.createElement("style");t.appendChild(e),stateFigoStyle=e,updateState()})}}updateOneFig(()=>Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.a)(!1,!1,currentModelWrapper,currentEngine,{displayedObjects:displayedObjects,editing:editing,callPrefix:callPrefix,colors:colors,hideLinks:hideLinks.checked}),"state",()=>Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.a)(!withAnnotations.checked,forAnimation.checked,currentModelWrapper,currentEngine,{displayedObjects:displayedObjects,editing:editing,callPrefix:callPrefix,colors:colors})),updateHistoryFig(),document.getElementById("stateFigo").onload=document.getElementById("seqFigo").onload=e=>{if(e.target.contentDocument&&(e.target.contentDocument.onkeydown=onkeydown,changeSVGLinksIntoListeners)){var _loop=function(link){var url=link.href.baseVal;url.startsWith("javascript:")&&(link.onclick=()=>{eval(url.replace(/^javascript:get\([^)]*\)\./,""))},link.href.baseVal="javascript:",link.setAttributeNS(xlinkNS,"title",""))};for(var link of e.target.contentDocument.getElementsByTagName("a"))_loop(link)}}}hideClasses.onchange=updateFig,hideStateMachines.onchange=updateFig,hideMethods.onchange=updateFig,showPorts.onchange=updateFig,showEndNames.onchange=updateFig;var exportLink=document.getElementById("export");function updateExport(t){function e(t,e){return JSON.stringify(t,void 0,e).replace(/%/g,"%25")}function n(){return i=i||Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.a)(currentModel)}function r(){var e=n();if(sysHistory&&((e=Object.assign({},e)).historyCauses=sysHistory.map(t=>t.cause),fireInitialTransitions.checked)){var r=/^transition:/;e.historyCauses=e.historyCauses.filter(e=>!e.match(r)||"initial"!==t.getTransition(e.replace(r,"")).source.kind)}return function(t){var e={interface:{displayedObjects:displayedObjects.map(t=>t.name)},display:{hideClasses:hideClasses.checked,hideMethods:hideMethods.checked,hideStateMachines:hideStateMachines.checked,showPseudostateInvariants:showPseudostateInvariants.checked,showPorts:showPorts.checked},semantics:{fireInitialTransitions:fireInitialTransitions.checked,autoFireAfterChoice:autoFireAfterChoice.checked,autoReceiveDisabled:autoReceiveDisabled.checked,considerGuardsTrue:considerGuardsTrue.checked,checkEvents:checkEvents.checked,keepOneMessagePerTrigger:keepOneMessagePerTrigger.checked,enableEventPools:enableEventPools.checked,matchFirst:matchFirst.checked,symbolicValues:symbolicValues.checked,reactiveSystem:reactiveSystem.checked},defaultToolValues:globalThis.defaultToolValues};t.settings=e}(e),e}var i=null;exportLink.href="#clickLinkToUpdateIt",exportPretty.href="#clickLinkToUpdateIt",exportLink.onclick=()=>{exportLink.href="".concat(document.location.toString().replace(/#.*$/,""),"#").concat(e(n()).replace(/\\/g,"%5C"))},exportPretty.onclick=()=>{exportPretty.download="".concat(currentModel.name,".js"),exportPretty.href="data:text/plain,".concat(encodeURIComponent(e(n(),2)))},histExport.href="#clickLinkToUpdateIt",histExport.onclick=()=>{histExport.href="".concat(document.location.toString().replace(/#.*$/,""),"#").concat(e(r()))},histExportPretty.href="#clickLinkToUpdateIt",histExportPretty.onclick=()=>{histExportPretty.download="".concat(currentModel.name,"-withHistory.js"),histExportPretty.href="data:text/plain,".concat(encodeURIComponent(e(r(),2)))};var a=null;tUMLExport.href="#clickLinkToUpdateIt",tUMLExport.onclick=()=>{tUMLExport.download="".concat(currentModel.name,".tuml"),tUMLExport.href="data:text/plain,".concat(encodeURIComponent(a=a||Object(_Export2tUML_js__WEBPACK_IMPORTED_MODULE_0__.a)(currentModelWrapper)))},window.cExport&&(cExport.href="#clickLinkToUpdateIt",cExport.onclick=()=>{cExport.download="".concat(currentModel.name,".tar.gz");var t=Object(_Export2C_js__WEBPACK_IMPORTED_MODULE_1__.a)(currentModelWrapper);t=pako.gzip(t,{level:9,to:"string"}),t=btoa(t),cExport.href="data:text/plain".concat(";base64",",").concat(encodeURIComponent(t))})}function diff(t,e,n,r){console.log("Expected: ",t,", actual: ",e),console.log("\t",n),console.log("\t",r);var i=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.a)(n,r);console.log("\t",i[0]),console.log("\t",i[1])}function testExportWithoutBuild(t){examples.slice(1).filter(e=>!t||e.name===t).forEach(t=>{var e=t.objects||t.connectorByName?Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.a)(t):Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t),n=JSON.stringify(t),r=JSON.stringify(e),i=n===r;console.log("A: %s",i),i||(diff(t,e,n,r),(t.objects||[]).forEach(t=>{var e=JSON.stringify(t),n=JSON.stringify(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t)),r=e===n;r||(console.log("\tA.".concat(t.name,": %s"),r),console.log("\t\t",e),console.log("\t\t",n),t.operationByName&&console.log("\t\tOperations of ".concat(t.name,": "),JSON.stringify(Object.entries(t.operationByName))===JSON.stringify(Object.entries(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t).operationByName))),t.stateByName&&console.log("\t\tStates of ".concat(t.name,": "),JSON.stringify(Object.entries(t.stateByName))===JSON.stringify(Object.entries(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t).stateByName))),t.transitionByName&&console.log("\t\tTransitions of ".concat(t.name,": "),JSON.stringify(Object.entries(t.transitionByName))===JSON.stringify(Object.entries(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t).transitionByName))))}),t.connectorByName&&console.log("\tConnectors: ",JSON.stringify(Object.entries(t.connectorByName))===JSON.stringify(Object.entries(e.connectorByName))),t.operationByName&&console.log("\tOperations: ",JSON.stringify(Object.entries(t.operationByName))===JSON.stringify(Object.entries(e.operationByName))))})}function testExportAfterBuild(){examples.slice(0).forEach(t=>{function e(t){return t.objects||t.connectorByName?Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.a)(Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t)):Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t))}var n=JSON.stringify(t),r=e(t),i=JSON.stringify(r),a=n===i;a||diff(t,r,n,i);var o=e(t),c=n===JSON.stringify(o);a&&c||console.log("B(".concat(t.name,") : %s, C: %s"),a,c)})}function testExport(){testExportWithoutBuild(),testExportAfterBuild()}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b64encode(t){for(var e="",n=0;n+2<t.length;n+=3){var r=t[n],i=t[n+1],a=t[n+2];e+=b64chars[r>>2],e+=b64chars[63&r<<4|i>>4],e+=b64chars[63&i<<2|a>>6],e+=b64chars[63&a]}switch(t.length%3){case 1:var o=t[t.length-1];e+=b64chars[o>>2],e+=b64chars[63&o<<4],e+="==";break;case 2:o=t[t.length-2];var c=t[t.length-1];e+=b64chars[o>>2],e+=b64chars[63&o<<4|c>>4],e+=b64chars[63&c<<2],e+="="}return e}function Blob2TextEngine(t){Object.assign(this,{isFireable:e=>t.isFireable(e),getFireables:()=>t.getFireables().then(function(){var t=_asyncToGenerator((function*(t){var e=[];for(f of t)e.push(yield f.text());return e}));return function(){return t.apply(this,arguments)}}()),getConfiguration:()=>t.getConfiguration().then(t=>t.arrayBuffer()).then(t=>b64encode(new Uint8Array(t))),setConfiguration(e){console.log(JSON.stringify(e)),fetch(e).then(t=>t.blob()).then(e=>{console.log(e),t.setConfiguration(e)})},fire(e){t.fire(new Blob([e]))},reset(){t.reset()},get modelName(){return t.modelName},get name(){return t.name},parseTransition:e=>t.parseTransition(e),parseConfiguration:e=>t.parseConfiguration(e),convertConfiguration:t=>convertEMI2AnimUML(t),disconnect:()=>t.disconnect()})}function addToolControl(t,e){var n=new _RemoteTool_js__WEBPACK_IMPORTED_MODULE_2__.b("".concat(t,"/control"));n.askCommands().then(t=>{analysisCommands.innerHTML='\n\t\t\tCommands:\n\t\t\t<ul id="toolCommands">\n\t\t\t</ul>\n\t\t',t.forEach(t=>{function r(n){return"".concat(e,".").concat(t[0],".").concat(n)}var i=document.createElement("a");i.innerHTML=t[0],i.href="javascript:",i.onclick=()=>{var i=t.slice(1).map(t=>{var e,n=t.split(":"),i=document.getElementById(r(n[0]));switch(n[1]+""){case"bool":e=i.checked;break;default:e=i.value}return e});analysisTool.setEngine(engine),n.sendCommand(t[0],e,...i)};var a=document.createElement("li");if(a.appendChild(i),1<t.length){var o=document.createElement("span");a.appendChild(o),o.innerHTML+="(".concat(t.slice(1).map(e=>{var n,i=e.split(":");return"".concat(i[0],' = <input size="100" id="').concat(r(i[0]),'" ').concat("bool"===i[1]?'type="checkbox"':"",' value="').concat((null===(n=globalThis.defaultToolValues)||void 0===n?void 0:n["".concat(t[0],".").concat(e)])||"",'"} list="test"><datalist id="test"><option value="a"></option><option value="B"></option></datalist>')}).join(", "),")")}toolCommands.appendChild(a)})}).catch(t=>console.log(t))}var analysisTool,toolOkListener=()=>{var t=toolURL.value;onToolConnect(),(analysisTool=new _RemoteTool_js__WEBPACK_IMPORTED_MODULE_2__.a(t,{onuuid(e){addToolControl(t,e)},onclose(){disconnectFromTool()},onresults(t){t=t.replace(/;counterexample (.*)$/,";<a href=\"javascript:replay('$1')\">show counterexample</a>"),analysisOutput.innerHTML=t,updateFig()},onprogress(t){analysisOutput.innerText=t},ongetconfig:()=>new Promise(t=>{setTimeout(t,toolDelay.value),toolAnimation.checked&&updateFig()})})).setEngine(engine)};function replay(t){t=t.split(","),engine.reset(),t.forEach(t=>{engine.fire(t)}),updateFig()}function disconnectFromTool(){debugAnalysis.checked&&console.log("Disconnecting from analysis tool"),show(connectToToolLI),hide(disconnectFromToolLI),analysisTool.close()}function onToolConnect(){analysisOutput.innerText="Not output from analysis tool yet",analysisCommands.innerText="Not available command yet",hide(connectToToolLI),show(disconnectFromToolLI)}function disconnectFromEMINew(){var t;debugEMI.checked&&console.log("Disconnecting from EMI"),show(connectToEMI),hide(disconnectFromEMILI),"EMI"===(null===(t=engine)||void 0===t?void 0:t.name)&&engine.close(),engine=builtInEngine,updateFig()}toolOk.onclick=toolOkListener,toolURL.onkeypress=t=>{13===t.keyCode&&toolOkListener(t)};var emiOkListenerNew=function(){var t=_asyncToGenerator((function*(t){hide(connectToEMI),emiFireables.innerText="",emiConnectedURL.innerText=emiURL.value.replace(/^[^:]+:\/\/[^\/]+\/emi\//,"").replace(/\.emi\/$/,""),show(disconnectFromEMILI);var e=yield _EMIRemoteEngine_js__WEBPACK_IMPORTED_MODULE_3__.a.connect(emiURL.value,{onclose:disconnectFromEMI});emiAnimation.checked?(engine={isFireable(){throw"unsupported"},getFireables(){var t=this;return _asyncToGenerator((function*(){var n=yield e.getFireables();if(emiAnimation.checked){for(var r of(emiFireables.innerText="",emiFireableBlobs.splice(0,emiFireableBlobs.length),emiFireableBlobsIndex=0,n))yield t.parseTransition(r);emiFireableBlobs.push(...n)}return n}))()},getConfiguration(){var t=this;return _asyncToGenerator((function*(){var n=yield e.getConfiguration();return emiAnimation.checked&&(yield t.parseConfiguration(n)),n}))()},setConfiguration:t=>_asyncToGenerator((function*(){yield e.setConfiguration(t)}))(),fire:t=>_asyncToGenerator((function*(){yield e.fire(t)}))(),reset:()=>_asyncToGenerator((function*(){yield e.reset()}))(),get modelName(){return e.modelName},get name(){return e.name},parseTransition:t=>_asyncToGenerator((function*(){var n=yield e.parseTransition(t);if(emiAnimation.checked){var r=n;if(debugEMI.checked){var i=JSON.parse(r)[0].activeObject.replace(/.*_/,""),a=JSON.parse(r)[0].source,o=JSON.parse(r)[0].target,c=JSON.parse(r)[0].transitions[0];a===o&&(c="".concat(a,".__internal__").concat(c,"__")),""===c&&(c="".concat(a,"2").concat(o,"_<idx>")),c="".concat(i,".").concat(c),console.log("%s => %o",c,getTransition(c))}var s=document.createElement("a");s.innerText=r,s.href="javascript:".concat(callPrefix,"emiFire(").concat(emiFireableBlobsIndex,")"),emiFireableBlobsIndex++;var l=document.createElement("li");l.appendChild(s),emiFireables.appendChild(l)}return n}))(),parseConfiguration:()=>_asyncToGenerator((function*(){var t=yield e.parseConfiguration(n);if(emiAnimation.checked){var n=JSON.parse(t);debugEMI.checked&&console.log(n),currentModel.objects.filter(isActive).forEach(t=>{if(n.children){if(o=n.children.find(e=>e.name.endsWith("_".concat(t.name)))){var e=(l=o,u="cs",l.children.find(t=>t.name===u)).value,r="".concat(t.name,".").concat(e);configuration.currentState[t.name]=fullState(getState(r))}else console.log("Could not find object %s in EMI configuation",t.name)}else if(n.currentState){var i=n.currentState[t.name];i?configuration.currentState[t.name]=fullState(getState(i[0])):console.log("Could not find object %s in EMI configuation",t.name)}else{var a,o;if(o=null===(a=Object.entries(n).find(t=>{var[e,n]=t;return e.endsWith("_".concat(n.name))}))||void 0===a?void 0:a.object){var c=o.cs,s="".concat(t.name,".").concat(c);configuration.currentState[t.name]=fullState(getState(s))}else console.log("Could not find object %s in EMI configuation",t.name)}var l,u}),updateFig()}return t}))(),showConfiguration:t=>_asyncToGenerator((function*(){return yield e.showConfiguration(t)}))(),showTransition:t=>_asyncToGenerator((function*(){return yield e.showTransition(t)}))(),close(){e.close()}},yield engine.getConfiguration(),yield engine.getFireables()):engine=e,"function"==typeof t&&t(engine)}));return function(){return t.apply(this,arguments)}}(),emiFireableBlobs=[],emiFireableBlobsIndex=0,emiWS,emiState;function emiFireNew(){return _emiFireNew.apply(this,arguments)}function _emiFireNew(){return(_emiFireNew=_asyncToGenerator((function*(t){var e=emiFireableBlobs[t];yield engine.fire(e),yield engine.getConfiguration(),yield engine.getFireables()}))).apply(this,arguments)}function emiSend(t){debugEMI.checked&&console.log("Sending to EMI: ",t),emiWS.send(t)}var emiOkListener=emiOkListenerNew,disconnectFromEMI=disconnectFromEMINew,emiFire=emiFireNew;function stopExploration(){var t;null===(t=worker)||void 0===t||t.postMessage({action:"stop"})}emiOk.onclick=emiOkListener,emiURL.onkeypress=t=>{13===t.keyCode&&emiOkListener(t)};var worker,debugWorker=!1;function exploreStateSpace(){function t(t){worker.postMessage({action:"return",value:t})}(worker=worker||new Worker("AnalysisWorker.min.js",{type:"module"})).onmessage=e=>{switch(debugWorker&&console.log("Message from worker: ",e),e.data.action+""){case"reset":engine.reset();break;case"getConfiguration":engine.getConfiguration().then(t);break;case"parseConfiguration":engine.parseConfiguration(e.data.config).then(t);break;case"setConfiguration":var n=engine.setConfiguration(e.data.config);n&&n.then?n.then(t):t();break;case"fire":engine.fire(e.data.trans).then(t);break;case"getFireables":engine.getFireables().then(t);break;case"results":explorationsOutput.innerText="RESULTS: ".concat(e.data.value);break;case"stopped":explorationsOutput.innerText="STOPPED: ".concat(e.data.value);break;case"progress":explorationsOutput.innerText="PROGRESS: ".concat(e.data.value);break;default:throw"Unsupported action from worker: "+e.data.action}},worker.postMessage({action:"exploreStateSpace"})}var currentEngine={getSlots:t=>builtInEngine.configuration.objectState[t.name],isFireable:t=>builtInEngine.isFireable(t),getTransURI:(t,e,n)=>"javascript:".concat(callPrefix).concat(t,"('").concat(encodeURIComponent(currentModel.transFullName(e)),"'").concat(n?",'".concat(n,"'"):"",")"),getFireURI(t){return this.getTransURI("fire",t)},isCurrent:t=>builtInEngine.isCurrentState(t),isActivable:t=>builtInEngine.isActivable(t),eventMatched:t=>builtInEngine.eventMatched(t),getFireable:(t,e)=>builtInEngine.getFireable(t,e),findMessage:(t,e,n)=>builtInEngine.findMessage(t,e,n)},sysHistoryEngine={isFireable(t){isFireable(t)},getFireables:()=>Promise.resolve(builtInEngine.getFireables().map(transFullName)),getConfiguration(){var t=serializeConfig(configuration);return Promise.resolve(t)},setConfiguration(t){if(t!==serializeConfig(configuration)){var e=this.hist.indexOf(t);0>e&&console.log("Cannot find this configuration in sysHistory: ",t),backToInternal(e);var n=serializeConfig(configuration);console.assert(t===n,"After backTo(",e,"), should be in ",JSON.parse(t)," but is in ",JSON.parse(n),"\n\texpected:\t",t,"\n\tactual:\t\t",n),this.hist.splice(e,this.hist.length),console.assert(this.hist.length==sysHistory.length)}},fire(t){this.hist.push(serializeConfig(configuration));var e=getTransition(t);for(fireInternal(e);this.autoFireAfterChoice&&"choice"===e.target.kind;){var n=getTransObject(e),r=getFireable(n);if(1!=r.length&&(r=r.filter(t=>"else"!==t.guard)),1!=r.length)throw"There should be exactly one fireable transition";e=r[0],this.hist.push(serializeConfig(configuration)),fireInternal(e)}},reset(){builtInEngine.reset(),this.hist=[],sysHistory=[]},get modelName(){return currentModel.name},get name(){return"AnimUML-sysHistory"},parseTransition:t=>_asyncToGenerator((function*(){return t}))(),parseConfiguration:t=>_asyncToGenerator((function*(){return t}))(),showTransition:t=>_asyncToGenerator((function*(){var e=getTransition(t);return{object:getTransObject(e).name,source:e.source.name,target:e.target.name}}))(),showConfiguration:t=>_asyncToGenerator((function*(){return JSON.parse(t)}))()};function testConversions(){examples.slice(0).forEach(t=>{load(t),Object(_Export2tUML_js__WEBPACK_IMPORTED_MODULE_0__.a)(currentModelWrapper),Object(_Export2C_js__WEBPACK_IMPORTED_MODULE_1__.a)(currentModelWrapper),currentModel.objects.filter(t=>currentModel.isActive(t)).map(t=>Object(_TransformStateMachine2Explicit_js__WEBPACK_IMPORTED_MODULE_6__.a)(t,currentModelWrapper))})}function testComparedProducerConsumer(){return _testComparedProducerConsumer.apply(this,arguments)}function _testComparedProducerConsumer(){return(_testComparedProducerConsumer=_asyncToGenerator((function*(){yield testComparedExecution("UML2AnimUML_ProducerConsumer",()=>{getObject("Mainintermediate").name="intermediate"})}))).apply(this,arguments)}function testComparedAliceBob2(){return _testComparedAliceBob.apply(this,arguments)}function _testComparedAliceBob(){return(_testComparedAliceBob=_asyncToGenerator((function*(){try{yield testComparedExecution("UML2AnimUML_AliceBob2",void 0,!1)}finally{}}))).apply(this,arguments)}function emiConnect(){return _emiConnect.apply(this,arguments)}function _emiConnect(){return(_emiConnect=_asyncToGenerator((function*(){if(engine!=builtInEngine){var t=/:[0-9]+\//;engine.modelName.replace(t,"")!==emiURL.value.replace(t,"")&&disconnectFromEMI()}engine==builtInEngine&&(yield new Promise(t=>emiOkListener(t)))}))).apply(this,arguments)}function testComparedExecution(){return _testComparedExecution.apply(this,arguments)}function _testComparedExecution(){return(_testComparedExecution=_asyncToGenerator((function*(t,e){var n,r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],i=3<arguments.length?arguments[3]:void 0,a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];console.log("Comparing AnimUML vs EMI execution for: ",t),switchExample(t),checkEvents.checked=!0,considerGuardsTrue.checked=!1,fireInitialTransitions.checked=!0,yield emiConnect(),e&&e(),i&&(n=builtInEngine.reset,builtInEngine.reset=()=>{n.bind(builtInEngine)(),i()});var o=builtInEngine;try{var c=r;console.time("explore"),yield(yield __webpack_require__(31)("./DiffExplorer.js?nocache=".concat(Math.random()))).diffExplore(o,engine,Object(_DiffExplorer_js__WEBPACK_IMPORTED_MODULE_12__.a)({info(t){var{type:e,args:n}=t;return"Reached config "!==n[0]||0!=n[1]%100||c?!!c:(console.timeLog("explore"),!0)},counts:()=>!0}),a),console.timeEnd("explore")}finally{n&&(builtInEngine.reset=n)}}))).apply(this,arguments)}function testComparedLevelCrossing(){return _testComparedLevelCrossing.apply(this,arguments)}function _testComparedLevelCrossing(){return(_testComparedLevelCrossing=_asyncToGenerator((function*(){yield testComparedExecution("UML2AnimUML_LevelCrossing",void 0,!1,()=>{builtInEngine.configuration.objectState.tcEntrance0.__EMI__id=1,builtInEngine.configuration.objectState.tcEntrance1.__EMI__id=1,builtInEngine.configuration.objectState.tcExit.__EMI__id=2})}))).apply(this,arguments)}function testComparedExecutions(){return _testComparedExecutions.apply(this,arguments)}function _testComparedExecutions(){return(_testComparedExecutions=_asyncToGenerator((function*(){yield testComparedExecution("UML2AnimUML_AliceBob1"),yield testComparedAliceBob2(),yield testComparedLevelCrossing(),yield testComparedCruiseControlv4()}))).apply(this,arguments)}function prepareCruiseControlv4(){autoFireAfterChoice.checked=!0,sysHistoryEngine.autoFireAfterChoice=!0,checkEvents.checked=!0,considerGuardsTrue.checked=!1,fireInitialTransitions.checked=!0,enableEventPools.checked=!0,matchFirst.checked=!0,symbolicValues.checked=!1,reactiveSystem.checked=!0,currentModel.getObject("env_engine").transitionByName.Init.effect="SET(this, speed, 1)",currentModel.objects.forEach(t=>function t(e){Object.values(e.internalTransitions||{}).forEach(t=>t.isInternal=!1),e.transitions.forEach(t=>t.isInternal=!1),e.states.forEach(e=>t(e))}(t))}function testComparedCruiseControlv4(){return _testComparedCruiseControlv.apply(this,arguments)}function _testComparedCruiseControlv(){return(_testComparedCruiseControlv=_asyncToGenerator((function*(){var t=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];yield testComparedExecution("UML2AnimUML_CruiseControlv4",prepareCruiseControlv4,t)}))).apply(this,arguments)}function testComparedLevelCrossingManual(){return _testComparedLevelCrossingManual.apply(this,arguments)}function _testComparedLevelCrossingManual(){return(_testComparedLevelCrossingManual=_asyncToGenerator((function*(){yield testComparedExecution("LevelCrossing",()=>{builtInEngine.nbMessagesToKeepInEther=1},!1,()=>{},!1)}))).apply(this,arguments)}function testFailingComparedExecutions(){return _testFailingComparedExecutions.apply(this,arguments)}function _testFailingComparedExecutions(){return(_testFailingComparedExecutions=_asyncToGenerator((function*(){yield testComparedLevelCrossingManual(),yield testComparedProducerConsumer()}))).apply(this,arguments)}function sleep(t){return new Promise(e=>setTimeout(e,t))}function testPlantUML(){return _testPlantUML.apply(this,arguments)}function _testPlantUML(){return(_testPlantUML=_asyncToGenerator((function*(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;for(var e of examples)console.log("Switching to example ",e),switchExample(e.name),yield sleep(t),edit(),yield sleep(t),edit()}))).apply(this,arguments)}function addExample(t){addOption(exampleSelect,t.name)}function loadFirstValidExample(){for(var t of examples)try{load(Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t));break}catch(e){throw console.log("Could not load model %s: %s",t.name,e),e}}function exportDynamicSymbols(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=function(e){Object.defineProperty(globalThis,e,{get:function(){return t(e)}})};for(var a of n)i(a)}function doExportSymbols(){Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.c)(symbol=>eval(symbol),"loadSample","addExample","toggle","edit","disconnectFromEMI","disconnectFromTool","backTo","fire","emiFire","callOperation","switchToObject","setSender","replay","exploreStateSpace","stopExploration","show","hide","updateExport","updateFig","ALL_OBJECTS","updateObjects","switchExample","load","emiConnect","testComparedAliceBob2","testComparedCruiseControlv4","prepareCruiseControlv4","testExport","testExecutions","testComparedExecution","testComparedExecutions","sysHistoryEngine","testConversions","testPlantUML","testFailingComparedExecutions"),exportDynamicSymbols(symbol=>eval(symbol),"analysisTool"),window.reset=()=>builtInEngine.reset(),Object.defineProperty(window,"sysHistory",{get:()=>builtInEngine.sysHistory})}start(),onkeydown=t=>{var e,n,r,i;switch(t.key+""){case"ArrowLeft":case"ArrowUp":null===(e=window.parent)||void 0===e||null===(n=e.slideshow)||void 0===n||n.gotoPreviousSlide();break;case"ArrowRight":case"ArrowDown":null===(r=window.parent)||void 0===r||null===(i=r.slideshow)||void 0===i||i.gotoNextSlide();break;case"r":reset(),updateFig();break;case"s":setHistoryType("TCSVG sequence"),updateFig();break;case"p":setHistoryType("sequence"),updateFig();break;case"t":setHistoryType("timing"),updateFig()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _Utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);function asyncGeneratorStep(t,e,n,r,i,a,o){try{var c=t[a](o),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,i)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){function a(t){asyncGeneratorStep(c,r,i,a,o,"next",t)}function o(t){asyncGeneratorStep(c,r,i,a,o,"throw",t)}var c=t.apply(e,n);a(void 0)}))}}var testCases=[{override:{disableEther:!0,"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1,"enableEventPools.checked":!1},load:"ExemplesExplicites",expected:new Expected(7680,47360,0),variants:[{long:!0},{override:{disableEther:!1},expected:new Expected(27720,167100,0),long:!0},{override:{"checkEvents.checked":!0},expected:new Expected(432,1620,2)},{keepOneObject:"TraductionEntryExitDo",expected:new Expected(4,5,0)},{keepOneObject:"After",expected:new Expected(4,5,1)},{keepOneObject:"When",expected:new Expected(4,3,2)},{keepOneObject:"Choice",expected:new Expected(4,3,1)},{keepOneObject:"CompositeWithoutHistory",expected:new Expected(5,5,1)},{keepOneObject:"CompositeWithHistory",expected:new Expected(6,7,0)}]},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV1",expected:new Expected(13,13,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV2",expected:new Expected(21,35,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV3",expected:new Expected(27,41,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV4",expected:new Expected(51,109,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV5",expected:new Expected(19,29,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV6",expected:new Expected(22,32,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1,"symbolicValues.checked":!1},load:"ThermostatV1",expected:new Expected(499,1541,0)},{override:{"builtInEngine.autoFireAfterChoice":!0,"sysHistoryEngine.autoFireAfterChoice":!0,"checkEvents.checked":!0,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!0,"enableEventPools.checked":!0,"matchFirst.checked":!1,"symbolicValues.checked":!1},load:"UML2AnimUML_AliceBob1",expected:new Expected(4,8,0),runWithEMI:!0},{override:{"builtInEngine.autoFireAfterChoice":!0,"sysHistoryEngine.autoFireAfterChoice":!0,"checkEvents.checked":!0,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!0,"enableEventPools.checked":!0,"matchFirst.checked":!1,"symbolicValues.checked":!1},load:"UML2AnimUML_AliceBob2",expected:new Expected(8,12,1),runWithEMI:!0},{long:!0,override:{"builtInEngine.autoFireAfterChoice":!0,"sysHistoryEngine.autoFireAfterChoice":!0,"checkEvents.checked":!0,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!0,"enableEventPools.checked":!0,"matchFirst.checked":!0,"symbolicValues.checked":!1,"reactiveSystem.checked":!0},load:"UML2AnimUML_CruiseControlv4",setup(t){t.getObject("env_engine").transitionByName.Init.effect="SET(this, speed, 1)",t.objects.forEach(t=>function t(e){Object.values(e.internalTransitions||{}).forEach(t=>t.isInternal=!1),e.transitions.forEach(t=>t.isInternal=!1),e.states.forEach(e=>t(e))}(t))},expected:new Expected(6704,11324,0),runWithEMI:!0}];function Expected(t,e,n){this.nbConfigurations=t,this.nbTransitions=e,this.nbDeadlocks=n,this.equals=t=>t.nbConfigurations==this.nbConfigurations&&t.nbTransitions==this.nbTransitions&&t.nbDeadlocks==this.nbDeadlocks}function logStatus(t,e,n){console.log(t," configurations; ",e," transitions; ",n," deadlocks")}function testExecution(){return _testExecution.apply(this,arguments)}function _testExecution(){return(_testExecution=_asyncToGenerator((function*(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:engine,e=1<arguments.length?arguments[1]:void 0;console.time("explore");var n=yield(yield __webpack_require__(27)("./Explorer.js?nocache=".concat(Math.random()))).explore(t,(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];logStatus.apply(null,e)}),e);return console.timeEnd("explore"),n}))).apply(this,arguments)}function testExecutions(){return _testExecutions.apply(this,arguments)}function _testExecutions(){return(_testExecutions=_asyncToGenerator((function*(){function t(t){console.assert.apply(console,arguments),t||c++}function e(t,e){Object.entries(t).forEach(t=>{var[n,r]=t,i=window,a=n.split(".");a.slice(0,-1).forEach(t=>i=i[t]);var o=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.h)(a);e(u,n,i,o,r)})}var n=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],r=1<arguments.length?arguments[1]:void 0,i=currentModel.name,a=keepOneMessagePerTrigger.checked;keepOneMessagePerTrigger.checked=!0;var o=0,c=0,s=function*(i){var a=function*(a){function c(){return s.apply(this,arguments)}function s(){return(s=_asyncToGenerator((function*(e){console.log("Running with engine: ",e.name);var n=yield testExecution(e);t(p.equals(n),"".concat(i.load).concat(a.keepOneObject?".".concat(a.keepOneObject):"",":"),"expected: ",p,", actual: ",n)}))).apply(this,arguments)}return r&&!r(i,a)?(console.log("Skipping a test according to filter"),"continue"):(null==a.long?i.long:a.long)&&!n?(console.log("Skipping a long test. If you want to run all tests, pass true as first argument to testExecutions"),"continue"):(console.log("Loading: ",i.load),switchExample(i.load),o++,i.setup&&i.setup(currentModel),a.keepOneObject&&load(currentModel.getObject(a.keepOneObject)),a.setup&&a.setup(i),u={},e(d=Object.assign(Object.assign({},i.override),a.override),(t,e,n,r,i)=>{t[e]=n[r],n[r]=i}),p=a.expected||i.expected,console.log("Expecting: ",p.nbConfigurations," configurations; ",p.nbTransitions," transitions; ",p.nbDeadlocks," deadlocks"),yield c(builtInEngine),(i.runWithEMI&&null==a.runWithEMI||a.runWithEMI)&&(yield emiConnect(),yield c(engine)),e(d,(t,e,n,r)=>{n[r]=t[e]}),a.tearDown&&a.tearDown(),void(i.tearDown&&i.tearDown()))};for(var c of i.variants||[{}])yield*a(c)};for(var l of testCases){var u,d,p;yield*s(l)}console.log("Ran ",o," tests with ",c," fails."),keepOneMessagePerTrigger.checked=a,switchExample(i)}))).apply(this,arguments)}Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.c)(symbol=>eval(symbol),"testExecution","testExecutions")},function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=27},function(t,e,n){"use strict";n(16)},function(t,e,n){"use strict";n(0)},function(t,e,n){"use strict"},function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=31}]);
!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e,n){"use strict";function r(t,e){return t[0]<e[0]?-1:1}function o(t){return Array.from(new Set(t))}function a(t){return t[t.length-1]}function i(t){return t&&t.replace(/\\/,"\\\\").replace(/\n/g,"\\n    ").replace(/{/g,"<U+007B>")}function c(t,e){return t.map((t,n)=>[t,e[n]])}function s(t,e){var n,r,o=0;return(n=t.split(""),r=e.split(""),c(n,r).map((t,e)=>{var[n,r]=t;return((t,e)=>t===e)(n,r)})).every(t=>t&&++o),[t.slice(o),e.slice(o)]}function l(t,e){t&&Object.entries(t).forEach(t=>{var[n,r]=t;return e(n,r)})}function u(t){return t&&t.length&&0<t.length}function d(t,e){var n=t.indexOf(e);0<=n&&t.splice(n,1)}function p(t){var e;return null===(e=t.selectedOptions[0])||void 0===e?void 0:e.innerText}function f(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var o of n){var a=t(o);globalThis[o]=a}}n.d(e,"b",(function(){return r})),n.d(e,"j",(function(){return o})),n.d(e,"h",(function(){return a})),n.d(e,"g",(function(){return i})),n.d(e,"k",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"c",(function(){return f}))},function(t,e,n){"use strict";function r(t){var e=t.replace(/ /g,"_SPACE_");return 1<t.length&&(e=e.replace(/\[/g,"_LSQUARE_").replace(/]/g,"_RSQUARE_")),e}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){function e(t){return t.replace(new RegExp("^".concat(c),"mg"),"")}function n(t){return t.replace(/\n/g,"\n".concat(l))}for(var r=arguments.length,o=Array(1<r?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];var i=t[0].replace(/\s*\n/,""),c=i.replace(/^(\s*)[\s\S]*$/,"$1"),s=e(i),l="";return o.forEach((r,a)=>{var i=e(t[a+1]);""===(r=Array.isArray(r)?r.map(n).join("\n".concat(l)):r?n(r):"")?s.match(/\n\s*$/)&&i.match(/^\s*\n/)&&(s=s.replace(/\n\s*$/,"")):s+=r,a==o.length-1&&(i=i.trimEnd()),s+=i,l=i.replace(/^[\s\S]*\n/,"")}),s}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var r=n(0);function o(t){var e=Object.values(t.connectorByName||{}).flatMap(t=>t.ends.map(t=>t.name||t)),n=t.objects?t.objects.map(i).slice(0).filter(t=>!(JSON.stringify(t).match(/^{"name":"[^"]*"}$/)&&e.includes(t.name))):void 0,o={name:t.name,objects:Object(r.f)(n)?n:void 0};return Object.entries(t.connectorByName||{}).forEach(t=>{var[e,n]=t;o.connectorByName=o.connectorByName||{};var a={ends:n.ends.map(t=>t.name||t),endNames:n.endNames,incomingTag:n.incomingTag};if(n.possibleMessages){var i=Object(r.f)(n.possibleMessages.forward),c=Object(r.f)(n.possibleMessages.reverse);(i||c)&&(a.possibleMessages={},i&&(a.possibleMessages.forward=n.possibleMessages.forward.slice()),c&&(a.possibleMessages.reverse=n.possibleMessages.reverse.slice()))}o.connectorByName[e]=a}),t.settings&&(o.settings=t.settings),o}function a(t,e,n){n[e]&&(t[e]=n[e])}function i(t){var e=function(t){var e={name:t.name};return a(e,"isActor",t),Object.assign(e,function t(e){function n(){return r.stateByName=r.stateByName||{}}var r={},o={};return Object.entries(e.stateByName||{}).forEach(e=>{var[r,i]=e,c={};a(c,"entry",i),a(c,"exit",i),a(c,"doActivity",i),a(c,"type",i),a(c,"kind",i),Object.assign(c,t(i)),Object.entries(i.internalTransitions||{}).forEach(t=>{var[e,n]=t;(c.internalTransitions=c.internalTransitions||{})[e]={trigger:n.trigger,ports:n.ports,guard:n.guard,effect:n.effect}}),0<Object.entries(c).length?n()[r]=c:o[r]=c}),Object.entries(e.transitionByName||{}).filter(t=>{var[e,n]=t;return!n.isInternal}).forEach(t=>{function e(t){if("string"==typeof t)return t;for(var e=t.name,n=t.region;n!==a.region;)e="".concat(n.name,".").concat(e),n=n.region;return e}var[n,a]=t,i=e(a.source),c=e(a.target);delete o[i],delete o[c],(r.transitionByName=r.transitionByName||{})[n]={source:i,target:c,trigger:a.trigger,ports:a.ports,guard:a.guard,effect:a.effect}}),Object.keys(o).forEach(t=>{n()[t]={}}),r}(t))}(t);return a(e,"type",t),Object(r.d)(t.operationByName,(t,n)=>{e.operationByName=e.operationByName||{};var r={};n.method&&(r.method=n.method),n.parameters&&(r.parameters=n.parameters),n.private&&(r.private=n.private),e.operationByName[t]=r}),e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return t.objects||t.connectorByName?(t.objects||(t.objects=[]),t.objects.forEach(t=>{o(t),t.operations=[],Object.entries(t.operationByName||{}).forEach(e=>{var[n,r]=e;r.name=n,r.class=t,t.operations=t.operations||[],t.operations.push(r)})}),t.connectors=[],Object(r.d)(t.connectorByName,(e,n)=>{t.connectors=t.connectors||[],t.connectors.push(n),n.name=e,n.ends=n.ends.map(e=>{var n=e;return"string"==typeof e&&(!(n=t.objects.find(t=>t.name==e))&&(n={name:e},t.objects.push(n))),n})}),t):(t.states=[],t.transitions=[],Object.keys(t.stateByName||{}).forEach(e=>{function n(e){if("string"==typeof e){var n=t.transitionByName[e];return n||(n={},t.transitionByName[e]=n),n}return e}var r=t.stateByName[e];r.region=t,o(r),r.name=e,r.incoming=(r.incoming||[]).map(n),r.incoming.forEach(t=>{t.target=r}),r.outgoing=(r.outgoing||[]).map(n),r.outgoing.forEach(t=>{t.source=r}),t.states.push(r),Object.entries(r.internalTransitions||{}).forEach(t=>{var[e,n]=t;e="__internal__".concat(e,"__"),n.region=r,n.isInternal=!0,n.source=r,n.target=r,n.name=e,r.transitionByName=r.transitionByName||{},r.transitionByName[e]=n})}),Object.keys(t.transitionByName||{}).forEach(e=>{function n(n,o){var a=r[n];if(!a){var i=/^(.+)2(.+?)(_[0-9]+)?$/;a="source"===n?e.replace(i,"$1"):e.replace(i,"$2")}if("string"==typeof a){var c=function(e){var n=e.split("."),r=void 0;return n.forEach(e=>{r=(r||t).stateByName[e]}),r}(a);c||(c={name:a,states:[],transitions:[],region:t},t.stateByName[a]=c,t.states.push(c)),r[n]=c,c[o]||(c[o]=[]),c[o].push(r)}}var r=t.transitionByName[e];r.isInternal||(r.name=e,t.transitions.push(r),r.region=t,n("source","outgoing"),n("target","incoming"))}),t)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Editor})),__webpack_require__.d(__webpack_exports__,"b",(function(){return initEditor})),__webpack_require__.d(__webpack_exports__,"c",(function(){return updateStates}));var _Utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),model,contextStates,sourceStates,targetStates,pseudostateSelect,textInput,inputBlock;class Editor{constructor(){}setModel(t){model=t}}function initEditor(t){model=t,editBlock.innerHTML='\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li id="addToState">add one of the following in <select id="contextState"></select>:\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li>a <a href="javascript:addState()">state</a></li>\n\t\t\t\t\t\t\t\t<li>a\n\t\t\t\t\t\t\t\t\t<a href="javascript:addPseudostate()">pseudostate</a>(<select id="pseudostate">\n\t\t\t\t\t\t\t\t\t\t<option>initial</option>\n\t\t\t\t\t\t\x3c!--\tTODO\n\t\t\t\t\t\t\t\t\t\t<option>deepHistory</option>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t\t\t\t\t<option>shallowHistory</option>\n\t\t\t\t\t\t\t\t\t\t<option>join</option>\n\t\t\t\t\t\t\t\t\t\t<option>fork</option>\n\t\t\t\t\t\t\x3c!--\tTODO\n\t\t\t\t\t\t\t\t\t\t<option>junction</option>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t\t\t\t\t<option>choice</option>\n\t\t\t\t\t\t\t\t\t\t<option>entrypoint</option>\n\t\t\t\t\t\t\t\t\t\t<option>exitpoint</option>\n\t\t\t\t\t\t\t\t\t\t<option>terminate</option>\n\t\t\t\t\t\t\t\t\t</select>)</li>\n\t\t\t\t\t\t\t\t<li id="internalTransition">an <a href="javascript:addInternalTransition()">internal transition</a></li>\n\t\t\t\t\t\t\t\t<li id="entryOrExit">an <a href="javascript:addEntry()">entry</a> or <a href="javascript:addExit()">exit</a></li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li id="addATransition">add a\n\t\t\t\t\t\t\t<a top href="javascript:addTransition()">transition</a>(<select id="sourceState"></select>-><select id="targetState"></select>)\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>add a\n\t\t\t\t\t\t\t<a top href="javascript:addObject(false)">passive</a>\n\t\t\t\t\t\t\tor an\n\t\t\t\t\t\t\t<a top href="javascript:addObject(true)">active</a>\n\t\t\t\t\t\t\tobject\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li id="inputBlock" style="display: none">edit the clicked element:\n\t\t\t\t\t\t\t<input id="textInput"/>\n\t\t\t\t\t\t\t<button id="inputOk">Ok</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t',document.getElementById("inputOk").onclick=okListener,(textInput=document.getElementById("textInput")).onkeypress=t=>{13===t.keyCode&&okListener(t)},(contextStates=document.getElementById("contextState")).onchange=()=>{var t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates);t&&[internalTransition,entryOrExit].forEach(e=>{2>t.split(".").length?hide(e):show(e)})},(sourceStates=document.getElementById("sourceState")).onchange=()=>{var t,e=null===(t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(sourceStates))||void 0===t?void 0:t.split(".")[0];Array.prototype.forEach.call(targetStates.options,t=>{t.disabled=!t.innerText.startsWith(e)}),targetStates.selectedIndex=Array.prototype.findIndex.call(targetStates.options,t=>!t.disabled)},targetStates=document.getElementById("targetState"),pseudostateSelect=document.getElementById("pseudostate"),inputBlock=document.getElementById("inputBlock")}function updateStates(){function t(t,e){var n,r=null===(n=Array.prototype.map.call(t.options,(t,e)=>({i:e,e:t})).find(t=>t.e.innerText==e))||void 0===n?void 0:n.i;t.selectedIndex=r}var e=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates),n=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(sourceStates),r=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(targetStates);contextStates.innerHTML="",sourceStates.innerHTML="",targetStates.innerHTML="";var o=displayedObjects.filter(model.isActive);o.forEach(t=>{addOption(contextStates,t.name),function t(e){(e.states||[]).forEach(e=>{"terminate"!=e.kind&&addOption(sourceStates,model.stateFullName(e)),"initial"!=e.kind&&addOption(targetStates,model.stateFullName(e)),e.kind||addOption(contextStates,model.stateFullName(e)),t(e)})}(t)}),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.f)(o)?show(addToState):hide(addToState),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.f)(targetStates)?show(addATransition):hide(addATransition),t(contextStates,e),t(sourceStates,n),t(targetStates,r),contextStates.onchange(),sourceStates.onchange(),updateExport(model)}var editedElement=void 0,editedProperty=void 0,update=void 0,okListener=()=>{editedElement[editedProperty]=textInput.value.replace(/\\n/g,"\n"),update&&update(textInput.value),update=void 0,inputBlock.style="display: none",updateFig(),updateStates()};function editTransition(t,e){var n=(t=model.getTransition(t))[e]||"";textInput.value=n.replace(/\\/,"\\\\").replace(/\n/g,"\\n"),editedElement=t,editedProperty=e,update=void 0,showInputBlock()}function showInputBlock(){inputBlock.style="",textInput.focus()}function editProperty(t,e){var n=model.getState(t);editedElement=n,editedProperty=e,textInput.value=n[e]||"",update=void 0,showInputBlock()}function addEntry(){editProperty(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates),"entry")}function addExit(){editProperty(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates),"exit")}function editState(t){var e=model.getState(t);textInput.value=e.name,editedElement=e,editedProperty="name";var n=e.name;update=function(t){delete e.region.stateByName[n],e.region.stateByName[t]=e},showInputBlock()}function getOperation(t){var e=t.split("."),n=model.getObject(e[0]);t=e[1];return n.operationByName[t]}function editOperation(t){var e=getOperation(t);textInput.value=e.name,editedElement=e,editedProperty="name";var n=e.name;update=function(t){delete e.class.operationByName[n],e.class.operationByName[t]=e},showInputBlock()}function editMethod(t){var e=getOperation(t);textInput.value=e.method||"",editedElement=e,editedProperty="method",update=void 0,showInputBlock()}function editObject(t){var e=model.getObject(t);textInput.value=e.name,editedElement=e,editedProperty="name";var n=e.name;update=t=>{function e(e){e.currentState[t]=e.currentState[n],delete e.currentState[n]}e(configuration),sysHistory.forEach(r=>{e(r.configuration),r.messages.forEach(e=>{e.source==n&&(e.source=t),e.target==n&&(e.target=t)})}),updateObjects()},showInputBlock()}function addVertex(t){var e,n=model.getState(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates));for(n.stateByName=n.stateByName||{};n.stateByName[e="S".concat(stateCounter++)];);t.name=e,t.region=n,n.states=n.states||[],n.states.push(t),n.stateByName[t.name]=t}var stateCounter=0;function addState(){addVertex({incoming:[],outgoing:[]}),updateFig(),updateStates()}function addPseudostate(){addVertex({type:"Pseudostate",kind:Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(pseudostateSelect),incoming:[],outgoing:[]}),updateStates(),updateFig()}var objectCounter=1;function addObject(t){for(var e;model.getObject(e="NewObject".concat(objectCounter++)););var n=t?Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_1__.a)({name:e,stateByName:{init:{type:"Pseudostate",kind:"initial"}},transitionByName:{}}):{name:e};model.objects.push(n),t&&model.setInitialState(n),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(objectSelect)==ALL_OBJECTS?(displayedObjects.push(n),updateFig()):switchToObject(e),updateObjects(),updateStates()}function makePassive(t){var e=model.getObject(t);delete e.stateByName,delete e.transitionByName,delete e.states,delete e.transitions,delete builtInEngine.configuration.currentState[e.name],updateStates(),updateFig()}function makeActive(t){var e=model.getObject(t);e.stateByName={init:{name:"init",type:"Pseudostate",kind:"initial",region:e,outgoing:[]}},e.transitionByName={},e.states=[e.stateByName.init],e.transitions=[],builtInEngine.configuration.currentState[e.name]=[model.getInitial(e)],updateStates(),updateFig()}function newName(t,e){for(var n,r=1;!e(n=t+r);)r++;return n}function addOperation(t){var e=model.getObject(t);e.operations=e.operations||[],e.operationByName=e.operationByName||{};var n={name:newName("newOperation",t=>!e.operations.find(e=>e.name==t)),class:e};e.operations.push(n),e.operationByName[n.name]=n,updateFig(),updateExport(model)}function removeObject(t){if(1===model.objects.length)alert("Cannot remove an object when there is only one left in a model.");else{var e=model.getObject(t);Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(model.objects,e),model.connectors.filter(t=>t.ends.includes(e)).forEach(t=>{Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(model.connectors,t),delete model.connectorByName[t.name]}),displayedObjects.includes(e)&&(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(displayedObjects,e),0==displayedObjects.length&&(defaultsToAllObjects?displayedObjects=model.objects.slice():displayedObjects=[model.objects[0]]),updateFig()),updateObjects(),updateStates(),updateExport(model)}}function removeTransition(t){removeTransitionInternal(t),updateFig(),updateExport(model)}function removeTransitionInternal(t){Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(t.region.transitions,t),delete t.region.transitionByName[t.name],Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(t.source.outgoing,t),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(t.target.incoming,t)}function removeState(t){var e=model.getState(t);(e.incoming||[]).slice(0).forEach(t=>{removeTransitionInternal(t)}),(e.outgoing||[]).slice(0).forEach(t=>{removeTransitionInternal(t)}),Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(e.region.states,e),delete e.region.stateByName[e.name],updateFig(),updateStates()}function removeOperation(t){var e=getOperation(t);Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.i)(e.class.operations,e),delete e.class.operationByName[e.name],updateFig(),updateExport(model)}var transitionCounter=0;function nextTransName(){return"T".concat(transitionCounter++)}function addTransition(){function t(t){return model.getState(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(t))}if(!(0>targetStates.selectedIndex)){var e,n=t(sourceStates),r=t(targetStates),o=n.region;for(o.transitionByName=o.transitionByName||{};o.transitionByName[e=nextTransName()];);var a={name:e,source:n,target:r,region:o};o.transitions=o.transitions||[],o.transitions.push(a),o.transitionByName[a.name]=a,n.outgoing.push(a),r.incoming.push(a),updateFig(),updateExport(model)}}function addInternalTransition(){var t,e=model.getState(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.e)(contextStates));for(e.transitionByName=e.transitionByName||{};e.transitionByName[t=nextTransName()];);var n={name:t,source:e,target:e,region:e,isInternal:!0};e.transitionByName[n.name]=n,e.internalTransitions=e.internalTransitions||{},e.internalTransitions[n.name]=n,updateFig()}Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.c)(symbol=>eval(symbol),"addState","addPseudostate","addTransition","addInternalTransition","addObject","addEntry","addExit","editState","editTransition","removeTransition","removeState","removeObject","makeActive","makePassive","addOperation","removeOperation","editMethod")},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0);function o(t){return Object(r.j)(t.transitions.filter(t=>t.trigger).map(t=>t.trigger))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return l}));var r=n(0),o=n(1),a="&#9003;",i=n(8);function c(t,e,n,c,l){function u(t,e,n){return"javascript:".concat(b).concat(t,"('").concat(encodeURIComponent(l.stateFullName(e)),"'").concat(n?",'".concat(n,"'"):"",")")}function d(t,e){return"[[".concat(c.getTransURI("editTransition",t,e)," ").concat(Object(r.g)(t[e])||"<add ".concat(e,">"),"]]")}function p(t,n){function o(e){return t.ports?" from ".concat(t.ports.join(", ")).concat(e?" ":""):""}var i,s="";if(y&&!e)s="".concat(d(t,"trigger")).concat(o(!0),"[&#8203;").concat(d(t,"guard"),"]/").concat(d(t,"effect")," [[").concat(c.getTransURI("removeTransition",t)," ").concat(a,"]]");else{if(t.trigger||t.guard||t.effect){s="".concat((i=function(){var n=t.trigger;return!e&&(c.isActivable(t)&&!c.eventMatched(t)||n&&E)&&(n="<color:".concat(O.noEventColor,"><s>").concat(n,"</s></color>")),n}(),i||"")).concat(o(t.guard)).concat(t.guard?"[".concat(function(){var n=t.guard;return c.isActivable(t)&&c.eventMatched(t)&&!(e||c.isFireable(t))&&(n="<color:".concat(O.falseGuardColor,"><s>").concat(n,"</s></color>")),n}(),"]"):"").concat(t.effect?"/".concat(Object(r.g)(t.effect)):"")}!e&&(E||c.isFireable(t))&&(""==s&&(s="// fire"),s="[[".concat(c.getFireURI(t)," ").concat(s,"]]"))}return""==s?(n?":":"")+s:": ".concat(s)}function f(t){return"[[".concat(u("editState",t)," ").concat(t.name,"]] [[").concat(u("removeState",t)," ").concat(a,"]]")}function _(t){return g(t,"Current pseudostate",O.currentStateColor)}function g(t,e,n){var r="".concat(l.stateFullName(t),"Note");return'\n\t\t\tnote "'.concat(e,'" as ').concat(r," ").concat(n?"#".concat(n):"","\n\t\t\t").concat("initial"==t.kind?"[*] --\x3e ".concat(r):"".concat(r," --\x3e ").concat(v(t)))}function m(t,n,o){var a="".concat(o||"").concat(Object(r.g)(t[n]));return y&&!e&&(a="[[".concat(u("editProperty",t,n)," ").concat(a,"]]")),a}function h(t){return E?t.kind&&!0:c.isCurrent(t)}function v(t){switch(t.kind+""){case"shallowHistory":return"".concat(v(t.region),"[H]");case"initial":return"[*]";default:return Object(o.a)(l.stateFullName(t))}}var{callPrefix:b,forAnimation:E,editing:y,colors:O}=n;return"\n\t\t@startuml\n\t\t'skinparam monochrome true\n\t\t".concat(s(y)&&!e?"left header Warning, showing as explicit state machine,\\nbut execution actually proceeds on the original state machine.\\nExplicit-specific function calls will not appear in history.\\nIf an history node or any other error is visible, then your state\\nmachine is not supported yet.":"",'\n\n\t\tstate "').concat(function(n){if(y&&!e){var r=encodeURIComponent(t.name);return"[[javascript:".concat(b,"editObject('").concat(r,"') ").concat(n,"]] [[javascript:").concat(b,"removeObject('").concat(r,"') ").concat(a,"]]")}return n}(t.name),'" as ').concat(Object(o.a)(t.name)," {\n\t\t\t").concat(function t(n,r){return"\n\t\t\t".concat((n.states||[]).map(n=>{var o=n.kind;switch(n.kind){case"junction":case"deepHistory":console.log('Unsupported "%s" Pseudostate: %s',n.kind,n);break;case"shallowHistory":y&&!e&&r.push(g(n,"&#171;".concat(n.kind,"&#187; ").concat(f(n))));break;case"initial":if(y&&!e)return g(n,"&#171;".concat(n.kind,"&#187; ").concat(f(n)))+(h(n)?"#".concat(O.currentStateColor):"");if(h(n)&&!e)return _(n);break;case"terminate":o="end";case"join":case"fork":case"choice":case"entrypoint":case"exitpoint":return"\n\t\t\t\t\t\tstate ".concat(v(n)," <<").concat(o,">>\n\t\t\t\t\t\t").concat(y&&!e?"note left of ".concat(v(n)," ").concat(h(n)?"#".concat(O.currentStateColor):""," : &#171;").concat(n.kind,"&#187; ").concat(f(n)):h(n)&&!e?_(n):"");default:var a=[];return"\n\t\t\t\t\t\t".concat(n.entry?"".concat(v(n)," : ").concat(m(n,"entry","entry/")):"","\n\t\t\t\t\t\t").concat(n.exit?"".concat(v(n)," : ").concat(m(n,"exit","exit/")):"","\n\t\t\t\t\t\t").concat(n.doActivity?"".concat(v(n)," : ").concat(m(n,"doActivity","do/")):"","\n\t\t\t\t\t\t").concat(Object.values(n.internalTransitions||{}).map(t=>"\n\t\t\t\t\t\t\t".concat(v(n)," ").concat(p(t,!0))).join(""),"\n\t\t\t\t\t\tstate ").concat(function(t){return y&&!e?'"'.concat(f(t),'" as ').concat(v(t)):'"'.concat(t.name,'" as ').concat(v(t))}(n)," ").concat(h(n)&&!e?"#".concat(O.currentStateColor):""," {\n\t\t\t\t\t\t\t").concat(t(n,a),"\n\t\t\t\t\t\t}\n\t\t\t\t\t\t").concat(a.join(""))}}).join(""),"\n\t\t\t").concat((n.transitions||[]).map(t=>"\n\t\t\t\t".concat(v(t.source)," -").concat(e||!c.isFireable(t)||E?"":"[#".concat(O.fireableTransitionColor,"]"),"-> ").concat(v(t.target)," ").concat(p(t))).join(""),"\n\t\t")}(function(t,e,n){return s(n)?Object(i.a)(t,e):t}(t,l,y),[]),"\n\t\t}\n\t\t@enduml\n\t")}function s(t){return showExplicitSM.checked&&!t}function l(t,e,n,i,s){var{displayedObjects:l,editing:u,callPrefix:d,colors:p}=s,f=l.filter(t=>showPorts.checked||!n.isPort(t));if(hideClasses.checked){var _=f.filter(n.isActive),g=_.map(r=>c(r,t,{callPrefix:d,forAnimation:e,editing:u,colors:p},i,n)).join("");return _.forEach(t=>{M&&(g+="".concat(Object(o.a)(M.name)," -[hidden]-> ").concat(Object(o.a)(t.name),"\n")),M=t}),g}function m(t){return encodeURIComponent("".concat(t.class.name,".").concat(t.name))}function h(e){var n="".concat(e.name,"()");return u&&!t?n="[[javascript:".concat(d,"editOperation('").concat(m(e),"') ").concat(n,"]] [[javascript:").concat(d,"removeOperation('").concat(m(e),"') ").concat(a,"]]"):function(t){return!checkEvents.checked||i.findMessage(t.name,t.class.name)}(e)&&!t&&(n="[[javascript:".concat(d,"callOperation('").concat(m(e),"')").concat(e.method?"{".concat(Object(r.g)(e.method).replace(/<U\+007B>/g,"{"),"}"):""," ").concat(n,"]]")),n="".concat(e.private?"-":"+").concat(n)}function v(t){return Object(o.a)(t).replace(/\./,"__")}function b(e){var n=function(t){return t.class?"".concat(t.name," : ").concat(t.class):t.name}(e);return n=t?'"'.concat(n,'" as ').concat(v(e.name)):u?'"[[javascript:'.concat(d,"editObject('").concat(e.name,"') ").concat(n,"]] [[javascript:").concat(d,"removeObject('").concat(e.name,"') ").concat(a,']]" as ').concat(v(e.name)):'"[[javascript:'.concat(d,"setSender('").concat(e.name,"') ").concat(n,']]" as ').concat(v(e.name))}function E(e,n){return r=>{var o=r;return!t&&(u||checkEvents.checked&&!e.isActor||(o="[[javascript:".concat(d,"callOperation('").concat(n.name,".").concat(o.replace(/ /g,"%20"),"','").concat(e.name,"') ").concat(o,"]]"))),o}}function y(e){if(hideMethods.checked)return"";var n=e.method;return u&&!t&&(n="[[javascript:".concat(d,"editMethod('").concat(m(e),"') ").concat(n?Object(r.g)(n):"<add method>","]]")),n&&(n="\n\t\t\t\t\t\tnote right of ".concat(v(e.class.name),"::").concat(e.name,"\n").concat(n,"\n\t\t\t\t\t\tend note")),n}function O(t){return t.ends.every(t=>f.includes(t))}var j,M;g="allowmixing\n"+f.map(r=>{function o(){return n.isActive(r)&&!hideStateMachines.checked?"\n\t\t\t\t\t\tnote right of ".concat(v(r.name),"\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t").concat(c(r,t,{callPrefix:d,forAnimation:e,editing:u,colors:p},i,n),"\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tend note\n\t\t\t\t\t"):""}return r.isActor?"\n\t\t\t\t\tactor ".concat(b(r),"\n\t\t\t\t\t").concat(o()):"\n\t\t\t\t\tclass ".concat(b(r)," ").concat(function(e){return n.isActive(e)?u&&!t?"<<[[javascript:".concat(d,"makePassive('").concat(e.name,"') makePassive]]>>"):"<<active>>":u&&!t?"<<[[javascript:".concat(d,"makeActive('").concat(e.name,"') makeActive]]>>"):""}(r)," {\n\t\t\t\t\t\t").concat((r.operations||[]).map(t=>"\n\t\t\t\t\t\t\t".concat(h(t))).join(""),"\n\t\t\t\t\t\t").concat(u&&!t?"[[javascript:".concat(d,"addOperation('").concat(r.name,"') ADD]] an operation()"):"","\n\t\t\t\t\t}\n\t\t\t\t\t").concat((r.operations||[]).map(y).join(""),"\n\t\t\t\t\t").concat(o(),"\n\t\t\t\t")}).join("")+(n.connectors||[]).filter(O).concat(showPorts.checked?[]:(j=[],f.flatMap(t=>n.getConnectors(t).filter(e=>!j.includes(e)&&n.isPort(n.getOtherEnd(e,t))).map(e=>{var o=n.navigateThroughPorts(t,n.getOtherEnd(e,t));Array.prototype.push.apply(j,o.traversedConnectors);var a=Object(r.h)(o.traversedConnectors),i=[e.endNames?e.endNames[e.ends.indexOf(t)]:" ",a.endNames?a.endNames[a.ends.indexOf(o.target)]:" "];return{name:"VIRTUAL CONNECTOR",ends:[t,o.target],endNames:i}}))).filter(O)).map(t=>{var e,n,o="",a=null===(e=t.possibleMessages)||void 0===e?void 0:e.forward,i=null===(n=t.possibleMessages)||void 0===n?void 0:n.reverse,c=Object(r.f)(i),s=(o="",showEndNames.checked&&t.endNames?'"'.concat(t.endNames[0],'" '):""),l=showEndNames.checked&&t.endNames?' "'.concat(t.endNames[1],'"'):"";return Object(r.f)(a)&&(o+="\n\t\t\t\t\t".concat(v(t.ends[0].name)," ").concat(s,"-").concat(c?"[#transparent]":"","-").concat(l," ").concat(v(t.ends[1].name)," : > ").concat(a.map(E(t.ends[0],t.ends[1])).join("\\n"))),c&&(o+="\n\t\t\t\t\t".concat(v(t.ends[0].name)," ").concat(s,"--").concat(l," ").concat(v(t.ends[1].name)," : < ").concat(i.map(E(t.ends[1],t.ends[0])).join("\\n"))),""==o&&(o+="\n\t\t\t\t\t".concat(v(t.ends[0].name)," ").concat(s,"--").concat(l," ").concat(v(t.ends[1].name))),o}).join("");n.connectors&&0!=n.connectors.length||f.forEach(t=>{M&&(g+="".concat(v(M.name)," -[hidden]-> ").concat(v(t.name),"\n")),M=t});return"\n\t\t\thide circle\n\t\t\t".concat(g,"\n\t\t")}},function(t,e,n){"use strict";function r(t,e){function n(t){return t.trigger.replace(e.afterRegex,"$1")}function r(t){return"TO".concat(t)}function o(t){return O.filter(e=>e.source==t)}function a(t){return O.filter(e=>e.target==t)}function i(t){var a=t.entry||"";return o(t).filter(t=>(t.trigger||"").match(e.afterRegex)).forEach(t=>{var e=n(t),o=r(e);a+="setTimer(".concat(o,", ").concat(e,");")}),a}function c(t){return t.exit||""}function s(t){return t.states&&0<t.states.length}function l(t,e,n){return(t.states||[]).filter(t=>!(e&&"initial"==t.kind)&&"shallowHistory"!=t.kind).flatMap(t=>{var e=l(t,!0,n);return 0==e.length?[t]:n?[t].concat(e):e})}function u(t,n){return(t.transitions||[]).flatMap(r=>{var o=s(r.target)?e.getInitial(r.target).outgoing[0].target:r.target,a=s(r.target)?m(r.effect,e.getInitial(r.target).outgoing[0].effect):r.effect;if("initial"==r.source.kind){if(!n||t!=n)return[];var i=r.source;return[{region:n||t,name:p(r),source:i,target:o,trigger:r.trigger,guard:r.guard,effect:a}]}if(s(r.source))return l(r.source,!0).filter(t=>!t.kind).map((e,i)=>({region:n||t,name:"".concat(p(r)).concat(b?"":"_".concat(i)),source:e,target:"shallowHistory"==o.kind&&o.region==e.region?e:o,trigger:r.trigger,guard:r.guard,effect:a}));i=r.source;return[{region:n||t,name:p(r),source:i,target:o,trigger:r.trigger,guard:r.guard,effect:a}]})}function d(t){return!t.region}function p(t){return d(t.region)?t.name:"".concat(p(t.region)).concat(b?".":"_").concat(t.name)}function f(n){if(n){var r=e.stateFullName(n),i=E.states[r];return i||(i={},E.states[r]=i,i.region=f(t),i.name=p(n),i.incoming=a(n).map(v),i.outgoing=o(n).map(v),i.kind="choice"==n.kind?void 0:n.kind,i.doActivity=n.doActivity,i.internalTransitions={},Object.entries(n.internalTransitions||{}).map(t=>{var[e,n]=t;i.internalTransitions[e]=v(n),i.internalTransitions[e].isInternal=!0})),i}}function _(t){var a="";return(o(t.source)||[]).filter(n=>t!=n&&(n.trigger||"").match(e.afterRegex)).forEach(t=>{var e=r(n(t));a="resetTimer(".concat(e,"); ").concat(a)}),a}function g(t){var o="choice"==t.source.kind?"when(".concat(t.guard,")"):t.trigger||"";o.match(e.afterRegex)?o=r(n(t)):o.match(e.whenRegex);return""==o?void 0:o}function m(t,e){return t&&""!=t?e&&""!=e?"".concat(t,"\n").concat(e):t:e&&""!=e?e:void 0}function h(t){function e(t){n=m(n,""==t?void 0:t)}var n;return t.isInternal||(e(_(t)),e(c(t.source))),e(t.effect||""),t.isInternal||e(i(t.target)),""==n?void 0:n}function v(t){return{region:f(t.region),name:t.name,source:f(t.source),target:f(t.target),trigger:g(t),guard:"choice"==t.source.kind?void 0:t.guard,effect:h(t)}}var b=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],E={states:{},transitions:{}},y={};E.states[e.stateFullName(t)]=y;var O=[t].concat(l(t,!0,!0)).flatMap(e=>u(e,t));return y.name=t.name,y.states=l(t).map(f),y.transitions=O.map(v),b||(y.stateByName=Object.fromEntries(y.states.map(t=>[t.name,t])),y.transitionByName=Object.fromEntries(y.transitions.map(t=>[t.name,t]))),y}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(2),o=n(6),a=n(0);function i(){var t=_(["\n\t\t\t\t\tclass "," {\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t}\n\t\t\t\t"]);return i=function(){return t},t}function c(){var t=_(["\n\t\t\t\t\t\t\t\t\t\tstate ","\n\t\t\t\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t\t\t"]);return c=function(){return t},t}function s(){var t=_([""," -> "," : "," : ",""," / ",";"]);return s=function(){return t},t}function l(){var t=_(["\n\t\t\t\t\tclass |","| behavesAs SM receives "," {\n\t\t\t\t\t\t","\n\t\t\t\t\t\t","\n\t\t\t\t\t\tstateMachine SM {\n\t\t\t\t\t\t\tregion R {\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t\t","\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t"]);return l=function(){return t},t}function u(){var t=_(["\n\t\t\t\tassociation "," {\n\t\t\t\t\t","\n\t\t\t\t}\n\t\t\t"]);return u=function(){return t},t}function d(){var t=_(["\n\t\t\t\tsignal ",";\n\t\t\t\tsignalEvent "," of ",";\n\t\t\t"]);return d=function(){return t},t}function p(){var t=_(["\n\t\tmodel "," {\n\t\t\tinstance instMain of Main {}\n\t\t\tclass Main {\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t}\n\t\t\t","\n\t\t\t","\n\t\t\t","\n\t\t}\n\t"]);return p=function(){return t},t}function f(){var t=_([""," operation ","()",";"]);return f=function(){return t},t}function _(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function g(t){function e(t){return t.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)&&!h.includes(t)?t:'"'.concat(t,'"')}function n(t){return e("".concat(t.name,"_method"))}function _(t){return(t.operations||[]).map(t=>Object(r.a)(f(),t.isPrivate?"private":"public",e(t.name),t.method&&" behavesAs ".concat(n(t))))}function g(t,e){return"opaqueBehavior ".concat(e&&"".concat(e," "),"= '").concat(t,"' in AnimUML;")}function m(t){return(t.operations||[]).filter(t=>t.method).map(t=>g(t.method,n(t)))}var h=["choice","class","opaqueBehavior","opaqueExpression","constraint","state","behavesAs","model"];return Object(r.a)(p(),e(t.name),t.objects.map(t=>"public composite ".concat(e(t.name),"[1-1] : ").concat(e(t.name),";")),(t.connectors||[]).map(t=>"connector ".concat(e(t.name)," : ").concat(e(t.name)," between ").concat(e(t.ends[0].name)," and ").concat(e(t.ends[1].name),";")),Object(a.j)(t.objects.filter(t.isActive).flatMap(t=>Object(o.a)(t))).map(t=>Object(r.a)(d(),e(t),e("".concat(t,"_SE")),e(t))),(t.connectors||[]).map(t=>Object(r.a)(u(),e(t.name),t.ends.map(n=>"".concat(e(n.name),"[1-1] : ").concat(e(n.name)," in ").concat(e(t.name),";")))),t.objects.map(n=>t.isActive(n)?Object(r.a)(l(),e(n.name),Object(o.a)(n).map(t=>"".concat(e(t),"(").concat(e(t),")")).join(", "),_(n),m(n),n.transitions.map(t=>Object(r.a)(s(),e(t.source.name),e(t.target.name),e(t.name),t.trigger&&"".concat(e("".concat(t.trigger,"_SE"))),t.guard&&'[constraint "guard" is opaqueExpression = \''.concat(t.guard,"' in AnimUML;]"),t.effect&&g(t.effect))),n.states.filter(t=>t.kind||t.entry||t.exit||t.doActivity).map(t=>t.kind?"".concat(t.kind," pseudoState ").concat(e(t.name),";"):Object(r.a)(c(),e(t.name),t.entry&&"entry / ".concat(g(t.entry))))):Object(r.a)(i(),e(n.name),_(n),m(n))))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(6),o=n(2);function a(){var t=d(["\n\t\t\t\t\n\t\t\t"]);return a=function(){return t},t}function i(){var t=d(["\n\n\t\t\t\t#include <mqueue.h>\n\n\t\t\t\tstruct "," {\n\t\t\t\t\tmqd_t mq,\n\t\t\t\t\tpthread_t thread\n\t\t\t\t};\n\n\n\t\t\t\tenum State {};\n\n\t\t\t\ttransitions[][] = {\n\t\t\t\t};\n\n\t\t\t\t","_start("," * this) {\n\t\t\t\t\tpthread_create()\n\t\t\t\t\tpthread_start(","_run);\n\t\t\t\t}\n\t\t\t\t","_run("," * this) {\n\t\t\t\t\tState currentState = ...;\n\t\t\t\t\twhile(true) {\n\t\t\t\t\t\tmq_receive(msg)\n\t\t\t\t\t\ttransition = transitions[currentState][msg.event]\n\t\t\t\t\t\tif(transition.action) {\n\t\t\t\t\t\t\tcurrentState = transition.targetState;\n\t\t\t\t\t\t\ttransition.action()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","_stop("," * this) {\n\t\t\t\t\tmq_send(STOP)\n\t\t\t\t\tpthread_join(thread)\n\t\t\t\t}\n\n\t\t\t\t","\n\n\t\t\t\t","\n\t\t\t"]);return i=function(){return t},t}function c(){var t=d(["\n\t\t\t\t\n\t\t\t"]);return c=function(){return t},t}function s(){var t=d(["\n\t\t\t\ttypedef struct "," ",";\n\t\t\t"]);return s=function(){return t},t}function l(){var t=d(["\n\t\t\tvoid ","_","() {\n\t\t\t}\n\t\t"]);return l=function(){return t},t}function u(){var t=d(["\n\t\t\tvoid ","_","() {\n\t\t\t\tmq_send();\n\t\t\t}\n\t\t"]);return u=function(){return t},t}function d(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function p(t){function e(t){return Object(o.a)(l(),t.class.name,t.name)}function n(n){return t.isActive(n)?Object(o.a)(i(),n.name,n.name,n.name,n.name,n.name,n.name,n.name,n.name,Object(r.a)(n).map(t=>function(t,e){return Object(o.a)(u(),t.name,e)}(n,t)),(n.operations||[]).map(e)):Object(o.a)(a())}function d(t,e){return t+"\0".repeat(e-t.length)}function p(t,e){return t+"\0".repeat(e-t.length)}function f(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"0000644",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"00000000000",a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"0000000",i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"0000000",c="";c+=p("".concat(t.name,"/").concat(e),100),c+=p(r,8),c+=p(a,8),c+=p(i,8),c+=p(n.length.toString(8),12);var s=(c+=p(o,12)).length;c+=p("        ",8),c+=p("0",1),c=d(c+=p("",100),512);var l=Array.prototype.map.call(c,t=>t.charCodeAt(0)).reduce((t,e)=>t+e).toString(8).padStart(6,"0")+"\0 ";return c=c.slice(0,s)+l+c.slice(s+8),c=d(c+=n,512*(Math.floor((c.length-1)/512)+1))}return[].fill(0,0,256),t.objects.map(e=>f("".concat(e.name,".c"),n(e))+f("".concat(e.name,".h"),function(e){return t.isActive(e)?Object(o.a)(s(),e.name,e.name):Object(o.a)(c())}(e))).join("")+f("main.c","\n\t\tint main(int argc, char ** argv) {\n\t\t}\n\t")}},function(t,e,n){"use strict";function r(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){function i(t){r(s,o,a,i,c,"next",t)}function c(t){r(s,o,a,i,c,"throw",t)}var s=t.apply(e,n);i(void 0)}))}}n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i}));class a{constructor(t){var e,n=this,r=new Promise(n=>{var r=new WebSocket(t);r.onopen=()=>n(r),r.onmessage=t=>{e&&e(t.data),e=void 0}});this.askCommands=o((function*(){return new Promise(function(){var t=o((function*(t){e=t,n.sendCommand("ASK_COMMANDS")}));return function(){return t.apply(this,arguments)}}()).then(JSON.parse)})),this.sendCommand=o((function*(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=JSON.stringify(e);(yield r).send(o)})),this.close=o((function*(){(yield r).close()}))}}class i{constructor(t,e){function n(t){i.send(t)}function r(){return a.apply(this,arguments)}function a(){return(a=o((function*(){return new Promise(t=>{c.push(t)})}))).apply(this,arguments)}var i=new WebSocket(t),c=[];this.close=()=>{i.close()},i.onerror=function(t){console.log("WebSocket Error: %s",t)},i.onclose=function(){var t;null==e||null===(t=e.onclose)||void 0===t||t.call(e)};var s=Promise.resolve();i.onmessage=t=>{(function(){var a,i,l,u=this,d=c.shift();if(d)d(t.data);else{var p=t.data.split(":"),f=p[0],_=p.slice(1).join(":");switch(f+""){case"RESET":this.engine.reset();break;case"GET_CONFIGURATION":s=s.then(()=>this.engine.getConfiguration().then(function(){var t=o((function*(t){yield n(t),(null==e?void 0:e.ongetconfig)&&(yield e.ongetconfig(t))}));return function(){return t.apply(this,arguments)}}()));break;case"GET_FIREABLES":s=s.then(()=>this.engine.getFireables().then(t=>{for(var e of(n(""+t.length),t))n(e)}));break;case"FIRE":s=Promise.all([r(),s]).then(function(){var t=o((function*(t){var[n]=t;yield u.engine.fire(n),(null==e?void 0:e.onfired)&&(yield e.onfired(n))}));return function(){return t.apply(this,arguments)}}());break;case"SET_CONFIGURATION":s=Promise.all([r(),s]).then(t=>{var[e]=t;return this.engine.setConfiguration(e)});break;case"EVALUATE_ATOMS":s=s.then(()=>Promise.all(_.split(";").map(t=>this.engine.evaluateAtom(t)))).then(t=>n(JSON.stringify(t)));break;case"UUID":null==e||null===(a=e.onuuid)||void 0===a||a.call(e,_);break;case"RESULTS":null==e||null===(i=e.onresults)||void 0===i||i.call(e,t.data);break;case"PROGRESS":null==e||null===(l=e.onprogress)||void 0===l||l.call(e,t.data);break;default:console.log("Unsupported request from server: %s",t.data)}}}).bind(this)()}}setEngine(t){this.engine=t}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1),o=n(0);function a(t,e,n,a){function i(t){return"]"==t?"_LOST_":"["==t?"_FOUND_":Object(r.a)(t)}function c(t,e){return n.fullStateDisplay(d[t.name])!==n.fullStateDisplay(e)}var{callPrefix:s,stateOfIn:l}=a,u=0,d={};return"\n\t\t'hide time-axis\n\t\tscale 1 as ".concat(timingScale.value,' pixels\n\t\trobust "Unknown source" as _FOUND_\n\t\t').concat(n.objects.map(t=>{return'concise ":'.concat((o=t.name,a=o,e||(a="[[javascript:".concat(s,"switchToObject('").concat(o,"') ").concat(o,"]]")),a),'" as ').concat(Object(r.a)(t.name),"\n\t\t\t").concat(n.isActive(t)?"":"\n\t\t\t\t@0\n\t\t\t\t".concat(Object(r.a)(t.name)," is {-}\n\t\t\t"),"\n\t\t");var o,a}).join(""),'\n\t\trobust "Unknown target" as _LOST_\n\t\t').concat(e?"":'concise "History" as _HISTORY_','\n\t\t@0\n\t\t        _LOST_ is  "                            "\n\t\t        _FOUND_ is "                            "\n\t\t').concat(t.map((t,a)=>{var p="\n\t\t\t\t@".concat(u,"\n\t\t\t\t").concat(e?"":"_HISTORY_ is ".concat(function(t,n){return e?t:"".concat(t," : [[javascript:").concat(s,"backTo(").concat(n,") goto]]")}(a,a)),"\n\t\t\t\t").concat(n.objects.filter(e=>n.isActive(e)&&(t.configuration&&c(e,l(e,t))||e==t.activeObject)).map(e=>(d[e.name]=l(e,t),showPseudostateInvariants.checked||t.configuration&&!Object(o.h)(l(e,t)).kind?"".concat(Object(r.a)(e.name)," is ").concat(n.fullStateDisplay(l(e,t)),"\n"):"")).join(""),"\n\t\t\t");return u+=1,t.logicalTime=u,p+="\n\t\t\t\t@".concat(u,"\n\t\t\t\t").concat((t.messages||[]).filter(t=>!t.receivedAt||t.receivedAt.logicalTime&&t.receivedAt.logicalTime==u).map(e=>e.signature.match(/^after\(/)?"\n\t\t\t\t\t\t".concat(Object(r.a)(t.activeObject.name),"@").concat(u-1," <-> @").concat(u," : ").concat(e.signature,"\n\t\t\t\t\t\t@").concat(u):"\n\t\t\t\t\t\t".concat(i(e.source),"@").concat(e.sentAt?e.sentAt.logicalTime:u,"->").concat(i(e.target)," : ").concat(e.signature).concat(e.receivedAt?"":" ?")).join(""),"\n\t\t\t")}).join(""),"\n\t\t@").concat(u,"\n\t\t").concat(n.objects.filter(t=>n.isActive(t)&&c(t,builtInEngine.configuration.currentState[t.name])).map(t=>"".concat(Object(r.a)(t.name)," is ").concat(n.fullStateDisplay(builtInEngine.configuration.currentState[t.name]),"\n\t\t")).join(""),"\n\t\t").concat(e?"":"_HISTORY_ is {hidden}","\n\t")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),o=n(1);function a(t,e,n,a){var{stateOfIn:i,ALL_OBJECTS:c,configuration:s,callPrefix:l,participants:u,raw:d,colors:p,hideStates:f}=a,_=u||e.objects.filter(t=>!e.isPort(t));return"\n\t\t".concat(_.map(t=>{return"\n\t\t\t".concat(t.isActor?"actor":"participant",' "').concat((e=t.name,n=e,d||(n="[[javascript:".concat(l,"switchToObject('").concat(e,"') ").concat(e,"]]")),n)," : ").concat(t.class?t.class:"",'" as ').concat(Object(o.a)(t.name));var e,n}).join(""),"\n\t\t").concat(1<e.objects.length?"participant Ether":"","\n\t\t").concat(t.map((t,n)=>t.PlantUML?"\n\t\t\t".concat(t.PlantUML,"\n\t\t"):"\n\t\t\t".concat(f?"":e.objects.filter(n=>e.isActive(n)&&t.activeObject===n&&(showPseudostateInvariants.checked||!Object(r.h)(i(n,t)).kind)).map(r=>"hnote over ".concat(Object(o.a)(r.name)," : ").concat(function(t,e){return d?t:"[[javascript:".concat(l,"backTo(").concat(e,") ").concat(t,"]]")}(e.fullStateDisplay(i(r,t)),n),"\n\t\t\t")).join("/"),"\n\t\t\t").concat(t.messages.map(e=>e.signature.match(/^after\(/)?"\n\t\t\t\t\t... ".concat(e.signature,"..."):"\n\t\t\t\t\t".concat(function(t,e){return e.sentAt!==t&&e.sentAt&&e.receivedAt!==e.sentAt?"Ether":Object(o.a)(e.source)}(t,e)).concat("["===e.source?"o":"","->").concat(e.ignored?"o".concat("]"===e.target?"":" "):"").concat(function(t,e){return e.receivedAt!==t&&e.receivedAt&&e.receivedAt!==e.sentAt?"Ether":Object(o.a)(e.target)}(t,e)," : ").concat(e.signature)).join(""))).join(""),"\n\t\t").concat(f?"":_.filter(t=>e.isActive(t)&&(showPseudostateInvariants.checked||!Object(r.h)(s.currentState[t.name]).kind)).map(t=>"hnote over ".concat(Object(o.a)(t.name)," : ").concat(e.fullStateDisplay(s.currentState[t.name]),"\n\t\t")).join("/"),"\n\t\t").concat(d||!hideStateMachines.checked&&Object(r.e)(objectSelect)==c?"":_.filter(e.isActive).map(t=>"note over ".concat(Object(o.a)(t.name),"\n\t\t\t\tFireable triggers:\n\t\t\t\t").concat(n.getFireable(t).map(t=>"*[[javascript:".concat(l,"fire('").concat(e.transFullName(t),"'){").concat(function(t){var e="".concat(t.source.name," -> ").concat(t.target.name);return(t.trigger||t.guard||t.effect)&&(e+=" : ".concat(Object(r.g)(t.trigger)||"").concat(t.ports?" from ".concat(t.ports.join(", ")).concat(t.guard?" ":""):"").concat(t.guard?"[".concat(Object(r.g)(t.guard),"]"):"").concat(t.effect?"/".concat(Object(r.g)(t.effect)):"")),e}(t),"} ").concat(t.trigger?t.trigger:t.guard?"[".concat(t.guard,"]"):t.effect&&15>t.effect.length?"/".concat(t.effect):"// fire","]]\n\t\t\t\t")).join(""),"Other triggers:\n\t\t\t\t").concat(n.getFireable(t,n.isActivable).filter(t=>!n.eventMatched(t)).map(t=>"*<color:".concat(p.noEventColor,"><s>").concat(t.trigger?t.trigger:t.guard?"[".concat(t.guard,"]"):"// fire","</s></color>\n\t\t\t\t")).join("")+n.getFireable(t,n.isActivable).filter(n.eventMatched).filter(t=>!n.isFireable(t)).map(t=>"*<color:".concat(p.noEventColor,"><s>").concat(t.trigger?t.trigger:t.guard?"[".concat(t.guard,"]"):"// fire","</s></color>\n\t\t\t\t")).join(""),"\n\t\t\t end note\n\t\t")).join("/")+_.filter(t=>t.isActor&&!e.isActive(t)).map(t=>"/note over ".concat(Object(o.a)(t.name),"\n\t\t\t\tCallable operations:\n\t\t\t\t").concat(e.connectors.filter(e=>e.ends.some(e=>e==t)).map(e=>{var n;return null===(n=e.possibleMessages)||void 0===n?void 0:n.forward.map(n=>{return r=e.ends.find(e=>e!=t).name,"* [[javascript:".concat(l,"callOperation('").concat(r,".").concat(n,"','").concat(t.name,"') ").concat(r,".").concat(n,"]]");var r}).join("\n\t\t\t\t")}).join("\n\t\t\t\t"),"\n\t\t\tend note\n\t\t")).join(""),"\n\t")}},function(t,e,n){"use strict";function r(t,e,n){var r="";return r+=o(63&t>>2),r+=o(63&((3&t)<<4|e>>4)),r+=o(63&((15&e)<<2|n>>6)),r+=o(63&n)}function o(t){return 10>t?String.fromCharCode(48+t):26>(t-=10)?String.fromCharCode(65+t):26>(t-=26)?String.fromCharCode(97+t):0==(t-=26)?"-":1==t?"_":"?"}function a(t,e){return t+"svg/"+function(t){for(var e="",n=0;n<t.length;n+=3)e+=n+2==t.length?r(t.charCodeAt(n),t.charCodeAt(n+1),0):n+1==t.length?r(t.charCodeAt(n),0,0):r(t.charCodeAt(n),t.charCodeAt(n+1),t.charCodeAt(n+2));return e}(pako.deflateRaw(e,{level:9,to:"string"}))}n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n(0);function r(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){function i(t){r(s,o,a,i,c,"next",t)}function c(t){r(s,o,a,i,c,"throw",t)}var s=t.apply(e,n);i(void 0)}))}}function a(){return i.apply(this,arguments)}function i(){return(i=o((function*(t){return(yield Promise.all(t.map(function(){var t=o((function*(t){return"function"==typeof t?yield t():[t]}));return function(){return t.apply(this,arguments)}}()))).flatMap(t=>t)}))).apply(this,arguments)}function c(t){return o((function*(){for(var e,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var[i,...c]=r;("diff"===i||(null==t||null===(e=t[i])||void 0===e?void 0:e.call(t,{type:i,args:c})))&&console.log.apply(console,yield a(r))}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(0),o=n(4);class a{constructor(t,e){var n,a=/after\(([^)]*)\)/,i=/when\(([^)]*)\)/;if(!(t=Object(o.a)(t)).objects){var c=t;t={name:c.name,objects:[t]},c.settings&&(t.settings=c.settings,delete c.settings)}Object.assign(this,t),Object.assign(this,{getObject(t){return this.objects.find(e=>e.name==t)},getConnectors(t){var e;return(null===(e=this.connectors)||void 0===e?void 0:e.filter(e=>e.ends.includes(t)))||[]},getInitial(t){return this.isActive(t)?t.states.find(t=>"initial"==t.kind):void 0},getState(t){var e=t.split("."),n=this.getObject(e[0]);return(e=e.slice(1)).forEach(t=>{n=n.stateByName[t]}),n},getTransition(t){var e=t.split("."),n=this.getObject(e[0]);return(e=e.slice(1)).slice(0,e.length-1).forEach(t=>{n=n.stateByName[t]}),(n=n.transitionByName[Object(r.h)(e).replace(/__DOT__/g,".")])||console.log("Could not find transition: ",t),n},getObjectRelative(t,e){var n=this.connectors.filter(e=>e.endNames&&e.ends.includes(t)).map(n=>{switch(n.ends.indexOf(t)){case 0:if(e===n.endNames[1])return n.ends[1];break;case 1:if(e===n.endNames[0])return n.ends[0]}}).filter(t=>t);return 1==n.length?n[0]:0==n.length?void 0:n},fullState(t){if(t.region){var e=this.fullState(t.region);return e.push(t),e}return[]},noEventTrigger:t=>!t.trigger||t.trigger.match(a)||t.trigger.match(i),isActive:t=>Object(r.f)(t.states),isPort:t=>"Port"==t.type,stateFullName(t){return"".concat(t.region?"".concat(this.stateFullName(t.region),"."):"").concat(t.name)},transFullName(t){return"".concat(this.stateFullName(t.region),".").concat(t.name.replace(/\./g,"__DOT__"))},fullStateDisplay:t=>t?t.map(t=>t.name).join("."):t,getOtherEnd:(t,e)=>t.ends.find(t=>t!=e),getStateObject(t){for(var e=t.region;e.region;)e=e.region;return e},getTransObject(t){for(var e=t.region;e.region;)e=e.region;return e},navigateThroughPorts(t,e,n){for(var r,o=[],a=t,i=e;this.isPort(i);){var c=this.getConnectors(i).find(t=>!t.ends.includes(a));o.push(c),a=i,i=this.getOtherEnd(c,i),c.incomingTag&&c.ends[0]==i&&(r=c.incomingTag),c.outgoingTag&&c.ends[1]==i&&(r=c.outgoingTag),n&&console.log("Navigating from ",a.name," through ",c.name," to ",i.name)}return{target:i,tag:r,traversedConnectors:o}},setInitialState(t){var n;null==e||null===(n=e.onaddobject)||void 0===n||n.call(e,t)},get afterRegex(){return a},get whenRegex(){return i}}),null==e||null===(n=e.onload)||void 0===n||n.call(e,t)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r,o,a,i,c=n(0);function s(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){function a(t){s(c,r,o,a,i,"next",t)}function i(t){s(c,r,o,a,i,"throw",t)}var c=t.apply(e,n);a(void 0)}))}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e,n=1;n<arguments.length;n++)e=null==arguments[n]?{}:arguments[n],n%2?u(Object(e),!0).forEach((function(n){p(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}globalThis.disableEther=!1;var f=/([^]*)\(([^)]*)\)/;class _{constructor(t,e){this.setModel(t),this.settings=e,i=e,this.nbMessagesToKeepInEther=(null==e?void 0:e.nbMessagesToKeepInEther)||0}setModel(t){this.currentModel=t,a=t,globalThis.currentModel=t}copyConfig(t){var e=Object.assign({},t);return e.currentState={},Object.entries(t.currentState).forEach(t=>{var[n,r]=t;e.currentState[n]=r.slice(0)}),e.histories={},Object.entries(t.histories).forEach(t=>{var[n,r]=t;e.histories[n]=r.slice(0)}),e.objectState={},Object.entries(t.objectState).forEach(t=>{var[n,r]=t;e.objectState[n]=d({},r),r.__EP__&&(e.objectState[n].__EP__=r.__EP__.slice(0))}),e.ether=d({},e.ether),e}get configuration(){return o}get sysHistory(){return r}set sysHistory(t){r=t}serializeConfig(t){return JSON.stringify(this.treeifyConfig(t))}treeifyConfig(t,e){function n(t){return{source:e?t.source:"[",target:t.target,signature:t.signature,tag:t.tag}}var r={currentState:{},histories:{},objectState:Object.fromEntries(Object.entries(t.objectState).map(t=>{var[e,r]=t;return[e,Object.fromEntries(Object.entries(r).sort(c.b).map(t=>{var[e,r]=t;return"__EP__"===e?[e,r.map(n)]:[e,r]}))]}).sort(c.b)),ether:Object.fromEntries(Object.entries(t.ether).map(t=>{var[e,r]=t;return[e,r.map(n)]}).sort(c.b))};return this.currentModel.objects.filter(t=>this.currentModel.isActive(t)).forEach(e=>{r.currentState[e.name]=t.currentState[e.name].map(t=>this.currentModel.stateFullName(t))}),Object.entries(t.histories||{}).forEach(t=>{var[e,n]=t;r.histories[e]=n.map(t=>this.currentModel.stateFullName(t))}),r}addToEther(t){var e;if(!disableEther)if(t.target&&"]"!==t.target&&(null===(e=this.settings)||void 0===e?void 0:e.enableEventPools)){var n=o.objectState[t.target];n.__EP__=n.__EP__||[],n.__EP__.push(t)}else{var r,a=t.signature.replace(f,"$1"),i=o.ether[a]||[];if(null===(r=this.settings)||void 0===r?void 0:r.keepOneMessagePerTrigger){var c=0==this.nbMessagesToKeepInEther?i.length:-this.nbMessagesToKeepInEther;i.slice(0,c).forEach(t=>{t.ignored=!0}),i=i.slice(c)}t.ignored=!1,i.push(t),o.ether[a]=i}}removeFromEther(t){var e=t.signature.replace(f,"$1"),n=this.getEP(t.target);if(n.some(e=>e==t))1===n.length?delete this.getObjectState(t.target).__EP__:Object(c.i)(this.getEP(t.target),t);else{var r=o.ether[e];1===r.length?delete o.ether[e]:Object(c.i)(r,t)}}getObjectState(t){return o.objectState[t]}getEP(t){return this.getObjectState(t).__EP__||[]}findMessageInEP(t,e,n){return this.getEP(e).find(e=>e.signature.replace(f,"$1")===t&&(!n||n.includes(e.tag)))}findMessage(t,e,n){t=t.replace(f,"$1");var r=this.findMessageInEP(t,e,n);if(r)return r;var a=o.ether[t];return a&&0<a.length?e?a.find(t=>"]"===t.target||t.target===e):a[0]:void 0}backToInternal(t){o=r[t].configuration,r.slice(t).forEach(t=>{t.messages.forEach(t=>{delete t.receivedAt,t.targeted||(t.target="]")})}),r=r.slice(0,t)}isActivable(t){var e=o.currentState[this.currentModel.getTransObject(t).name],n=Object(c.h)(e);return n.kind?this.currentModel.stateFullName(t.source)===this.currentModel.stateFullName(n):e.map(t=>this.currentModel.stateFullName(t)).includes(this.currentModel.stateFullName(t.source))}eventMatched(t){var e;return this.currentModel.noEventTrigger(t)||!(null!==(e=this.settings)&&void 0!==e)||!e.checkEvents||this.findMessage(t.trigger,this.currentModel.getTransObject(t).name,t.ports)}isCurrentState(t){return o.currentState[this.currentModel.getStateObject(t).name].map(t=>this.currentModel.stateFullName(t)).includes(this.currentModel.stateFullName(t))}setInitialState(t){o.currentState[t.name]=[this.currentModel.getInitial(t)]}getFireable(t,e){return e=e||(t=>this.isFireable(t)),o.currentState[t.name].flatMap(t=>(t.outgoing||[]).concat(Object.values(t.internalTransitions||{})).filter(e))}callOperation(t,e,n){var i=t.split("."),c=a.getObject(i[0]),s=i[1],l={cause:"operation:".concat(t).concat(e?":".concat(e):""),activeObject:c,configuration:this.copyConfig(o),messages:[]},u=this.findMessage(s,c.name),d=c.operationByName&&c.operationByName[s];!u||e||n?(u={source:e||(n?n.name:"["),target:autoReceiveDisabled.checked?"]":c.name,signature:"".concat(s),receivedAt:autoReceiveDisabled.checked?void 0:l,sentAt:l},l.messages.push(u),(!d||!d.method)&&this.addToEther(u)):(u.receivedAt=l,u.target=c.name,l.messages.push(u),this.removeFromEther(u)),d&&d.method&&b(d.method,l,c),r.push(l)}fireInternal(t){var e;if(this.isFireable(t)){o.histories=o.histories||{},o.objectState=o.objectState||{};var n=this.currentModel.getTransObject(t);o.objectState[n.name]=o.objectState[n.name]||{};var a={cause:"transition:".concat(this.currentModel.transFullName(t)),activeObject:n,configuration:this.copyConfig(o),messages:[]},i=o.currentState[n.name];if("shallowHistory"==t.target.kind){var s=o.histories[this.currentModel.stateFullName(t.target.region)];o.currentState[n.name]=s||this.currentModel.fullState(t.target.region)}else t.isInternal||(o.currentState[n.name]=this.currentModel.fullState(t.target));for(;0<(Object(c.h)(o.currentState[n.name]).states||[]).length;)o.currentState[n.name].push(this.currentModel.getInitial(Object(c.h)(o.currentState[n.name])));var l,u=this.currentModel.stateFullName(o.currentState[n.name][0]),d=[o.currentState[n.name][0]];o.currentState[n.name].slice(1).forEach(t=>{var e=Object(c.h)(d).states.some(t=>"shallowHistory"===t.kind);d.push(t),e&&(o.histories[u]=d.slice(0)),u+="."+t.name}),t.trigger&&((l=this.findMessage(t.trigger,n.name,t.ports))?(l.receivedAt=a,l.target=n.name,a.messages.push(l),this.removeFromEther(l)):a.messages.push({source:"[",target:n.name,signature:t.trigger,receivedAt:a}));for(var p=o.currentState[n.name].slice(),_=0;_<p.length&&_<i.length&&p[_]===i[_]&&(t.source!=p[_]||t.isInternal);_++);if(i=i.slice(_),p=p.slice(_),i.forEach(t=>{t.exit&&b(t.exit,a,n)}),l){var g=l.signature.match(f);if(g){o.objectState[n.name].__OP_NAME__=g[1];var m=g[2].split(",").map(t=>t.trim());if(o.objectState[n.name].__ARGS__=m,t.trigger.match(f)){var h=t.trigger.replace(f,"$2").trim();if(h){var v=h.split(",").map(t=>t.trim());o.objectState[n.name].__NAMED_ARGS__=Object.fromEntries(Object(c.k)(v,m.map(t=>1*t)))}}}}t.effect&&b(t.effect,a,n);var E=Object(c.h)(o.currentState[n.name]);if(E.kind||(o.objectState[n.name].__OP_NAME__=void 0,o.objectState[n.name].__ARGS__=void 0,o.objectState[n.name].__NAMED_ARGS__=void 0),p.forEach(t=>{t.entry&&b(t.entry,a,n)}),r.push(a),(null===(e=this.settings)||void 0===e?void 0:e.fireInitialTransitions)&&"initial"==E.kind){var y=E.outgoing[0];this.fireInternal(y)}return l}console.log("Tried to fire a non-fireable transition: ",this.currentModel.transFullName(t))}evalGuard(t){var e;return!("else"!=t.guard&&!(null===(e=this.settings)||void 0===e?void 0:e.considerGuardsTrue))||b(t.guard,{messages:[]},this.currentModel.getTransObject(t))}isFireable(t){return this.isActivable(t)&&this.eventMatched(t)&&(!t.guard||this.evalGuard(t))}getFireableTransitions(){var t,e=this.currentModel.objects.filter(t=>this.currentModel.isActive(t)).flatMap(t=>{var e,n,r,a=this.getFireable(t);if(null===(e=this.settings)||void 0===e?void 0:e.matchFirst){var i,c=(o.objectState[t.name].__EP__||[]).map(t=>t.signature.replace(f,"$1")),s=null===(i=(n=a.filter(t=>t.trigger),r=t=>c.indexOf(t.trigger.replace(f,"$1")),n.sort((t,e)=>{var n=r(t),o=r(e);return n<o?-1:n>o?1:0}))[0])||void 0===i?void 0:i.trigger;s&&(a=a.filter(t=>this.currentModel.noEventTrigger(t)||t.trigger===s))}return a});return(null===(t=this.settings)||void 0===t?void 0:t.reactiveSystem)&&e.some(t=>!this.currentModel.getTransObject(t).isActor)&&(e=e.filter(t=>!this.currentModel.getTransObject(t).isActor)),e}getFireables(){var t=this;return l((function*(){return t.getFireableTransitions().map(e=>t.currentModel.transFullName(e))}))()}getConfiguration(){var t=this;return l((function*(){return t.serializeConfig(o,!1)}))()}setConfiguration(t){var e=JSON.parse(t);o={currentState:Object.fromEntries(Object.entries(e.currentState).map(t=>{var[e,n]=t;return[e,n.map(t=>this.currentModel.getState(t))]})),histories:Object.fromEntries(Object.entries(e.histories).map(t=>{var[e,n]=t;return[e,n.map(t=>this.currentModel.getState(t))]})),objectState:e.objectState,ether:e.ether}}fire(t){var e=this;return l((function*(){var n=e.currentModel.getTransition(t);for(e.fireInternal(n);(null===(r=i)||void 0===r?void 0:r.autoFireAfterChoice)&&"choice"===n.target.kind;){var r,o=e.currentModel.getTransObject(n),a=e.getFireable(o);if(1!=a.length&&(a=a.filter(t=>"else"!==t.guard)),1!=a.length)throw"There should be exactly one fireable transition";n=a[0],e.fireInternal(n)}}))()}reset(){var t;r=[],o={currentState:{},histories:{},objectState:Object.fromEntries(this.currentModel.objects.map(t=>[t.name,{}])),ether:{}},this.currentModel.objects.forEach(t=>this.setInitialState(t)),(null===(t=this.settings)||void 0===t?void 0:t.fireInitialTransitions)&&this.currentModel.objects.filter(t=>this.currentModel.isActive(t)).forEach(t=>{var e=this.getFireable(t);1!==e.length&&alert("Expected only one initial transition"),"initial"!==e[0].source.kind&&alert("Expected source of initial transition to be an initial Pseudostate"),this.fireInternal(e[0])})}get modelName(){var t;return null===(t=this.currentModel)||void 0===t?void 0:t.name}get name(){return"AnimUML"}parseTransition(t){return l((function*(){return t}))()}parseConfiguration(t){return l((function*(){return t}))()}showTransition(t){var e=this;return l((function*(){var n=e.currentModel.getTransition(t);return{object:e.currentModel.getTransObject(n).name,name:n.name,source:n.source.name,target:n.target.name}}))()}showConfiguration(t){return l((function*(){return JSON.parse(t)}))()}evaluateAtom(t){return l((function*(){return b(t,{},{})}))()}}function g(t){return"__EMI__".concat(t)}function m(t){return null==t?void 0:t.replace(/__EMI__/g,"")}var h={};h={FALSE:0,TRUE:1,getters:{params(t){var e,n=o.objectState[t.name],r=n.__OP_NAME__,a=n.__ARGS__,i={},c=null===(e=t.operationByName)||void 0===e?void 0:e[r];return c&&c.parameters&&c.parameters.forEach((t,e)=>{i[t]=1*a[e]}),i}},SEND(t,e){t[e.valueOfProperty].apply(this,Array.prototype.slice.call(arguments,2))},GET(t,e){var n,r=t;if(t.name&&a.getObject(t.name)&&(r=o.objectState[t.name]),t!=this&&e.valueOfProperty){var i,c=m(t.valueOfProperty);c==(null===(i=a.getObject(c))||void 0===i?void 0:i.name)&&(r=o.objectState[c])}return null==n&&(n=r[g(e.valueOfProperty)]),null==n&&(n=!1),n},SET(t,e,n){t.name&&a.getObject(t.name)&&(t=o.objectState[t.name]),t[g(e.valueOfProperty)]=n,n||delete t[g(e.valueOfProperty)]},AT:(t,e)=>t[e],CALL(t,e){return t[e.valueOfProperty].apply(this,Array.prototype.slice(arguments,2))},INC(t,e,n){t[g(e.valueOfProperty)]+=n},DEC(t,e,n){t[g(e.valueOfProperty)]-=n,t[g(e.valueOfProperty)]||delete t[g(e.valueOfProperty)]},IS_IN_STATE(t,e){var n=o.currentState[m(t.valueOfProperty)].includes(a.getState(m(e.valueOfProperty)));return n},EP_IS_EMPTY(t){var e=m(t.valueOfProperty);e.startsWith("ROOT_")&&(e=e.replace(/^ROOT_instMain\./,"").replace(/\./g,"_"));var n=Object.values(o.ether).flatMap(t=>t.map(t=>t.target)).includes(e);return!Object(c.f)(o.objectState[e].__EP__)&&!n},EP_CONTAINS(t,e){var n,r=m(t.valueOfProperty),a=e.valueOfProperty.replace(/^SIGNAL_/,"");return null===(n=o.ether[a.replace(/^SIGNAL_/,"")])||void 0===n?void 0:n.some(t=>t.target==r)},printf(){console.log.apply(console,arguments)}};var v=/^uninitializedValue\((.*)\)$/;function b(t,e,n){function r(t){return m("function"==typeof t&&t.valueOfProperty?t.valueOfProperty:"object"==typeof t&&t.returnValueOf?t.returnValueOf.signature:JSON.stringify(t))}function c(t){var e;return t==u?"this":"object"==typeof t&&t.returnValueOf?"".concat(t.returnValueOf.signature):!t.valueOfProperty||null!==(e=i)&&void 0!==e&&e.symbolicValues?r(t):0}function s(t,i,c){if(t.valueOfProperty){var s=a.getObjectRelative(n,m(t.valueOfProperty));s&&s==a.getObject(s.name)&&(t=o.objectState[s.name],i=i.split(".")[1])}if("object"==typeof c&&c.returnValueOf){var l=c.returnValueOf;l.target=n.name;var u,d=l.signature.replace(f,"$1"),p=n.operationByName&&n.operationByName[d];p&&p.method&&(u=b(p.method,e,n)),c.returnValueOf.signature="".concat(m(i)," = ").concat(m(c.returnValueOf.signature)).concat(u?" : ".concat(r(u)):""),"function"==typeof u&&u.valueOfProperty&&(u="uninitializedValue(".concat(u.valueOfProperty,")")),u?t[i]=u:delete t[i]}else{c?t[i]=c:delete t[i];var _={source:n.name,target:n.name,signature:"".concat(m(i)," = ").concat(r(c)),sentAt:e,receivedAt:e};e.messages.push(_)}return!0}var l=n.name?o.objectState[n.name]:n,u=new Proxy(l,{get(t,r){var o;if("console"==r)return console;if(r in t||"symbol"==typeof r)return t[r];var d=l.__NAMED_ARGS__;if(null==d?void 0:d.hasOwnProperty(r))return d[r];if(h.hasOwnProperty(r)){var p=h[r];return p.bind&&p.bind(u),p}return(null===(o=h.getters)||void 0===o?void 0:o.hasOwnProperty(r))?h.getters[r].bind(u)(n):function t(r){function o(t){return"".concat(r).concat(t.match(/^[0-9]*$/)?"[".concat(t,"]"):t.match(v)?"[".concat(t.replace(v,"$1"),"]"):"."+t)}var l=function(){};return l.toString=()=>!1,l.valueOfProperty=r,new Proxy(l,{apply(t,o,i){var s,l,u=m(r.toString()),d="]",p=u.split(/\./),f=!1;2==p.length&&((s=a.getObject(p[0]))||(s=a.getObject(p[0].replace(/\[([0-9]+)\]$/,"$1")))||(s=a.getObjectRelative(n,p[0])))&&(({target:s,tag:l}=a.navigateThroughPorts(n,s,!1)),d=s.name,u=p[1],f=!0);var _={source:n.name,target:d,signature:"".concat(u,"(").concat(Array.prototype.map.call(i,c).join(", "),")"),sentAt:e};return l&&(_.tag=l),f&&(_.targeted=!0),e.messages.push(_),builtInEngine.addToEther(_),{returnValueOf:_}},get(e,n){var a;return n==Symbol.toPrimitive&&(null===(a=i)||void 0===a?void 0:a.symbolicValues)?()=>"uninitializedValue(".concat(r,")"):n in e||"symbol"==typeof n?e[n]:t(o(n))},has:(t,e)=>!0,set:(t,e,n)=>s(t,o(e),n)})}(r)},has:(t,e)=>!["console"].includes(e),set:(t,e,n)=>s(t,e,n)});return contextualEval.call(u,t)}globalThis.evalActions=b},function(t,e,n){"use strict";function r(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){function i(t){r(s,o,a,i,c,"next",t)}function c(t){r(s,o,a,i,c,"throw",t)}var s=t.apply(e,n);i(void 0)}))}}n.d(e,"a",(function(){return l}));var a={connect:(t,e)=>new Promise(n=>{var r=new WebSocket(t);r.onclose=null==e?void 0:e.onclose,r.onopen=()=>{n(new function(){function e(t){r.send(t)}function n(){return a.apply(this,arguments)}function a(){return(a=o((function*(){return new Promise(t=>{s.push(t)})}))).apply(this,arguments)}function i(t){var r=n();return e("PARSE_CONFIGURATION"),e(t),r}var c=this,s=[];r.onmessage=function(){var t=o((function*(t){var e=s.shift();e?e(t.data):console.log("Unexpected message from remote engine: %s",t.data)}));return function(){return t.apply(this,arguments)}}(),this.reset=()=>{e("RESET")},this.getConfiguration=o((function*(){var t=n();return e("GET_CONFIGURATION"),t})),this.getFireables=o((function*(){var t=n().then(function(){var t=o((function*(t){for(var e=[],r=0;r<t;r++)e.push(yield n());return e}));return function(){return t.apply(this,arguments)}}());return e("GET_FIREABLES"),t})),this.setConfiguration=t=>{e("SET_CONFIGURATION"),e(t)},this.fire=t=>{e("FIRE"),e(t)},this.parseTransition=t=>{var r=n();return e("PARSE_TRANSITION"),e(t),r},this.parseConfiguration=function(){var t=o((function*(t){return c.useHash?(t.arrayBuffer&&(t=yield t.arrayBuffer()),String.fromCharCode.apply(null,new Uint8Array(yield crypto.subtle.digest(c.useHash,t)))):yield i(t)}));return function(){return t.apply(this,arguments)}}(),this.showConfiguration=function(){var t=o((function*(t){var e=yield i(t);return JSON.parse(e)}));return function(){return t.apply(this,arguments)}}(),this.showTransition=function(){var t=o((function*(t){return JSON.parse(yield c.parseTransition(t))}));return function(){return t.apply(this,arguments)}}(),this.close=()=>{r.close()},Object.assign(this,{get modelName(){return t},get name(){return"RemoteEngine"}})})}})},i=n(0);function c(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){function a(t){c(s,r,o,a,i,"next",t)}function i(t){c(s,r,o,a,i,"throw",t)}var s=t.apply(e,n);a(void 0)}))}}var l={connect:(t,e)=>s((function*(){var n=yield a.connect(t,e);return{isFireable(){throw"unsupported"},getFireables:()=>s((function*(){return yield n.getFireables()}))(),getConfiguration:()=>s((function*(){return yield n.getConfiguration()}))(),setConfiguration:t=>s((function*(){yield n.setConfiguration(t)}))(),fire:t=>s((function*(){yield n.fire(t)}))(),reset:()=>s((function*(){yield n.reset()}))(),get modelName(){return n.modelName},get name(){return"EMI"},parseTransition:t=>s((function*(){return yield n.parseTransition(t)}))(),parseConfiguration:t=>s((function*(){var e=yield n.parseConfiguration(t);return e=function(t){return function t(e,n){if(e.hasOwnProperty("value"))n[e.name]=e.value;else{if(!e.children)throw console.log("Cannot convert EMI configuration node (it has neither value nor children):",e),"Cannot convert EMI configuration node";var r={};n[e.name]=r,e.children.forEach(e=>{t(e,r)})}return n}(JSON.parse(t),{})}(e),JSON.stringify(function(t){return{currentState:Object.fromEntries(Object.entries(t.store).filter(t=>{var[e,n]=t;return n.cs}).map(t=>{var[e,n]=t;return[e=e.replace(/^instMain_/,""),["".concat(e,".").concat(n.cs)]]})),histories:{},objectState:Object.fromEntries(Object.entries(t.store).filter(t=>{var[e,n]=t;return e.startsWith("instMain_")&&currentModel.getObject(e.replace(/^instMain_/,""))}).map(t=>{var e,[n,r]=t;return[n=n.replace(/^instMain_/,""),Object.fromEntries(Object.entries(r.od||{}).filter(t=>{var[e,n]=t;return 0!=JSON.parse(n)}).map(t=>{var[e,n]=t;return["__EMI__".concat(e),JSON.parse(n)]}).concat(1*(null===(e=r.ep)||void 0===e?void 0:e.nbEvents)?[["__EP__",Object.values(r.ep.eventOccurred).slice(0,r.ep.nbEvents).map((t,e)=>({source:"[",target:n,signature:"".concat(t.signalEventId.replace(/_SE$/,""),"(").concat(r.ep_params?Object.values(Object.values(r.ep_params.eventOccurred)[e].union["".concat(t.signalEventId.replace(/_SE$/,""),"_params")]||{}).join(", "):"",")"),tag:"(no port)"===t.portId?void 0:t.portId}))]]:[]).sort(i.b))]}).sort(i.b)),ether:{}}}(e))}))(),showConfiguration(t){var e=this;return s((function*(){var n=yield e.parseConfiguration(t);return JSON.parse(n)}))()},showTransition:t=>s((function*(){var e=(yield n.showTransition(t))[0];return{object:e.activeObject.replace(/^instMain_/,""),name:e.transitions[0],source:e.source,target:e.target}}))(),close(){n.close()}}}))()}},function(t,e,n){n(20),t.exports=n(21)},function(t,e){!function(e){"use strict";var n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",s="object"==typeof t,l=e.regeneratorRuntime;if(l)s&&(t.exports=l);else{(l=e.regeneratorRuntime=s?t.exports:{}).wrap=g;var u={},d={};d[a]=function(){return this};var p=Object.getPrototypeOf,f=p&&p(p(k([])));f&&f!==n&&r.call(f,a)&&(d=f);var _=b.prototype=h.prototype=Object.create(d);v.prototype=_.constructor=b,b.constructor=v,b[c]=v.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(_),t},l.awrap=function(t){return{__await:t}},E(y.prototype),y.prototype[i]=function(){return this},l.AsyncIterator=y,l.async=function(t,e,n,r){var o=new y(g(t,e,n,r));return l.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(_),_[c]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;M(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:k(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}}}function g(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,a=Object.create(o.prototype),i=new T(r||[]);return a._invoke=function(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return P()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=O(i,n);if(c){if(c===u)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=m(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===u)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(t,n,i),a}function m(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function h(){}function v(){}function b(){}function E(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t){var e;this._invoke=function(n,o){function a(){return new Promise((function(e,a){!function e(n,o,a,i){var c=m(t[n],t,o);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,a,i)}),(function(t){e("throw",t,a,i)})):Promise.resolve(l).then((function(t){s.value=t,a(s)}),i)}i(c.arg)}(n,o,e,a)}))}return e=e?e.then(a,a):a()}}function O(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=m(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"testExport",(function(){return testExport})),__webpack_require__.d(__webpack_exports__,"testComparedExecutions",(function(){return testComparedExecutions})),__webpack_require__.d(__webpack_exports__,"sysHistoryEngine",(function(){return sysHistoryEngine})),__webpack_require__.d(__webpack_exports__,"toggle",(function(){return toggle})),__webpack_require__.d(__webpack_exports__,"disconnectFromEMI",(function(){return disconnectFromEMI})),__webpack_require__.d(__webpack_exports__,"disconnectFromTool",(function(){return disconnectFromTool})),__webpack_require__.d(__webpack_exports__,"backTo",(function(){return backTo})),__webpack_require__.d(__webpack_exports__,"fire",(function(){return fire})),__webpack_require__.d(__webpack_exports__,"emiFire",(function(){return emiFire})),__webpack_require__.d(__webpack_exports__,"exportDynamicSymbols",(function(){return exportDynamicSymbols}));var _Export2tUML_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9),_Export2C_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),_RemoteTool_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11),_EMIRemoteEngine_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18),_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3),_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),_TransformStateMachine2Explicit_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8),_History2PlantUMLTiming_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(12),_History2PlantUMLSequence_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(13),_PlantUMLURI_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(14),_ExportUtils_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1),_Utils_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(0);__webpack_require__.d(__webpack_exports__,"diffInternal",(function(){return _Utils_js__WEBPACK_IMPORTED_MODULE_11__.a}));var _DiffExplorer_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(15),_TestCases_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(22),_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(4),_Editor_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(5),_Model_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(16),_AnimUMLEngine_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(17);function asyncGeneratorStep(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){function a(t){asyncGeneratorStep(c,r,o,a,i,"next",t)}function i(t){asyncGeneratorStep(c,r,o,a,i,"throw",t)}var c=t.apply(e,n);a(void 0)}))}}__webpack_require__.d(__webpack_exports__,"last",(function(){return _Utils_js__WEBPACK_IMPORTED_MODULE_11__.h}));var startAndNoExportAtEOF=!0;function start(){if(doExportSymbols(),document.location.hash)try{var t=JSON.parse(decodeURIComponent(document.location.hash.slice(1)));t.name="Imported_".concat(t.name.replace(/^Imported_/,"")),t=Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t),examples.unshift(t)}catch(t){throw console.log("Error importing model from URL: %s",t),t}init(),window.builtInEngine=new _AnimUMLEngine_js__WEBPACK_IMPORTED_MODULE_17__.a(void 0,{get checkEvents(){return checkEvents.checked},get enableEventPools(){return enableEventPools.checked},get keepOneMessagePerTrigger(){return keepOneMessagePerTrigger.checked},get fireInitialTransitions(){return fireInitialTransitions.checked||Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.b)()},get autoFireAfterChoice(){return autoFireAfterChoice.checked||Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.b)()},get considerGuardsTrue(){return considerGuardsTrue.checked},get matchFirst(){return matchFirst.checked},get reactiveSystem(){return reactiveSystem.checked},get symbolicValues(){return symbolicValues.checked}}),window.engine=builtInEngine,loadFirstValidExample()}var plantumlServer="www.plantuml.com";plantumlServer=location.host;var plantumlPrefix="/plantuml/",pu=document.location.protocol+"//"+plantumlServer+plantumlPrefix,wsHost=document.location.hostname,wsProt=document.location.protocol.match(/https/)?"wss":"ws",wsPort=0==document.location.port.length?"":":".concat(document.location.port);toolURL.value="".concat(wsProt,"://").concat(wsHost).concat(wsPort,"/obp2");var emiURLPrefix="".concat(wsProt,"://").concat(wsHost).concat(wsPort,"/emi");emiURL.value="".concat(emiURLPrefix,"/LevelCrossing.emi/");var currentModel,defaultsToAllObjects=!0,testCSSAnimation=!1,colors={currentStateColor:"lightgreen",fireableTransitionColor:"green",noEventColor:"red",falseGuardColor:"red"},editing=!1;window.displayedObjects=void 0;var participants,callPrefix="",objectSelect=document.getElementById("objectSelect"),ALL_OBJECTS="All objects";function getObjectSelectIndex(t){return currentModel.objects.map(t=>t.name).indexOf(t)+(defaultsToAllObjects?1:0)}function switchToObject(t){objectSelect.selectedIndex=getObjectSelectIndex(t),displayedObjects=[currentModel.getObject(t)],Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.c)(currentModelWrapper),updateFig()}objectSelect.onchange=()=>{var t=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.e)(objectSelect);t==ALL_OBJECTS?(displayedObjects=currentModel.objects.slice(),Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.c)(currentModelWrapper),updateFig()):switchToObject(t)};var currentModelWrapper,oldCurrentModelWrapper={},changeSVGLinksIntoListeners=!1;function load(){return _load.apply(this,arguments)}function _load(){return(_load=_asyncToGenerator((function*(t){function e(t){if(t.loop)for(var n=0;n<t.loop;n++)t.causes.forEach(e);else{var r=t.split(":");switch(r[0]+""){case"transition":fire(r[1]);break;case"operation":builtInEngine.callOperation(r[1],r[2]);break;case"PlantUML":builtInEngine.sysHistory.push({cause:t,PlantUML:r.slice(1).join(":")});break;default:console.log("Unknown history step cause: ".concat(r[0]," in ").concat(t))}}}var n=t.historyCauses;if(t=new _Model_js__WEBPACK_IMPORTED_MODULE_16__.a(t,{onload(){},onaddobject(t){builtInEngine.setInitialState(t)}}),currentModel=t,currentModelWrapper=t,builtInEngine.setModel(t),displayedObjects=defaultsToAllObjects?currentModel.objects.slice():[currentModel.objects[0]],participants=currentModel.objects.slice(),editor.setModel(t),checkEvents.checked=1<t.objects.length,emiURL.value="".concat(emiURLPrefix,"/").concat(t.name.replace(/^(Imported_)?(UML2AnimUML_)?/,""),".emi/"),updateObjects(),updateExport(t),Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.c)(t),t.settings){var r,o=t.settings.interface,a=t.settings.display,i=t.settings.semantics;if(o){if(o.iframe&&(callPrefix="get('".concat(o.iframe,"').")),o.disableModelSelection&&(hide(modelSelection),t.name=t.name.replace(/^Imported_/,""),t.objects[0].name=t.objects[0].name.replace(/^Imported_/,"")),o.disableObjectSelection&&hide(objectSelection),o.disableDoc&&hide(docButton),o.disableSettings&&hide(settingsButtons),o.disableExports&&(hide(modelExports),hide(historyExports)),o.disableEdit&&hide(editButton),o.load){var c;if(o.load.match(/^#/)){var s=o.load.replace(/^#/,"");try{c=parent.getModel(s).innerText}catch(t){o.iframe&&(callPrefix="",changeSVGLinksIntoListeners=!0),c=yield new Promise(t=>{window.onmessage=e=>{switch(e.data.reply+""){case"getModel":t(e.data.model);break;default:console.log("Unexpected message: ",e)}},parent.postMessage({action:"getModel",id:s},"*")})}c=JSON.parse(c)}else c=examples.find(t=>t.name==o.load);t.settings.overrides&&Object.entries(t.settings.overrides).forEach(t=>{var[e,n]=t,r=c.objects.findIndex(t=>t.name===e);c.objects[r]=n}),!n&&t.objects[0].historyCauses&&(n=t.objects[0].historyCauses);var l,u=t;if(t=yield load(c),n&&(t.historyCauses=n),u.settings.defaultToolValues)t.settings.defaultToolValues=(null===(l=t.settings)||void 0===l?void 0:l.defaultToolValues)||{},Object.assign(t.settings.defaultToolValues,u.settings.defaultToolValues)}o.displayedObjects&&(displayedObjects=o.displayedObjects.map(e=>t.getObject(e)),participants=displayedObjects.slice(0),1==displayedObjects.length&&(objectSelect.selectedIndex=getObjectSelectIndex(displayedObjects[0].name)))}a&&(hideClasses.checked=a.hideClasses,hideStates.checked=a.hideStates,hideMethods.checked=a.hideMethods,hideStateMachines.checked=a.hideStateMachines,showPseudostateInvariants.checked=a.showPseudostateInvariants,showPorts.checked=a.showPorts,showExplicitSM.checked=a.showExplicitSM),i&&(fireInitialTransitions.checked=i.fireInitialTransitions,autoFireAfterChoice.checked=i.autoFireAfterChoice,autoReceiveDisabled.checked=i.autoReceiveDisabled,considerGuardsTrue.checked=i.considerGuardsTrue,checkEvents.checked=i.checkEvents,keepOneMessagePerTrigger.checked=i.keepOneMessagePerTrigger,enableEventPools.checked=i.enableEventPools,matchFirst.checked=i.matchFirst,symbolicValues.checked=i.symbolicValues,reactiveSystem.checked=i.reactiveSystem),(null===(r=t.settings)||void 0===r?void 0:r.defaultToolValues)&&(globalThis.defaultToolValues=t.settings.defaultToolValues)}return builtInEngine.reset(),(t.historyCauses||[]).forEach(t=>{e(t)}),updateFig(),t}))).apply(this,arguments)}function updateObjects(){objectSelect.innerHTML="",defaultsToAllObjects&&addOption(objectSelect,ALL_OBJECTS),currentModel.objects.forEach(t=>{addOption(objectSelect,t.name)}),objectSelect.selectedIndex=1<displayedObjects.length?0:currentModel.objects.indexOf(displayedObjects[0])+0}function switchExample(t){load(examples.find(e=>e.name==t))}resetButton.onclick=()=>{builtInEngine.reset(),updateFig()};var editor,exampleSelect=document.getElementById("exampleSelect");function init(){editor=new _Editor_js__WEBPACK_IMPORTED_MODULE_15__.a,Object(_Editor_js__WEBPACK_IMPORTED_MODULE_15__.b)(currentModelWrapper),examples.forEach(t=>{addExample(t)}),exampleSelect.onchange=()=>{switchExample(Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.e)(exampleSelect))}}function toggle(t,e){"none"==t.style.display?show(t,e):hide(t)}function hide(t){t.style.display="none"}function show(t,e){t.style.display=e||""}function firstToUpper(t){return t[0].toUpperCase()+t.slice(1)}var checkEvents=document.getElementById("checkEvents");function fire(t){builtInEngine.fireInternal(currentModel.getTransition(t)),updateFig()}function setSender(t){globalThis.sender=currentModel.getObject(t)}function callOperation(t,e){builtInEngine.callOperation(t,e,globalThis.sender),updateFig(),globalThis.sender=void 0}function edit(){editing?(editing=!1,editBlock.style="display: none",seqDiag.style="width: 45%; float: right",inputBlock.style="display: none"):(editing=!0,editBlock.style="display: inline",seqDiag.style="display: none"),updateFig()}function toPlantUMLCom(){return"\n\t\tobject\n\t"}function stateOfIn(t,e){return e.configuration.currentState[t.name]}checkEvents.onchange=()=>updateFig(),considerGuardsTrue.onchange=updateFig,globalThis.sender=void 0,showExplicitSM.onchange=updateFig;var timingScaleDiv=document.getElementById("timingScaleDiv"),timingScale=document.getElementById("timingScale");function backTo(t){builtInEngine.backToInternal(t),updateFig()}timingScale.onchange=()=>{updateHistoryFig()},showPseudostateInvariants.onchange=()=>updateFig();var noCache=0;function updateOneFig(t,e,n){var r;testCSSAnimation&&!editing&&currentModel.name.endsWith("BoutonLampe")&&"state"===e&&(r="".concat(document.location.origin,"/BoutonLampe.svg")),testCSSAnimation&&!editing&&currentModel.name.endsWith("PubliphoneV6")&&"state"===e&&(r="".concat(document.location.origin,"/PubliphoneV6.svg")),r=Object(_PlantUMLURI_js__WEBPACK_IMPORTED_MODULE_9__.a)(pu,t())+"?nocache=1";var o=document.getElementById("".concat(e,"Figo"));o.data!==r&&(o.data=r);var a,i=document.getElementById("".concat(e,"PlantUML"));i.href="#clickLinkToUpdateIt",i.onclick=()=>{i.href=a=a||(n?Object(_PlantUMLURI_js__WEBPACK_IMPORTED_MODULE_9__.a)(pu,n()):r).replace(/svg/,"uml")}}var withAnnotations=document.getElementById("plantUMLType");withAnnotations.checked&&show(forAnimationDiv,"inline"),withAnnotations.onchange=()=>{updateFig(),toggle(forAnimationDiv,"inline")},forAnimation.onchange=()=>{updateFig()};var historyType=document.getElementById("historyType");function updateHistoryFig(){"sequence"==Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.e)(historyType)?(updateOneFig(()=>Object(_History2PlantUMLSequence_js__WEBPACK_IMPORTED_MODULE_8__.a)(sysHistory,currentModelWrapper,currentEngine,{stateOfIn:stateOfIn,ALL_OBJECTS:ALL_OBJECTS,configuration:builtInEngine.configuration,callPrefix:callPrefix,participants:participants,colors:colors,hideStates:hideStates.checked}),"seq",()=>Object(_History2PlantUMLSequence_js__WEBPACK_IMPORTED_MODULE_8__.a)(sysHistory,currentModelWrapper,currentEngine,{stateOfIn:stateOfIn,ALL_OBJECTS:ALL_OBJECTS,configuration:builtInEngine.configuration,callPrefix:callPrefix,participants:participants,colors:colors,raw:!withAnnotations.checked,hideStates:hideStates.checked})),timingScaleDiv.style="display: none;"):(updateOneFig(()=>Object(_History2PlantUMLTiming_js__WEBPACK_IMPORTED_MODULE_7__.a)(sysHistory,!1,currentModelWrapper,{stateOfIn:stateOfIn,callPrefix:callPrefix}),"seq",()=>Object(_History2PlantUMLTiming_js__WEBPACK_IMPORTED_MODULE_7__.a)(sysHistory,!withAnnotations.checked,currentModelWrapper,{stateOfIn:stateOfIn,callPrefix:callPrefix})),timingScaleDiv.style="display: inline;")}historyType.onchange=()=>updateFig();var hideClasses=document.getElementById("hideClasses"),hideStateMachines=document.getElementById("hideStateMachines"),stateFigoStyle;function updateFig(){if(testCSSAnimation&&(currentModel.name.endsWith("BoutonLampe")||currentModel.name.endsWith("PubliphoneV6"))){function stateId(t){return"initial"===t.kind?"*start*".concat(stateFullName(t.region)):stateFullName(t)}function transId(t){return"".concat(stateId(t.source),"->").concat(stateId(t.target)).replace(/([*.>])/g,"\\$1")}function allTransitions(t){return(t.transitions||[]).concat((t.states||[]).flatMap(allTransitions))}function updateState(){if(!editing){var t=Object.entries(configuration.currentState).flatMap(t=>{var[e,n]=t;return n.map(t=>"\n\t\t\t\t\t#".concat(t.name," > rect {\n\t\t\t\t\t\tfill: ").concat(colors.currentStateColor,";\n\t\t\t\t\t}\n\t\t\t\t"))}).join("")+"\n\t\t\t\ta > text {\n\t\t\t\t\tfill: black; text-decoration: none;\n\t\t\t\t}\n\t\t\t"+currentModel.objects.flatMap(allTransitions).filter(isFireable).map(t=>"\n\t\t\t\t#".concat(transId(t)," {\n\t\t\t\t\tstroke: ").concat(colors.fireableTransitionColor," !important;\n\t\t\t\t}\n\t\t\t\t#").concat(transId(t)," + polygon {\n\t\t\t\t\tfill: ").concat(colors.fireableTransitionColor,";\n\t\t\t\t\tstroke: ").concat(colors.fireableTransitionColor," !important;\n\t\t\t\t}\n\t\t\t\t#").concat(transId(t)," + polygon + a > text {\n\t\t\t\t\tfill: #0000EE; text-decoration: underline;\n\t\t\t\t}\n\t\t\t")).join("");stateFigoStyle.textContent=t}}if(stateFigoStyle)updateState();else{var obj=document.getElementById("stateFigo");obj.onload=()=>{var t=obj.contentDocument.getElementsByTagName("svg")[0],e=document.createElement("style");t.appendChild(e),stateFigoStyle=e,updateState()}}}updateOneFig(()=>Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.a)(!1,!1,currentModelWrapper,currentEngine,{displayedObjects:displayedObjects,editing:editing,callPrefix:callPrefix,colors:colors}),"state",()=>Object(_Export2PlantUML_js__WEBPACK_IMPORTED_MODULE_5__.a)(!withAnnotations.checked,forAnimation.checked,currentModelWrapper,currentEngine,{displayedObjects:displayedObjects,editing:editing,callPrefix:callPrefix,colors:colors})),updateHistoryFig(),changeSVGLinksIntoListeners&&(document.getElementById("stateFigo").onload=document.getElementById("seqFigo").onload=e=>{var _loop=function(link){var url=link.href.baseVal;url.startsWith("javascript:")&&(link.onclick=()=>{eval(url.replace(/^javascript:get\([^)]*\)\./,""))},link.href.baseVal="javascript:")};for(var link of e.target.contentDocument.getElementsByTagName("a"))_loop(link)})}hideClasses.onchange=updateFig,hideStateMachines.onchange=updateFig,hideMethods.onchange=updateFig,showPorts.onchange=updateFig,showEndNames.onchange=updateFig;var exportLink=document.getElementById("export");function updateExport(t){function e(t,e){return JSON.stringify(t,void 0,e).replace(/%/g,"%25")}function n(){return o=o||Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.a)(currentModel)}function r(){var e=n();if(sysHistory&&((e=Object.assign({},e)).historyCauses=sysHistory.map(t=>t.cause),fireInitialTransitions.checked)){var r=/^transition:/;e.historyCauses=e.historyCauses.filter(e=>!e.match(r)||"initial"!==t.getTransition(e.replace(r,"")).source.kind)}return function(t){var e={interface:{displayedObjects:displayedObjects.map(t=>t.name)},display:{hideClasses:hideClasses.checked,hideMethods:hideMethods.checked,hideStateMachines:hideStateMachines.checked,showPseudostateInvariants:showPseudostateInvariants.checked,showPorts:showPorts.checked},semantics:{fireInitialTransitions:fireInitialTransitions.checked,autoFireAfterChoice:autoFireAfterChoice.checked,autoReceiveDisabled:autoReceiveDisabled.checked,considerGuardsTrue:considerGuardsTrue.checked,checkEvents:checkEvents.checked,keepOneMessagePerTrigger:keepOneMessagePerTrigger.checked,enableEventPools:enableEventPools.checked,matchFirst:matchFirst.checked,symbolicValues:symbolicValues.checked,reactiveSystem:reactiveSystem.checked}};t.settings=e}(e),e}var o=null;exportLink.href="#clickLinkToUpdateIt",exportPretty.href="#clickLinkToUpdateIt",exportLink.onclick=()=>{exportLink.href="".concat(document.location.toString().replace(/#.*$/,""),"#").concat(e(n()))},exportPretty.onclick=()=>{exportPretty.download="".concat(currentModel.name,".js"),exportPretty.href="data:text/plain,".concat(encodeURIComponent(e(n(),2)))},histExport.href="#clickLinkToUpdateIt",histExport.onclick=()=>{histExport.href="".concat(document.location.toString().replace(/#.*$/,""),"#").concat(e(r()))},histExportPretty.href="#clickLinkToUpdateIt",histExportPretty.onclick=()=>{histExportPretty.download="".concat(currentModel.name,"-withHistory.js"),histExportPretty.href="data:text/plain,".concat(encodeURIComponent(e(r(),2)))};var a=null;tUMLExport.href="#clickLinkToUpdateIt",tUMLExport.onclick=()=>{tUMLExport.download="".concat(currentModel.name,".tuml"),tUMLExport.href="data:text/plain,".concat(encodeURIComponent(a=a||Object(_Export2tUML_js__WEBPACK_IMPORTED_MODULE_0__.a)(currentModelWrapper)))},window.cExport&&(cExport.href="#clickLinkToUpdateIt",cExport.onclick=()=>{cExport.download="".concat(currentModel.name,".tar.gz");var t=Object(_Export2C_js__WEBPACK_IMPORTED_MODULE_1__.a)(currentModelWrapper);t=pako.gzip(t,{level:9,to:"string"}),t=btoa(t),cExport.href="data:text/plain".concat(";base64",",").concat(encodeURIComponent(t))})}function diff(t,e,n,r){console.log("Expected: ",t,", actual: ",e),console.log("\t",n),console.log("\t",r);var o=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.a)(n,r);console.log("\t",o[0]),console.log("\t",o[1])}function testExportWithoutBuild(t){examples.slice(1).filter(e=>!t||e.name===t).forEach(t=>{var e=t.objects||t.connectorByName?Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.a)(t):Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t),n=JSON.stringify(t),r=JSON.stringify(e),o=n===r;console.log("A: %s",o),o||(diff(t,e,n,r),(t.objects||[]).forEach(t=>{var e=JSON.stringify(t),n=JSON.stringify(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t)),r=e===n;r||(console.log("\tA.".concat(t.name,": %s"),r),console.log("\t\t",e),console.log("\t\t",n),t.operationByName&&console.log("\t\tOperations of ".concat(t.name,": "),JSON.stringify(Object.entries(t.operationByName))===JSON.stringify(Object.entries(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t).operationByName))),t.stateByName&&console.log("\t\tStates of ".concat(t.name,": "),JSON.stringify(Object.entries(t.stateByName))===JSON.stringify(Object.entries(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t).stateByName))),t.transitionByName&&console.log("\t\tTransitions of ".concat(t.name,": "),JSON.stringify(Object.entries(t.transitionByName))===JSON.stringify(Object.entries(Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(t).transitionByName))))}),t.connectorByName&&console.log("\tConnectors: ",JSON.stringify(Object.entries(t.connectorByName))===JSON.stringify(Object.entries(e.connectorByName))),t.operationByName&&console.log("\tOperations: ",JSON.stringify(Object.entries(t.operationByName))===JSON.stringify(Object.entries(e.operationByName))))})}function testExportAfterBuild(){examples.slice(0).forEach(t=>{function e(t){return t.objects||t.connectorByName?Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.a)(Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t)):Object(_Export2AnimUML_js__WEBPACK_IMPORTED_MODULE_4__.b)(Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t))}var n=JSON.stringify(t),r=e(t),o=JSON.stringify(r),a=n===o;a||diff(t,r,n,o);var i=e(t),c=n===JSON.stringify(i);a&&c||console.log("B(".concat(t.name,") : %s, C: %s"),a,c)})}function testExport(){testExportWithoutBuild(),testExportAfterBuild()}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function b64encode(t){for(var e="",n=0;n+2<t.length;n+=3){var r=t[n],o=t[n+1],a=t[n+2];e+=b64chars[r>>2],e+=b64chars[63&r<<4|o>>4],e+=b64chars[63&o<<2|a>>6],e+=b64chars[63&a]}switch(t.length%3){case 1:var i=t[t.length-1];e+=b64chars[i>>2],e+=b64chars[63&i<<4],e+="==";break;case 2:i=t[t.length-2];var c=t[t.length-1];e+=b64chars[i>>2],e+=b64chars[63&i<<4|c>>4],e+=b64chars[63&c<<2],e+="="}return e}function Blob2TextEngine(t){Object.assign(this,{isFireable:e=>t.isFireable(e),getFireables:()=>t.getFireables().then(function(){var t=_asyncToGenerator((function*(t){var e=[];for(f of t)e.push(yield f.text());return e}));return function(){return t.apply(this,arguments)}}()),getConfiguration:()=>t.getConfiguration().then(t=>t.arrayBuffer()).then(t=>b64encode(new Uint8Array(t))),setConfiguration(e){console.log(JSON.stringify(e)),fetch(e).then(t=>t.blob()).then(e=>{console.log(e),t.setConfiguration(e)})},fire(e){t.fire(new Blob([e]))},reset(){t.reset()},get modelName(){return t.modelName},get name(){return t.name},parseTransition:e=>t.parseTransition(e),parseConfiguration:e=>t.parseConfiguration(e),convertConfiguration:t=>convertEMI2AnimUML(t),disconnect:()=>t.disconnect()})}function addToolControl(t,e){var n=new _RemoteTool_js__WEBPACK_IMPORTED_MODULE_2__.b("".concat(t,"/control"));n.askCommands().then(t=>{analysisCommands.innerHTML='\n\t\t\tCommands:\n\t\t\t<ul id="toolCommands">\n\t\t\t</ul>\n\t\t',t.forEach(t=>{function r(n){return"".concat(e,".").concat(t[0],".").concat(n)}var o=document.createElement("a");o.innerHTML=t[0],o.href="javascript:",o.onclick=()=>{var o=t.slice(1).map(t=>{var e,n=t.split(":"),o=document.getElementById(r(n[0]));switch(n[1]+""){case"bool":e=o.checked;break;default:e=o.value}return e});analysisTool.setEngine(engine),n.sendCommand(t[0],e,...o)};var a=document.createElement("li");if(a.appendChild(o),1<t.length){var i=document.createElement("span");a.appendChild(i),i.innerHTML+="(".concat(t.slice(1).map(e=>{var n,o=e.split(":");return"".concat(o[0],' = <input id="').concat(r(o[0]),'" ').concat("bool"===o[1]?'type="checkbox"':"",' value="').concat((null===(n=globalThis.defaultToolValues)||void 0===n?void 0:n["".concat(t[0],".").concat(e)])||"",'"}/>')}).join(", "),")")}toolCommands.appendChild(a)})}).catch(t=>console.log(t))}var analysisTool,toolOkListener=()=>{var t=toolURL.value;onToolConnect(),analysisTool=new _RemoteTool_js__WEBPACK_IMPORTED_MODULE_2__.a(t,{onuuid(e){addToolControl(t,e)},onclose(){disconnectFromTool()},onresults(t){analysisOutput.innerText=t,updateFig()},onprogress(t){analysisOutput.innerText=t},ongetconfig:()=>new Promise(t=>{setTimeout(t,toolDelay.value),toolAnimation.checked&&updateFig()})})};function disconnectFromTool(){debugAnalysis.checked&&console.log("Disconnecting from analysis tool"),show(connectToToolLI),hide(disconnectFromToolLI),analysisTool.close()}function onToolConnect(){analysisOutput.innerText="Not output from analysis tool yet",analysisCommands.innerText="Not available command yet",hide(connectToToolLI),show(disconnectFromToolLI)}function disconnectFromEMINew(){var t;debugEMI.checked&&console.log("Disconnecting from EMI"),show(connectToEMI),hide(disconnectFromEMILI),"EMI"===(null===(t=engine)||void 0===t?void 0:t.name)&&engine.close(),engine=builtInEngine,updateFig()}toolOk.onclick=toolOkListener,toolURL.onkeypress=t=>{13===t.keyCode&&toolOkListener(t)};var emiOkListenerNew=function(){var t=_asyncToGenerator((function*(t){hide(connectToEMI),emiFireables.innerText="",emiConnectedURL.innerText=emiURL.value.replace(/^[^:]+:\/\/[^\/]+\/emi\//,"").replace(/\.emi\/$/,""),show(disconnectFromEMILI);var e=yield _EMIRemoteEngine_js__WEBPACK_IMPORTED_MODULE_3__.a.connect(emiURL.value,{onclose:disconnectFromEMI});emiAnimation.checked?(engine={isFireable(){throw"unsupported"},getFireables(){var t=this;return _asyncToGenerator((function*(){var n=yield e.getFireables();if(emiAnimation.checked){for(var r of(emiFireables.innerText="",emiFireableBlobs.splice(0,emiFireableBlobs.length),emiFireableBlobsIndex=0,n))yield t.parseTransition(r);emiFireableBlobs.push(...n)}return n}))()},getConfiguration(){var t=this;return _asyncToGenerator((function*(){var n=yield e.getConfiguration();return emiAnimation.checked&&(yield t.parseConfiguration(n)),n}))()},setConfiguration:t=>_asyncToGenerator((function*(){yield e.setConfiguration(t)}))(),fire:t=>_asyncToGenerator((function*(){yield e.fire(t)}))(),reset:()=>_asyncToGenerator((function*(){yield e.reset()}))(),get modelName(){return e.modelName},get name(){return e.name},parseTransition:t=>_asyncToGenerator((function*(){var n=yield e.parseTransition(t);if(emiAnimation.checked){var r=n;if(debugEMI.checked){var o=JSON.parse(r)[0].activeObject.replace(/.*_/,""),a=JSON.parse(r)[0].source,i=JSON.parse(r)[0].target,c=JSON.parse(r)[0].transitions[0];a===i&&(c="".concat(a,".__internal__").concat(c,"__")),""===c&&(c="".concat(a,"2").concat(i,"_<idx>")),c="".concat(o,".").concat(c),console.log("%s => %o",c,getTransition(c))}var s=document.createElement("a");s.innerText=r,s.href="javascript:".concat(callPrefix,"emiFire(").concat(emiFireableBlobsIndex,")"),emiFireableBlobsIndex++;var l=document.createElement("li");l.appendChild(s),emiFireables.appendChild(l)}return n}))(),parseConfiguration:()=>_asyncToGenerator((function*(){var t=yield e.parseConfiguration(n);if(emiAnimation.checked){var n=JSON.parse(t);debugEMI.checked&&console.log(n),currentModel.objects.filter(isActive).forEach(t=>{if(n.children){if(i=n.children.find(e=>e.name.endsWith("_".concat(t.name)))){var e=(l=i,u="cs",l.children.find(t=>t.name===u)).value,r="".concat(t.name,".").concat(e);configuration.currentState[t.name]=fullState(getState(r))}else console.log("Could not find object %s in EMI configuation",t.name)}else if(n.currentState){var o=n.currentState[t.name];o?configuration.currentState[t.name]=fullState(getState(o[0])):console.log("Could not find object %s in EMI configuation",t.name)}else{var a,i;if(i=null===(a=Object.entries(n).find(t=>{var[e,n]=t;return e.endsWith("_".concat(n.name))}))||void 0===a?void 0:a.object){var c=i.cs,s="".concat(t.name,".").concat(c);configuration.currentState[t.name]=fullState(getState(s))}else console.log("Could not find object %s in EMI configuation",t.name)}var l,u}),updateFig()}return t}))(),showConfiguration:t=>_asyncToGenerator((function*(){return yield e.showConfiguration(t)}))(),showTransition:t=>_asyncToGenerator((function*(){return yield e.showTransition(t)}))(),close(){e.close()}},yield engine.getConfiguration(),yield engine.getFireables()):engine=e,"function"==typeof t&&t(engine)}));return function(){return t.apply(this,arguments)}}(),emiFireableBlobs=[],emiFireableBlobsIndex=0,emiWS,emiState;function emiFireNew(){return _emiFireNew.apply(this,arguments)}function _emiFireNew(){return(_emiFireNew=_asyncToGenerator((function*(t){var e=emiFireableBlobs[t];yield engine.fire(e),yield engine.getConfiguration(),yield engine.getFireables()}))).apply(this,arguments)}function emiSend(t){debugEMI.checked&&console.log("Sending to EMI: ",t),emiWS.send(t)}var emiOkListener=emiOkListenerNew,disconnectFromEMI=disconnectFromEMINew,emiFire=emiFireNew;emiOk.onclick=emiOkListener,emiURL.onkeypress=t=>{13===t.keyCode&&emiOkListener(t)};var currentEngine={isFireable:t=>builtInEngine.isFireable(t),getTransURI:(t,e,n)=>"javascript:".concat(callPrefix).concat(t,"('").concat(encodeURIComponent(currentModel.transFullName(e)),"'").concat(n?",'".concat(n,"'"):"",")"),getFireURI(t){return this.getTransURI("fire",t)},isCurrent:t=>builtInEngine.isCurrentState(t),isActivable:t=>builtInEngine.isActivable(t),eventMatched:t=>builtInEngine.eventMatched(t),getFireable:(t,e)=>builtInEngine.getFireable(t,e),findMessage:(t,e,n)=>builtInEngine.findMessage(t,e,n)},sysHistoryEngine={isFireable(t){isFireable(t)},getFireables:()=>Promise.resolve(builtInEngine.getFireables().map(transFullName)),getConfiguration(){var t=serializeConfig(configuration);return Promise.resolve(t)},setConfiguration(t){if(t!==serializeConfig(configuration)){var e=this.hist.indexOf(t);0>e&&console.log("Cannot find this configuration in sysHistory: ",t),backToInternal(e);var n=serializeConfig(configuration);console.assert(t===n,"After backTo(",e,"), should be in ",JSON.parse(t)," but is in ",JSON.parse(n),"\n\texpected:\t",t,"\n\tactual:\t\t",n),this.hist.splice(e,this.hist.length),console.assert(this.hist.length==sysHistory.length)}},fire(t){this.hist.push(serializeConfig(configuration));var e=getTransition(t);for(fireInternal(e);this.autoFireAfterChoice&&"choice"===e.target.kind;){var n=getTransObject(e),r=getFireable(n);if(1!=r.length&&(r=r.filter(t=>"else"!==t.guard)),1!=r.length)throw"There should be exactly one fireable transition";e=r[0],this.hist.push(serializeConfig(configuration)),fireInternal(e)}},reset(){builtInEngine.reset(),this.hist=[],sysHistory=[]},get modelName(){return currentModel.name},get name(){return"AnimUML-sysHistory"},parseTransition:t=>_asyncToGenerator((function*(){return t}))(),parseConfiguration:t=>_asyncToGenerator((function*(){return t}))(),showTransition:t=>_asyncToGenerator((function*(){var e=getTransition(t);return{object:getTransObject(e).name,source:e.source.name,target:e.target.name}}))(),showConfiguration:t=>_asyncToGenerator((function*(){return JSON.parse(t)}))()};function testConversions(){examples.slice(0).forEach(t=>{load(t),Object(_Export2tUML_js__WEBPACK_IMPORTED_MODULE_0__.a)(currentModelWrapper),Object(_Export2C_js__WEBPACK_IMPORTED_MODULE_1__.a)(currentModelWrapper),currentModel.objects.filter(t=>currentModel.isActive(t)).map(t=>Object(_TransformStateMachine2Explicit_js__WEBPACK_IMPORTED_MODULE_6__.a)(t,currentModelWrapper))})}function testComparedProducerConsumer(){return _testComparedProducerConsumer.apply(this,arguments)}function _testComparedProducerConsumer(){return(_testComparedProducerConsumer=_asyncToGenerator((function*(){yield testComparedExecution("UML2AnimUML_ProducerConsumer",()=>{getObject("Mainintermediate").name="intermediate"})}))).apply(this,arguments)}function testComparedAliceBob2(){return _testComparedAliceBob.apply(this,arguments)}function _testComparedAliceBob(){return(_testComparedAliceBob=_asyncToGenerator((function*(){try{yield testComparedExecution("UML2AnimUML_AliceBob2",void 0,!1)}finally{}}))).apply(this,arguments)}function emiConnect(){return _emiConnect.apply(this,arguments)}function _emiConnect(){return(_emiConnect=_asyncToGenerator((function*(){engine!=builtInEngine&&engine.modelName!=emiURL.value&&disconnectFromEMI(),engine==builtInEngine&&(yield new Promise(t=>emiOkListener(t)))}))).apply(this,arguments)}function testComparedExecution(){return _testComparedExecution.apply(this,arguments)}function _testComparedExecution(){return(_testComparedExecution=_asyncToGenerator((function*(t,e){var n,r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],o=3<arguments.length?arguments[3]:void 0,a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];console.log("Comparing AnimUML vs EMI execution for: ",t),switchExample(t),checkEvents.checked=!0,considerGuardsTrue.checked=!1,fireInitialTransitions.checked=!0,yield emiConnect(),e&&e(),o&&(n=builtInEngine.reset,builtInEngine.reset=()=>{n.bind(builtInEngine)(),o()});var i=builtInEngine;try{var c=r;console.time("explore"),yield(yield __webpack_require__(24)("./DiffExplorer.js?nocache=".concat(Math.random()))).diffExplore(i,engine,Object(_DiffExplorer_js__WEBPACK_IMPORTED_MODULE_12__.a)({info(t){var{type:e,args:n}=t;return"Reached config "!==n[0]||0!=n[1]%100||c?!!c:(console.timeLog("explore"),!0)},counts:()=>!0}),a),console.timeEnd("explore")}finally{n&&(builtInEngine.reset=n)}}))).apply(this,arguments)}function testComparedLevelCrossing(){return _testComparedLevelCrossing.apply(this,arguments)}function _testComparedLevelCrossing(){return(_testComparedLevelCrossing=_asyncToGenerator((function*(){yield testComparedExecution("UML2AnimUML_LevelCrossing",void 0,!1,()=>{builtInEngine.configuration.objectState.tcEntrance0.__EMI__id=1,builtInEngine.configuration.objectState.tcEntrance1.__EMI__id=1,builtInEngine.configuration.objectState.tcExit.__EMI__id=2})}))).apply(this,arguments)}function testComparedExecutions(){return _testComparedExecutions.apply(this,arguments)}function _testComparedExecutions(){return(_testComparedExecutions=_asyncToGenerator((function*(){yield testComparedExecution("UML2AnimUML_AliceBob1"),yield testComparedAliceBob2(),yield testComparedLevelCrossing(),yield testComparedCruiseControlv4()}))).apply(this,arguments)}function prepareCruiseControlv4(){builtInEngine.settings.autoFireAfterChoice=!0,sysHistoryEngine.autoFireAfterChoice=!0,checkEvents.checked=!0,considerGuardsTrue.checked=!1,fireInitialTransitions.checked=!0,enableEventPools.checked=!0,matchFirst.checked=!0,symbolicValues.checked=!1,reactiveSystem.checked=!0,currentModel.getObject("env_engine").transitionByName.Init.effect="SET(this, speed, 1)",currentModel.objects.forEach(t=>function t(e){Object.values(e.internalTransitions||{}).forEach(t=>t.isInternal=!1),e.transitions.forEach(t=>t.isInternal=!1),e.states.forEach(e=>t(e))}(t))}function testComparedCruiseControlv4(){return _testComparedCruiseControlv.apply(this,arguments)}function _testComparedCruiseControlv(){return(_testComparedCruiseControlv=_asyncToGenerator((function*(){var t=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];yield testComparedExecution("UML2AnimUML_CruiseControlv4",prepareCruiseControlv4,t)}))).apply(this,arguments)}function testComparedLevelCrossingManual(){return _testComparedLevelCrossingManual.apply(this,arguments)}function _testComparedLevelCrossingManual(){return(_testComparedLevelCrossingManual=_asyncToGenerator((function*(){yield testComparedExecution("LevelCrossing",()=>{builtInEngine.nbMessagesToKeepInEther=1},!1,()=>{},!1)}))).apply(this,arguments)}function testFailingComparedExecutions(){return _testFailingComparedExecutions.apply(this,arguments)}function _testFailingComparedExecutions(){return(_testFailingComparedExecutions=_asyncToGenerator((function*(){yield testComparedLevelCrossingManual(),yield testComparedProducerConsumer()}))).apply(this,arguments)}function sleep(t){return new Promise(e=>setTimeout(e,t))}function testPlantUML(){return _testPlantUML.apply(this,arguments)}function _testPlantUML(){return(_testPlantUML=_asyncToGenerator((function*(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;for(var e of examples)console.log("Switching to example ",e),switchExample(e.name),yield sleep(t),edit(),yield sleep(t),edit()}))).apply(this,arguments)}function addExample(t){addOption(exampleSelect,t.name)}function loadFirstValidExample(){for(var t of examples)try{load(Object(_ImportFromAnimUML_js__WEBPACK_IMPORTED_MODULE_14__.a)(t));break}catch(e){throw console.log("Could not load model %s: %s",t.name,e),e}}function exportDynamicSymbols(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=function(e){Object.defineProperty(globalThis,e,{get:function(){return t(e)}})};for(var a of n)o(a)}function doExportSymbols(){Object(_Utils_js__WEBPACK_IMPORTED_MODULE_11__.c)(symbol=>eval(symbol),"loadSample","addExample","toggle","edit","disconnectFromEMI","disconnectFromTool","backTo","fire","emiFire","callOperation","switchToObject","setSender","show","hide","updateExport","updateFig","ALL_OBJECTS","updateObjects","switchExample","load","emiConnect","testComparedAliceBob2","testComparedCruiseControlv4","testExport","testExecutions","testComparedExecution","testComparedExecutions","sysHistoryEngine","testConversions","testPlantUML","testFailingComparedExecutions"),exportDynamicSymbols(symbol=>eval(symbol),"analysisTool"),window.reset=()=>builtInEngine.reset(),Object.defineProperty(window,"sysHistory",{get:()=>builtInEngine.sysHistory})}start()},function(module,__webpack_exports__,__webpack_require__){"use strict";var _Utils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);function asyncGeneratorStep(t,e,n,r,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){function a(t){asyncGeneratorStep(c,r,o,a,i,"next",t)}function i(t){asyncGeneratorStep(c,r,o,a,i,"throw",t)}var c=t.apply(e,n);a(void 0)}))}}var testCases=[{override:{disableEther:!0,"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1,"enableEventPools.checked":!1},load:"ExemplesExplicites",expected:new Expected(7680,47360,0),variants:[{long:!0},{override:{disableEther:!1},expected:new Expected(27720,167100,0),long:!0},{override:{"checkEvents.checked":!0},expected:new Expected(432,1620,2)},{keepOneObject:"TraductionEntryExitDo",expected:new Expected(4,5,0)},{keepOneObject:"After",expected:new Expected(4,5,1)},{keepOneObject:"When",expected:new Expected(4,3,2)},{keepOneObject:"Choice",expected:new Expected(4,3,1)},{keepOneObject:"CompositeWithoutHistory",expected:new Expected(5,5,1)},{keepOneObject:"CompositeWithHistory",expected:new Expected(6,7,0)}]},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV1",expected:new Expected(13,13,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV2",expected:new Expected(21,35,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV3",expected:new Expected(27,41,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV4",expected:new Expected(51,109,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV5",expected:new Expected(19,29,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1},load:"PubliphoneV6",expected:new Expected(22,32,0)},{override:{"checkEvents.checked":!1,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!1,"matchFirst.checked":!1,"symbolicValues.checked":!1},load:"ThermostatV1",expected:new Expected(499,1541,0)},{override:{"builtInEngine.autoFireAfterChoice":!0,"sysHistoryEngine.autoFireAfterChoice":!0,"checkEvents.checked":!0,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!0,"enableEventPools.checked":!0,"matchFirst.checked":!1,"symbolicValues.checked":!1},load:"UML2AnimUML_AliceBob1",expected:new Expected(4,8,0),runWithEMI:!0},{override:{"builtInEngine.autoFireAfterChoice":!0,"sysHistoryEngine.autoFireAfterChoice":!0,"checkEvents.checked":!0,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!0,"enableEventPools.checked":!0,"matchFirst.checked":!1,"symbolicValues.checked":!1},load:"UML2AnimUML_AliceBob2",expected:new Expected(8,12,1),runWithEMI:!0},{long:!0,override:{"builtInEngine.autoFireAfterChoice":!0,"sysHistoryEngine.autoFireAfterChoice":!0,"checkEvents.checked":!0,"considerGuardsTrue.checked":!1,"fireInitialTransitions.checked":!0,"enableEventPools.checked":!0,"matchFirst.checked":!0,"symbolicValues.checked":!1,"reactiveSystem.checked":!0},load:"UML2AnimUML_CruiseControlv4",setup(t){t.getObject("env_engine").transitionByName.Init.effect="SET(this, speed, 1)",t.objects.forEach(t=>function t(e){Object.values(e.internalTransitions||{}).forEach(t=>t.isInternal=!1),e.transitions.forEach(t=>t.isInternal=!1),e.states.forEach(e=>t(e))}(t))},expected:new Expected(6704,11324,0),runWithEMI:!0}];function Expected(t,e,n){this.nbConfigurations=t,this.nbTransitions=e,this.nbDeadlocks=n,this.equals=t=>t.nbConfigurations==this.nbConfigurations&&t.nbTransitions==this.nbTransitions&&t.nbDeadlocks==this.nbDeadlocks}function logStatus(t,e,n){console.log(t," configurations; ",e," transitions; ",n," deadlocks")}function testExecution(){return _testExecution.apply(this,arguments)}function _testExecution(){return(_testExecution=_asyncToGenerator((function*(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:engine,e=1<arguments.length?arguments[1]:void 0;console.time("explore");var n=yield(yield __webpack_require__(23)("./Explorer.js?nocache=".concat(Math.random()))).explore(t,(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];logStatus.apply(null,e)}),e);return console.timeEnd("explore"),n}))).apply(this,arguments)}function testExecutions(){return _testExecutions.apply(this,arguments)}function _testExecutions(){return(_testExecutions=_asyncToGenerator((function*(){function t(t){console.assert.apply(console,arguments),t||c++}function e(t,e){Object.entries(t).forEach(t=>{var[n,r]=t,o=window,a=n.split(".");a.slice(0,-1).forEach(t=>o=o[t]);var i=Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.h)(a);e(u,n,o,i,r)})}var n=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],r=1<arguments.length?arguments[1]:void 0,o=currentModel.name,a=keepOneMessagePerTrigger.checked;keepOneMessagePerTrigger.checked=!0;var i=0,c=0,s=function*(o){var a=function*(a){function c(){return s.apply(this,arguments)}function s(){return(s=_asyncToGenerator((function*(e){console.log("Running with engine: ",e.name);var n=yield testExecution(e);t(p.equals(n),"".concat(o.load).concat(a.keepOneObject?".".concat(a.keepOneObject):"",":"),"expected: ",p,", actual: ",n)}))).apply(this,arguments)}return r&&!r(o,a)?(console.log("Skipping a test according to filter"),"continue"):(null==a.long?o.long:a.long)&&!n?(console.log("Skipping a long test. If you want to run all tests, pass true as first argument to testExecutions"),"continue"):(console.log("Loading: ",o.load),switchExample(o.load),i++,o.setup&&o.setup(currentModel),a.keepOneObject&&load(currentModel.getObject(a.keepOneObject)),a.setup&&a.setup(o),u={},e(d=Object.assign(Object.assign({},o.override),a.override),(t,e,n,r,o)=>{t[e]=n[r],n[r]=o}),p=a.expected||o.expected,console.log("Expecting: ",p.nbConfigurations," configurations; ",p.nbTransitions," transitions; ",p.nbDeadlocks," deadlocks"),yield c(builtInEngine),(o.runWithEMI&&null==a.runWithEMI||a.runWithEMI)&&(yield emiConnect(),yield c(engine)),e(d,(t,e,n,r)=>{n[r]=t[e]}),a.tearDown&&a.tearDown(),void(o.tearDown&&o.tearDown()))};for(var c of o.variants||[{}])yield*a(c)};for(var l of testCases){var u,d,p;yield*s(l)}console.log("Ran ",i," tests with ",c," fails."),keepOneMessagePerTrigger.checked=a,switchExample(o)}))).apply(this,arguments)}Object(_Utils_js__WEBPACK_IMPORTED_MODULE_0__.c)(symbol=>eval(symbol),"testExecution","testExecutions")},function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=23},function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=24}]);
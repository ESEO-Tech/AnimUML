!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),t.exports=n(2)},function(t,e){!function(e){"use strict";var n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag",l="object"==typeof t,u=e.regeneratorRuntime;if(u)l&&(t.exports=u);else{(u=e.regeneratorRuntime=l?t.exports:{}).wrap=f;var c={},d={};d[o]=function(){return this};var h=Object.getPrototypeOf,p=h&&h(h(N([])));p&&p!==n&&i.call(p,o)&&(d=p);var v=b.prototype=y.prototype=Object.create(d);m.prototype=v.constructor=b,b.constructor=m,b[s]=m.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(v),t},u.awrap=function(t){return{__await:t}},x(w.prototype),w.prototype[a]=function(){return this},u.AsyncIterator=w,u.async=function(t,e,n,i){var r=new w(f(t,e,n,i));return u.isGeneratorFunction(e)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},x(v),v[s]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},u.values=N,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;P(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:N(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}}}function f(t,e,n,i){var r=e&&e.prototype instanceof y?e:y,o=Object.create(r.prototype),a=new C(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return S()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=g(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function g(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function y(){}function m(){}function b(){}function x(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function w(t){var e;this._invoke=function(n,r){function o(){return new Promise((function(e,o){!function e(n,r,o,a){var s=g(t[n],t,r);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(u).then((function(t){l.value=t,o(l)}),a)}a(s.arg)}(n,r,e,o)}))}return e=e?e.then(o,o):o()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=g(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,c;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function N(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},function(module,exports){var svgns="http://www.w3.org/2000/svg",xlinkns="http://www.w3.org/1999/xlink";function GetParams(){var t=[];if(document.defaultView.frameElement)for(var e=document.defaultView.frameElement.getElementsByTagName("param"),n=0,i=e.length;i>n;n++){var r=(c=e[n]).getAttribute("name"),o=c.getAttribute("value");t[r]=o}var a=document.defaultView.location.href;if(-1!=a.indexOf("?"))for(var s=a.split("?")[1].split(/&|;/),l=0,u=s.length;u>l;l++){var c,d=(c=s[l]).split("=");r=unescape(d[0]),o=unescape(d[1]);t[r]=o}SetElementValues(t,[])}function GetValue(t,e){var n=t.split(")"),i=n[0].replace("param(",""),r=null;n[1]&&(r=n[1].replace(/^\s\s*/,"").replace(/\s\s*$/,""));var o=e[i];return o||(o=r),o}function SetElementValues(t,e){for(var n,i=[],r=document.documentElement.getElementsByTagName("*"),o=0,a=r.length;a>o;o++)if("use"!=(n=r[o]).localName)SetParamValues(n,t);else{(c=EmulateShadowTree(n,t,e,o))&&i.push([n,c])}for(var s=0,l=i.length;l>s;s++){var u=i[s][0],c=i[s][1];u.setAttribute("display","none"),u.nextSibling?u.parentNode.insertBefore(c,u.nextSibling):u.parentNode.appendChild(c)}}function SetParamValues(t,e,n){for(var i,r=0,o=t.attributes.length;o>r;r++)if(i=t.attributes[r]){var a=i.value;if(-1!=a.indexOf("param("))if("params"!=i.localName){if(null!=(v=GetValue(a,e))&&""!=v)if("content-value"==i.localName)t.replaceChild(document.createTextNode(v),t.firstChild);else{var s=i.localName.endsWith("-value")?i.name.replace(/-value$/,""):i.name;t.setAttributeNS(i.namespaceURI,s,v);var l=t.getAttribute("params");l?t.setAttribute("params",l+";"+s+":"+a):t.setAttribute("params",s+":"+a)}}else if(n)for(var u=a.split(";"),c=0,d=u.length;d>c;c++){var h=u[c].split(":"),p=h[0],v=GetValue(h[1],e),f=null;("href"==p||"xlink:href"==p)&&(f=xlinkns),t.setAttributeNS(f,p,v)}}}function EmulateShadowTree(t,e,n,i){t.id?(idPrefix=t.id,idSuffix=""):(idPrefix="",idSuffix="__"+i);for(var r,o=Object.create(e),a=!1,s=t.childNodes,l=0,u=s.length;u>l;l++)if(1==(r=s[l]).nodeType&&"param"==r.localName){var c=r.getAttribute("name"),d=r.getAttribute("value");o[c]=d,a=!0}var h=t.getAttribute("parameters");if(h)for(var p=h.split(";"),v=0,f=p.length;f>v;v++){var g=p[v].split(":");o[g[0]]=g[1],a=!0}if(a){var y,m,b,x,w,_,E=(t.getAttributeNS(xlinkns,"href")||t.getAttribute("href")).replace("#",""),P=document.getElementById(E),C=!1;(null===(y=t.nextSibling)||void 0===y||null===(m=y.children)||void 0===m||null===(b=m[0])||void 0===b?void 0:b.id)===t.id?(C=!0,_=(w=t.nextSibling).children[0],x=w.children[0]):(x=P.cloneNode(!0),w=document.createElementNS(svgns,"g"),(_=document.createElementNS(svgns,"g")).appendChild(x),w.appendChild(_)),SetParamValues(x,o,!0);for(var N=0,S=t.attributes.length;S>N;N++)(q=t.attributes[N]).localName.endsWith("-value")||"params"==q.localName||"parameters"==q.localName||"href"==q.localName||"x"==q.localName||"y"==q.localName||"display"==q.localName&&C||_.setAttribute(q.name,q.value);for(var A,T=x.getElementsByTagName("*"),G=0,R=T.length;R>G;G++){SetParamValues(A=T[G],o,!0);for(var V=0,I=A.attributes.length;I>V;V++){var q,B=(q=A.attributes[V]).value;if("id"==q.localName&&!C){var L=idPrefix+B+idSuffix;A.setAttribute(q.name,L),n[B]=L}if(-1!=B.indexOf("url(#"))for(uid in n)-1!=B.indexOf("url(#"+uid+")")&&A.setAttributeNS(q.namespaceURI,q.name,"url(#"+n[uid]+")")}}return w}return null}GetParams();var debugSVGConstraints=!1,debugArith=!1;function setNE(t,e,n){t[e]||Object.defineProperty(t,e,{value:n})}setNE(Array.prototype,"peek",(function(){return this[this.length-1]})),setNE(Array.prototype,"find",(function(t){return this.filter(t)[0]}));var arrayLikeTypes=[HTMLCollection,NamedNodeMap,NodeList],arrayFunctions=["forEach","filter","find","some"];function extend(t,e){function n(){}n.prototype=e.prototype,t.prototype=new n}arrayLikeTypes.forEach((function(t){arrayFunctions.forEach((function(e){setNE(t.prototype,e,Array.prototype[e])}))}));var idToWrapper={};function asConstraint(t){return t.constraint?t.constraint:c.Expression.fromConstant(t)}function Expression(t){var e=arguments;"number"==typeof t&&(t=c.Expression.fromConstant(t)),this.__defineGetter__("constraint",(function(){return t})),this.__defineGetter__("exp",(function(){return e})),this.__defineGetter__("neg",(function(){return new Expression(0).minus(this)}))}function trace(t,e){e&&(t.location=e)}function Interval(t){this.bounds=t.length?t:[t,t.neg]}function Constraints(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(arguments[e]);this.__defineGetter__("constraints",(function(){return t}))}function Variable(t,e){var n=new c.Variable({name:t,value:e||0});Expression.call(this,c.Expression.fromVariable(n),t),this.isVar=!0,this.variable=n,this.name=t}function Point(t,e){this.__defineGetter__("x",(function(){return t})),this.__defineGetter__("y",(function(){return e}))}function Segment(t,e){this.__defineGetter__("p1",(function(){return t})),this.__defineGetter__("p2",(function(){return e})),this.__defineGetter__("x1",(function(){return t.x})),this.__defineGetter__("y1",(function(){return t.y})),this.__defineGetter__("x2",(function(){return e.x})),this.__defineGetter__("y2",(function(){return e.y}))}function Rectangle(t,e,n,i){this.__defineGetter__("x",(function(){return t})),this.__defineGetter__("y",(function(){return e})),this.__defineGetter__("width",(function(){return n})),this.__defineGetter__("height",(function(){return i})),this.__defineGetter__("center",(function(){return new Point(t.plus(n.div(2)),e.plus(i.div(2)))})),this.__defineGetter__("topLeft",(function(){return new Point(t,e)})),this.__defineGetter__("topRight",(function(){return new Point(t.plus(n),e)})),this.__defineGetter__("bottomLeft",(function(){return new Point(t,e.plus(i))})),this.__defineGetter__("bottomRight",(function(){return new Point(t.plus(n),e.plus(i))})),this.__defineGetter__("top",(function(){var i=new Segment(new Point(t,e),new Point(t.plus(n),e));return i.isHorizontal=!0,i})),this.__defineGetter__("bottom",(function(){var r=new Segment(new Point(t,e.plus(i)),new Point(t.plus(n),e.plus(i)));return r.isHorizontal=!0,r})),this.__defineGetter__("left",(function(){var n=new Segment(new Point(t,e),new Point(t,e.plus(i)));return n.isVertical=!0,n})),this.__defineGetter__("right",(function(){var r=new Segment(new Point(t.plus(n),e),new Point(t.plus(n),e.plus(i)));return r.isVertical=!0,r}))}function Line(t){var e=$(t),n=new Variable(t+".x1",e.getAttribute("x1")),i=new Variable(t+".y1",e.getAttribute("y1")),r=new Variable(t+".x2",e.getAttribute("x2")),o=new Variable(t+".y2",e.getAttribute("y2"));Segment.call(this,new Point(n,i),new Point(r,o)),this.__defineGetter__("elem",(function(){return e}))}Expression.prototype.plus=function(t){return new Expression(this.constraint.plus(asConstraint(t)),this,"+",t)},Expression.prototype.minus=function(t){return new Expression(this.constraint.minus(asConstraint(t)),this,"-",t)},Expression.prototype.mult=Expression.prototype.times=function(t){return new Expression(this.constraint.times(asConstraint(t)),this,"*",t)},Expression.prototype.div=function(t){return new Expression(this.constraint.divide(asConstraint(t)),this,"/",t)},Expression.prototype.eq=function(t,e){if(void 0===t)throw"ERROR: cannot force an Expression to equal undefined";var n=new c.Equation(this.constraint,asConstraint(t));return trace(n,e),new Constraints(n)},Expression.prototype.ge=function(t,e){var n=new c.Inequality(this.constraint,c.GEQ,asConstraint(t));return trace(n,e),new Constraints(n)},Expression.prototype.le=function(t,e){var n=new c.Inequality(this.constraint,c.LEQ,asConstraint(t));return trace(n,e),new Constraints(n)},Expression.prototype.between=function(t,e,n){var i=new c.Inequality(asConstraint(t),c.LEQ,this.constraint),r=new c.Inequality(asConstraint(e),c.GEQ,this.constraint);return trace(i,n),trace(r,n),new Constraints(i,r)},Expression.prototype.toString=function(){return Array.prototype.map.call(this.exp,(function(t){return t?"("+t.toString()+")":void 0})).join()},Expression.prototype.st=function(t,e){var n=new Variable("stay constraint variable");return this.eq(n).and(n.st(t,e))},Expression.prototype.stay=function(t,e){var n=new Variable("stay constraints");return this.eq(n).add(),solver.addStay(n.variable,t,e),n},Expression.prototype.intervalTo=function(t){return new Interval(this.minus(t))},Interval.prototype.le=function(t,e){var n;return this.bounds.forEach((function(i){var r=i.le(t,e);n=n?n.and(r):r})),n},Interval.prototype.plus=function(t){var e=[];return this.bounds.forEach((function(n){t.bounds.forEach((function(t){e.push(n.plus(t)),e.push(t.plus(n))}))})),new Interval(e)},Interval.prototype.mult=Interval.prototype.times=function(t){return new Interval(this.bounds.map((function(e){return e.times(t)})))},Interval.prototype.minimize=function(t,e,n){return t||(t=c.Strength.weak),e||(e=1),this.le(1,n).setPriority(t,e).add()},Interval.prototype.debug=function(){return console.log(this.bounds),this},Constraints.prototype.add=function(){for(var t,e=0;e<this.constraints.length;e++)t=this.constraints[e],solver.addConstraint(t);return this},Constraints.prototype.remove=function(){for(var t=0;t<this.constraints.length;t++)solver.removeConstraint(this.constraints[t]);return this},Constraints.prototype.and=function(t){var e=[];return e=Array.prototype.concat.call(e,this.constraints),new Constraints(e=Array.prototype.concat.call(e,t.constraints))},Constraints.prototype.setPriority=function(t,e){t||(t=c.Strength.weak),e||(e=1);for(var n=0;n<this.constraints.length;n++)this.constraints[n].strength=t,this.constraints[n].weight=e;return this},extend(Variable,Expression),Variable.prototype.st=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c.Strength.weak,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return new Constraints(new c.StayConstraint(this.variable,t,e))},Variable.prototype.stay=function(t,e){return t||(t=c.Strength.weak),e||(e=1),solver.addStay(this.variable,t,e),this},Variable.prototype.suggest=function(t){debugArith&&console.log("suggesting %o = %o",this,t),solver.addEditVar(this.variable),solver.beginEdit(),solver.suggestValue(this.variable,t),solver.endEdit()},Variable.prototype.inspect=function(t){this.variable.inspectMessage=t},c.SimplexSolver.prototype.onsolved=function(t){t&&t.forEach((function(t){t.variable.inspectMessage&&console.log("%s=%d (was %d)",t.variable.inspectMessage,t.variable.value,t.oldValue)}))},Point.prototype.plus=function(t,e){return new Point(this.x.plus(t),this.y.plus(e))},Point.prototype.dx=function(t){return new Point(this.x.plus(t),this.y)},Point.prototype.dy=function(t){return new Point(this.x,this.y.plus(t))},Point.prototype.minus=function(t,e){if(t instanceof Point){var n=t;return new Point(this.x.minus(n.x),this.y.minus(n.y))}return new Point(this.x.minus(t),this.y.minus(e))},Point.prototype.st=function(t,e){return this.x.st(t,e).and(this.y.st(t,e))},Point.prototype.stay=function(t,e){return{x:this.x.stay(t,e),y:this.y.stay(t,e)}},Point.prototype.eq=function(t,e){return this.x.eq(t.x,e).and(this.y.eq(t.y,e))},Point.prototype.inRect=function(t,e){return t.mustContain(this,e)},Point.prototype.onSegment=function(t,e,n){return t.isHorizontal?this.y.eq(t.p1.y,n).and(this.x.between(t.p1.x,t.p2.x,n)):t.isVertical?this.x.eq(t.p1.x,n).and(this.y.between(t.p1.y,t.p2.y,n)):void console.log("ERROR: neither horiz, nor vert")},Point.prototype.distTo=function(t){return this.x.intervalTo(t.x).plus(this.y.intervalTo(t.y))},Segment.prototype.__defineGetter__("center",(function(){return new Point(this.p1.x.plus(this.p2.x.minus(this.p1.x).div(2)),this.p1.y.plus(this.p2.y.minus(this.p1.y).div(2)))})),Segment.prototype.toString=function(){return"x1="+this.p1.x.variable.value+", y1="+this.p1.y.variable.value+", x2="+this.p2.x.variable.value+", y2="+this.p2.y.variable.value+(this.dx?", dx="+this.dx:"")+(this.dy?", dy="+this.dy:"")+", dx'="+(this.p2.x.variable.value-this.p1.x.variable.value)+", dy'="+(this.p2.y.variable.value-this.p1.y.variable.value)},Segment.prototype.length=function(){return this.x1.intervalTo(this.x2).plus(this.y1.intervalTo(this.y2))},Rectangle.prototype.st=function(t,e){return this.x.st(t,e).and(this.y.st(t,e)).and(this.width.st(t,e)).and(this.height.st(t,e))},Rectangle.prototype.stay=function(t,e){t||(t=c.Strength.weak),e||(e=2),this.x.variable&&solver.addStay(this.x.variable,t,e),this.y.variable&&solver.addStay(this.y.variable,t,e),this.width.variable&&solver.addStay(this.width.variable,t,e+1),this.height.variable&&solver.addStay(this.height.variable,t,e+1)},Rectangle.prototype.mustContainX=function(t,e){return t.between(this.x,this.x.plus(this.width),e)},Rectangle.prototype.mustContainY=function(t,e){return t.between(this.y,this.y.plus(this.height),e)},Rectangle.prototype.mustContain=function(t,e){if(t instanceof Point)return this.mustContainX(t.x,e).and(this.mustContainY(t.y,e));if(t instanceof Rectangle)return this.mustContain(t.topLeft,e).and(this.mustContain(t.bottomRight,e));throw"Rectangle.mustContain does not support parameter "+t},Rectangle.prototype.enlarge=Rectangle.prototype.enlarge||function(){var t,e,n,i;switch(arguments.length){case 4:t=0>=arguments.length?void 0:arguments[0],e=1>=arguments.length?void 0:arguments[1],n=2>=arguments.length?void 0:arguments[2],i=3>=arguments.length?void 0:arguments[3];break;case 2:t=n=0>=arguments.length?void 0:arguments[0],e=i=1>=arguments.length?void 0:arguments[1];break;case 1:t=e=n=i=0>=arguments.length?void 0:arguments[0]}return new Rectangle(this.x.minus(t),this.y.minus(e),this.width.plus(t).plus(n),this.height.plus(e).plus(i))},Rectangle.prototype.toString=function(){if(this.x.variable)return"x="+this.x.variable.value+", y="+this.y.variable.value+", width="+this.width.variable.value+", height="+this.height.variable.value},Rectangle.prototype.inRect=function(t,e){return t.mustContain(this,e)},extend(Line,Segment),Line.prototype.casso2svg=function(){this.elem.setAttribute("x1",this.p1.x.variable.value),this.elem.setAttribute("x2",this.p2.x.variable.value),this.elem.setAttribute("y1",this.p1.y.variable.value),this.elem.setAttribute("y2",this.p2.y.variable.value)},Line.prototype.eq=function(t,e){return this.p1.eq(t.p1,e).and(this.p2.eq(t.p2,e))};var textDimUpdater=new ResizeObserver(t=>{for(var e of t){getWrapper(e.target.id).updateDimensions(e.target.id,e.target.getBBox())}solver.resolve(),move()});globalThis.tcsvg={},tcsvg.Text=function(t){var e=$(t),n=e.getBBox(),i=new Variable(t+".bboxWidth",-1),r=new Variable(t+".bboxHeight",-1),o=new Variable(t+".bboxX",n.x),a=new Variable(t+".bboxY",n.y);e.style.dominantBaseline="text-before-edge",Rectangle.call(this,o,a,i,r),this.updateDimensions(t,n),this.__defineGetter__("elem",(function(){return e})),this.casso2svg=function(){this.elem.setAttribute("x",o.variable.value),this.elem.setAttribute("y",a.variable.value)},textDimUpdater.observe(e,{characterData:!0,attributes:!0})},extend(tcsvg.Text,Rectangle),tcsvg.Text.prototype.startMoving=function(){return solver.addEditVar(this.x.variable),solver.addEditVar(this.y.variable),this},tcsvg.Text.prototype.remove=function(){var t,e;null===(t=this.dimStays)||void 0===t||null===(e=t.remove)||void 0===e||e.call(t)};var EPSILON=.1;function Rect(t){var e=$(t),n=t.replace(/[.].*$/,""),i={x:1*getParam(n,"x"),y:1*getParam(n,"y")};debugSVGConstraints&&console.log(i);var r=new Variable(t+".x"),o=new Variable(t+".y"),a=new Variable(t+".width",e.getBBox().width),s=new Variable(t+".height",e.getBBox().height);Rectangle.call(this,r,o,a,s),this.__defineGetter__("elem",(function(){return e})),this.svg2casso=function(){var t=e.getCTM(),n=svg.createSVGPoint();n.x=e.getBBox().x,n.y=e.getBBox().y,n=n.matrixTransform(t),r.variable.value=n.x,o.variable.value=n.y,a.variable.value=e.getBBox().width,s.variable.value=e.getBBox().height},this.casso2svg=function(){var t=this.x.variable.value,n=this.y.variable.value,i=this.width.variable.value,r=this.height.variable.value;0>i&&(t+=i),0>r&&(n+=r),this.noTransform?(e.setAttribute("x",t),e.setAttribute("y",n)):this.elem.parentNode.setAttribute("transform","translate("+this.x.variable.value+", "+this.y.variable.value+")"),this.elem.setAttribute("width",Math.abs(i)),this.elem.setAttribute("height",Math.abs(r))}}function Polygon(t){var e=$(t);this.__defineGetter__("elem",(function(){return e}));var n=[];n.eq=function(t,e){for(var i=new Constraints,r=0;r<t.length;r+=2){var o=t[r],a=t[r+1];n[r/2]||(n[r/2]=new Point(new Variable("poly["+r/2+"].x"),new Variable("poly["+r/2+"].y"))),i=i.and(n[r/2].x.eq(o,e)).and(n[r/2].y.eq(a,e))}return i},this.__defineGetter__("points",(function(){return n}))}function asExp(t){return"number"==typeof t&&(t=new Expression(t)),t}function Circle(t){var e=$(t);this.__defineGetter__("elem",(function(){return e}));var n=new Variable(t+".cx",e.cx.baseVal.value),i=new Variable(t+".cy",e.cy.baseVal.value),r=new Variable(t+".r");this.__defineGetter__("cx",(function(){return n})),this.__defineGetter__("cy",(function(){return i})),this.__defineGetter__("x",(function(){return n})),this.__defineGetter__("y",(function(){return i})),this.__defineGetter__("r",(function(){return r}));var o=Math.sqrt(2)/2;this.__defineGetter__("topLeft",(function(){return new Point(n.plus(r.neg.times(o)),i.plus(r.neg.times(o)))})),this.__defineGetter__("top",(function(){return new Point(n,i.plus(r.neg))})),this.__defineGetter__("topRight",(function(){return new Point(n.plus(r.times(o)),i.plus(r.neg.times(o)))})),this.__defineGetter__("right",(function(){return new Point(n.plus(r),i)})),this.__defineGetter__("bottomRight",(function(){return new Point(n.plus(r.times(o)),i.plus(r.times(o)))})),this.__defineGetter__("bottom",(function(){return new Point(n,i.plus(r))})),this.__defineGetter__("left",(function(){return new Point(n.plus(r.neg),i)})),this.__defineGetter__("bottomLeft",(function(){return new Point(n.plus(r.neg.times(o)),i.plus(r.times(o)))}))}function $(t){return document.getElementById(t)}function getWrapper(t){var e=idToWrapper[t];if(!e){function n(e){var n=i.getAttribute(e);(null==n?void 0:n.match(/%this%/))&&i.setAttribute(e,n.replace(/%this%/g,t.replace(/\..*$/,"")))}var i=$(t);i||console.log("ERROR: could not find element with id=%o",t);var r=i.tagName;"line"===r?e=new Line(t):"rect"===r?(e=new Rect(t)).noTransform=!0:"text"===r?e=new tcsvg.Text(t):"polygon"===r||"polyline"===r?e=new Polygon(t):"circle"===r?e=new Circle(t):"pattern"===r||"clipPath"===r||console.log("ERROR: could not wrap "+r),n("clip-path"),n("fill"),e&&(idToWrapper[t]=e)}return e}function getParam(t,e){if($(t)){var n=$(t).attributes[e];return n||(n=$(t).children.find((function(t){return t.attributes.name.value===e})))&&(n=n.attributes.value),n?n.value:void 0}}tcsvg.Text.prototype.updateDimensions=function(t,e){var n,i;Math.abs(this.height.variable.value-e.height)<=EPSILON&&Math.abs(this.width.variable.value-e.width)<=EPSILON||(null===(n=this.dimStays)||void 0===n||null===(i=n.remove)||void 0===i||i.call(n),this.width.variable.value=e.width,this.height.variable.value=e.height,this.dimStays=this.width.st(c.Strength.required).and(this.height.st(c.Strength.required)).add())},tcsvg.Text.prototype.suggest=function(t,e){return solver.suggestValue(this.x.variable,t).suggestValue(this.y.variable,e).resolve(),this},extend(Rect,Rectangle),Rect.prototype.startMoving=function(){return solver.addEditVar(this.x.variable),solver.addEditVar(this.y.variable),this},Rect.prototype.suggest=function(t,e){return solver.suggestValue(this.x.variable,t).suggestValue(this.y.variable,e).resolve(),this},Polygon.prototype.casso2svg=function(){for(var t="",e=0;e<this.points.length;e++)t+=this.points[e].x.variable.value+","+this.points[e].y.variable.value+" ";this.elem.setAttribute("points",t)},Polygon.prototype.mustContain=function(t,e){if(this.isTEllipse)return this._f1?this._f1.distTo(t).plus(this._f2.distTo(t)).le(this._size,e):t.distTo(this._center).le(this._size.div(2),e);throw"unsupported: arbitraryPolygon.mustContain(Point)"},Polygon.prototype.addPoint=function(t,e){t instanceof Point&&(e=t.y,t=t.x);var n=new Variable("point.x"),i=new Variable("point.y");n.eq(t).add(),i.eq(e).add(),this.points.push(new Point(n,i))},Polygon.prototype.pointEq=function(t,e,n,i){var r;for((e instanceof Point&&(n=e.y,e=e.x),"constant"in(null!==(r=t.constraint)&&void 0!==r?r:{})&&(t=t.constraint.constant));this.points.length<t+1;){var o=new Variable("point.x"),a=new Variable("point.y");this.points.push(new Point(o,a))}return this.points[t].x.eq(e,i).and(this.points[t].y.eq(n,i))},Polygon.prototype.constrainTEllipse=function(t,e,n,i,r){function o(){u=t.plus(a.div(2)),c=e.plus(s.div(2)),d=t.plus(a),h=e.plus(s)}var a,s,l,u,c,d,h;if(i||(i=0),r||(r=0),n=asExp(n),0===i&&0===r)s=a=n,o(),l=this.pointEq(0,u,e).and(this.pointEq(1,d,c)).and(this.pointEq(2,u,h)).and(this.pointEq(3,t,c));else if(0===r){var p=asExp(i);a=n,s=n.minus(p),o();var v=p.div(2),f=u.minus(v),g=u.plus(v);l=this.pointEq(0,t,c).and(this.pointEq(1,f,e)).and(this.pointEq(2,g,e)).and(this.pointEq(3,d,c)).and(this.pointEq(4,g,h)).and(this.pointEq(5,f,h)),this._f1=new Point(f,c),this._f2=new Point(g,c)}else if(0===i){p=asExp(r);s=n,a=n.minus(p),o();var y=p.div(2),m=this._f1=new Point(u,c.minus(y)),b=this._f2=new Point(u,c.plus(y));l=this.pointEq(0,m.x,e).and(this.pointEq(1,d,m.y)).and(this.pointEq(2,d,b.y)).and(this.pointEq(3,m.x,h)).and(this.pointEq(4,t,b.y)).and(this.pointEq(5,t,m.y))}else{i=asExp(i),r=asExp(r);s=n.minus(i),a=n.minus(r),o();var x=i.div(2),w=r.div(2);m=this._f1=new Point(u.minus(x),c.minus(w)),b=this._f2=new Point(u.plus(x),c.plus(w));l=this.pointEq(0,m.x,e).and(this.pointEq(1,b.x,e)).and(this.pointEq(2,d,m.y)).and(this.pointEq(3,d,b.y)).and(this.pointEq(4,b.x,h)).and(this.pointEq(5,m.x,h)).and(this.pointEq(6,t,b.y)).and(this.pointEq(7,t,m.y))}return this.isTEllipse=!0,this._size=n,this._width=a,this._height=s,this._center=new Point(u,c),this.center=this._center,l},Polygon.prototype.makeTEllipse=function(t,e,n,i,r){var o,a;if(i||(i=0),r||(r=0),n=asExp(n),0===i&&0===r)a=o=n,this.addPoint(t.plus(o.div(2)),e),this.addPoint(t.plus(o),e.plus(a.div(2))),this.addPoint(t.plus(o.div(2)),e.plus(a)),this.addPoint(t,e.plus(a.div(2)));else if(0===r){var s=asExp(i);o=n,a=n.minus(s),this.addPoint(t,e.plus(a.div(2))),this.addPoint(t.plus(o.div(2)).minus(s.div(2)),e),this.addPoint(t.plus(o.div(2)).plus(s.div(2)),e),this.addPoint(t.plus(o),e.plus(a.div(2))),this.addPoint(t.plus(o.div(2)).plus(s.div(2)),e.plus(a)),this.addPoint(t.plus(o.div(2)).minus(s.div(2)),e.plus(a)),this._f1=new Point(t.plus(o.div(2)).minus(s.div(2)),e.plus(a.div(2))),this._f2=new Point(t.plus(o.div(2)).plus(s.div(2)),e.plus(a.div(2)))}else if(0===i){s=asExp(r);a=n,o=n.minus(s);var l=this._f1=new Point(t.plus(o.div(2)),e.plus(a.div(2).minus(s.div(2)))),u=this._f2=new Point(t.plus(o.div(2)),e.plus(a.div(2)).plus(s.div(2)));this.addPoint(l.x,e),this.addPoint(t.plus(o),l.y),this.addPoint(t.plus(o),u.y),this.addPoint(l.x,e.plus(a)),this.addPoint(t,u.y),this.addPoint(t,l.y)}else{i=asExp(i),r=asExp(r);a=n.minus(i),o=n.minus(r);l=this._f1=new Point(t.plus(o.div(2)).minus(i.div(2)),e.plus(a.div(2).minus(r.div(2)))),u=this._f2=new Point(t.plus(o.div(2)).plus(i.div(2)),e.plus(a.div(2).plus(r.div(2))));this.addPoint(l.x,e),this.addPoint(u.x,e),this.addPoint(t.plus(o),l.y),this.addPoint(t.plus(o),u.y),this.addPoint(u.x,e.plus(a)),this.addPoint(l.x,e.plus(a)),this.addPoint(t,u.y),this.addPoint(t,l.y)}this.isTEllipse=!0,this._size=n,this._width=o,this._height=a,this._center=new Point(t.plus(o.div(2)),e.plus(a.div(2))),this.center=this._center},Circle.prototype.casso2svg=function(){this.elem.setAttribute("cx",this.cx.variable.value),this.elem.setAttribute("cy",this.cy.variable.value),this.elem.setAttribute("r",this.r.variable.value)},Circle.prototype.boundingRect=function(){return new Rectangle(this.cx.minus(this.r),this.cy.minus(this.r),this.r.times(2),this.r.times(2))},Circle.prototype.st=function(t,e){return this.cx.st(t,e).and(this.cy.st(t,e)).and(this.r.st(t,e))},Circle.prototype.stay=function(t,e){t||(t=c.Strength.weak),e||(e=2),solver.addStay(this.cx.variable,t,e),solver.addStay(this.cy.variable,t,e),solver.addStay(this.r.variable,t,e+1)},Circle.prototype.__defineGetter__("center",(function(){return new Point(this.cx,this.cy)})),Circle.prototype.startMoving=function(){return solver.addEditVar(this.cx.variable),solver.addEditVar(this.cy.variable),this},Circle.prototype.suggest=function(t,e){return solver.suggestValue(this.cx.variable,t).suggestValue(this.cy.variable,e).resolve(),this},Circle.prototype.inRect=function(t,e){return t?(console.log("%o inRect %o (%o)",this,t,t.toString()),t.mustContain(this.center.minus(this.r,this.r),e).and(t.mustContain(this.center.plus(this.r,this.r),e))):new Constraints},globalThis.getWrapper=getWrapper,globalThis.move=move;var debugParser=!1,opPrio={",":0,"+":1,"-":1,"*":2,"/":2};function getVal(t,e){if(t.match(/^[0-9]+(\.[0-9]*)?$/)){var n=new Expression(1*t);return debugParser&&console.log("NUMBER=%o",n),n}var i=e[t];return i||(i=e.get?e.get(t):new Variable(t),e[t]=i,debugParser&&console.log("new var %s",t)),i}function apply(t,e,n){return e+" "+t+" "+n}function parse(t,e){for(var n,i=[],r=[],o=0;o<t.length;o++){if(i.push(getVal(t[o],e)),debugParser&&console.log("getVal(%s)=%o",t[o],i.peek()),debugParser&&console.log(i),++o<t.length){for(n=t[o],debugParser&&console.log("curOp=%s prevOps=%o",n,r);r.peek()&&opPrio[r.peek()]>=opPrio[n];)debugParser&&console.log("pushing prevOp"),i.push(r.pop());r.push(n)}debugParser&&console.log("opcodes=%o",i)}for(debugParser&&console.log("remaining ops: %o",r);r.peek();)i.push(r.pop());debugParser&&console.log("tokens=%o",t),debugParser&&console.log("opcodes=%o",i);var a,s=[];for(o=0;o<i.length;o++)if("string"==typeof(a=i[o])){var l,u=s.pop(),c=s.pop();if(void 0===u||void 0===c){s.push(void 0);break}if(debugParser&&console.log("computing: %o %s %o",c,a,u),c)switch(a){case"+":l=c.plus(u);break;case"-":l=c.minus(u);break;case"*":l=c.times(u);break;case"/":l=c.div(u);break;case",":c.length||(c=[c]),l=c.concat(u);break;default:throw"unsupported opcode "+a}else l=c;debugParser&&console.log("\t=> %o",l),s.push(l)}else s.push(a);return s.pop()}tcsvg.Expression=Expression,tcsvg.Constraints=Constraints,tcsvg.addedUse=function(t){var e=EmulateShadowTree(t,{},[]);if(e.parentNode){for(var n of(constraints[t.id].remove(),e.getElementsByTagName("*")))if(n.id){var i=idToWrapper[n.id];if(i instanceof tcsvg.Text){var r=n.getBBox();i.updateDimensions(n.id,r)}}}else for(var o of(t.setAttribute("display","none"),t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e),null!==(a=null===(s=getDef(t.id).attributes.movable)||void 0===s||null===(l=s.value)||void 0===l?void 0:l.split(" "))&&void 0!==a?a:[])){var a,s,l;registerMove(t.id,o)}applyOwnedConstraints(t.id),move()},tcsvg.removedUse=function(t){var e=document.getElementById(t.id).parentNode;for(var n of(e.parentNode.removeChild(e),Object.keys(idToWrapper)))if(n.startsWith(t.id+".")){var i,r=idToWrapper[n];null==r||null===(i=r.remove)||void 0===i||i.call(r),delete idToWrapper[n]}constraints[t.id].remove()};var times=!0,debugInlineConstraints=!1,debugJSConstraints=!1,debugEvents=!1;function getDef(t){return $($(t).href.baseVal.replace(/^#/,""))}function setDirection(t){var e=t.elem,n=e.getAttribute("x1"),i=e.getAttribute("y1"),r=e.getAttribute("x2"),o=e.getAttribute("y2");n&&r&&n===r?t.isVertical=!0:i&&o&&i===o&&(t.isHorizontal=!0)}function applyInlineConstraints(t){function e(e,n){return e.split(".").every((function(e){if(n)if("string"!=typeof n)n=n[e];else if($(n+"."+e))n=getWrapper(n+"."+e);else{if(!$(n))return n=void 0,!1;n=getParam(n,e)}else if($(t+"."+e)&&(debugInlineConstraints&&console.log(t+"."+e),n=getWrapper(t+"."+e)),n||(n=getParam(t,e),debugInlineConstraints&&console.log("!!! %o.%o => %o",t,e,n)),!n)return!1;return!0})),n}var n=getDef(t);n||console.log("ERROR: could not find definition for %o",t);var i={get:function(n,i){if(this[n])return this[n];if(n.match(/[.]/)){var r=e(n);return debugInlineConstraints&&console.log("nav %o=%o",n,r),r}var o=window[n];if(o)return o instanceof Expression||(o=new Expression(o)),o;if(o=getParam(t,n))return debugInlineConstraints&&console.log("param' %o = %o",n,o),o.match(/^[0-9]+([.][0-9]*)?$/)?new Expression(1*o):(debugInlineConstraints&&console.log("using variable %o",o),o=this.get(o,!1),debugInlineConstraints&&console.log("\t%o",o),o);if(i)throw"ERROR: variable '"+toek+"' not found";var a=1*getParam(t,n+"_init");debugInlineConstraints&&console.log("%o => %o",t+"."+n,a);r=new Variable(n,a);return a&&(debugInlineConstraints&&console.log("add stay for %o = %o",n,a),r.stay(c.Strength.weak,1)),r}};n.children.filter((function(t){return t.id})).flatMap(t=>"pattern"===t.tagName?[...t.children]:[t]).forEach((function(n){"clipPath"===n.tagName&&(n=n.children[0]);var r=n.id,o=getWrapper(t+r);debugInlineConstraints&&console.log("%o wrapped as %o",$(t+r),o),o.noTransform=!0,n.attributes.filter((function(t){switch(n.tagName+""){case"text":return["x","y","width","height","dx","dy"].includes(t.name);case"rect":return["x","y","width","height","rx","ry"].includes(t.name);case"polyline":case"polygon":return["points"].includes(t.name);case"ellipse":return["cx","cy","rx","ry"].includes(t.name);case"circle":return["cx","cy","r"].includes(t.name);case"line":return["x1","y1","x2","y2"].includes(t.name)}return!1})).forEach((function(t){debugInlineConstraints&&console.log(t);var e=parse(t.value.split(" "),i);debugInlineConstraints&&console.log("\t%o",e);var n={get x1(){return o.p1.x},get y1(){return o.p1.y},get x2(){return o.p2.x},get y2(){return o.p2.y}}[t.name];n||(n=o[t.name]),n.eq(e).add()})),n.children.forEach((function(t){function n(e,n){var r=t.getAttribute(e);if(r){var o=parse(r.split(" "),i);o&&n(o)}}function r(n,i){var r=t.getAttribute(n);if(r){var o=e(r);debugInlineConstraints&&console.log("v=%o",o),o&&i(o)}}function a(e){var n=t.getAttribute("strength");if(n){var i=t.getAttribute("weight");i||(i=1),e.setPriority(c.Strength[n],i)}}function s(){var t={};return n("dx",(function(e){debugInlineConstraints&&console.log("dx=%o",e),t.dx=e})),n("dy",(function(e){debugInlineConstraints&&console.log("dy=%o",e),t.dy=e})),t.dx&&!t.dy&&(t.dy=0),t.dy&&!t.dx&&(t.dx=0),t}var l=t.nodeName.split("."),u=o;l.forEach((function(t){u=u[t]})),debugInlineConstraints&&console.log("nav %o.%o = %o",o,l,u),n("base",(function(t){debugInlineConstraints&&console.log("adding %o = %o",u,t);var e=s();(e.dx||e.dy)&&(u=u.plus(e.dx,e.dy));var n=u.eq(t);a(n),n.add()})),n("ge",(function(t){debugInlineConstraints&&console.log("adding %o > %o",u,t);var e=u.ge(t);a(e),e.add()})),n("le",(function(t){debugInlineConstraints&&console.log("adding %o < %o",u,t);var e=u.le(t);a(e),e.add()})),r("on",(function(t){setDirection(t);var e=u.onSegment(t);a(e),e.add()})),r("in",(function(t){var e=s();e.dx&&(u=u.plus(e.dx,e.dy));var n=u.inRect(t);a(n),n.add()}))}))})),n.children.filter((function(t){return["eq","ge","le"].includes(t.nodeName)})).forEach((function(t){var e=parse(t.getAttribute("left").split(" "),i),n=parse(t.getAttribute("right").split(" "),i);e&&n&&(debugInlineConstraints&&console.log("%o %o %o",e,t.nodeName,n),e[t.nodeName](n).add())}))}function applyConstraints(t,e){var n=Array.prototype.filter.call(document.getElementsByTagName("use"),(function(e){var n,i;return(null===(n=e.attributes["xlink:href"])||void 0===n?void 0:n.value)===t||(null===(i=e.attributes.href)||void 0===i?void 0:i.value)===t}));for(var i in n)e(n[i].id)}var resizeCanvas=!0;function move(){var t=0,e=1/0,n=0,i=1/0,r=function(){var r=idToWrapper[o];if(!r.doNotMove){function h(t){return 1*r.elem.getAttribute(t)}function p(n){n>t&&(t=n,r.elem),n<e&&(e=n,r.elem)}function v(t){t>n&&(n=t,r.elem),t<i&&(i=t,r.elem)}if(r.casso2svg(),r.elem.getAttribute("ignoreBounds"))return"continue";switch(r.elem.tagName){case"rect":p(d=h("y")),u=h("height"),p(d+u),v(c=h("x")),l=h("width"),v(c+l);break;case"line":v(h("x1")),p(h("y1")),v(h("x2")),p(h("y2"));break;case"circle":a=h("r"),v(h("cx")+a),v(h("cx")-a),p(h("cy")+a),p(h("cy")-a);break;default:v((s=r.elem.getBBox()).x),v(s.x+s.width),p(s.y),p(s.y+s.height)}}};for(var o in idToWrapper){var a,s;r()}i--,e--,n++,t++;var l=n,u=t,c=0>i?i:0,d=0>e?e:0;l=0>i?n-i:n,u=0>e?t-e:t,resizeCanvas&&(0>i||0>e?svg.setAttribute("viewBox",c+" "+d+" "+l+" "+u):svg.removeAttribute("viewBox"),svg.setAttribute("width",l),svg.setAttribute("height",u))}function constrainName(t,e){t.width.ge(e.width.plus(MARGIN.times(2))).add(),e.y.eq(e.height).add(),e.center.x.eq(t.width.div(2)).add()}var navigators={},constraints={};function onload1(){startTime=(new Date).getTime(),debugInlineConstraints&&console.log("Initializing..."),window.solver=new c.SimplexSolver,window.ZERO=new Expression(0),window.MARGIN=new Expression(10),window.INTER_OBJECT_MARGIN=new Variable("INTER_OBJECT_MARGIN",100),window.INTER_MESSAGE_MARGIN=new Variable("INTER_MESSAGE_MARGIN",50),window.INTER_OBJECT_MARGIN.stay(c.Strength.medium),window.INTER_MESSAGE_MARGIN.stay(c.Strength.medium),window.solver.autoSolve=!1,document.getElementsByTagName("globalConstraints").forEach((function(e){eval(e.innerHTML)}))}function applyOwnedConstraints(id,tagName){function Navigator(t){navigators[t]=this;var e=this;this.___id___=t,this.___group___=document.getElementById(t).nextSibling;var n=$(t);n.children.forEach((function(t){if("param"===t.tagName){var n=t.getAttribute("name"),i=t.getAttribute("value");if("name"!==n&&$(i)){debugJSConstraints&&console.log("creating Navigator for "+i);try{i=getNavigator(i)}catch(t){}}else if(i.match(/,/)){var r=i.split(",");r.every(t=>$(t))&&(i=r.map(t=>getNavigator(t)))}e[n]=i}})),n.attributes.forEach((function(t){if(!["xlink:href","id","display"].includes(t.name)){var n=t.name,i=t.value;if($(i))debugJSConstraints&&console.log("creating Navigator for "+i),i=getNavigator(i);else if(i.match(/,/)){var r=i.split(",");r.every(t=>$(t))&&(i=r.map(t=>getNavigator(t)))}e[n]=i}}));var i=getDef(t);this.___def___=i.id,i.children.forEach((function n(i){if(i.id.startsWith(".")){var r=i.id.substring(1),o=getWrapper(t+i.id);e[r]=o}i.children.forEach(n)}))}function getNavigator(t){var e=navigators[t];return e||(e=new Navigator(t)),e}tagName||(tagName="constraints");var def=getDef(id),fs="["+def.children.filter((function(t){return t.tagName===tagName})).map(t=>"(function() {"+t.textContent+"})").join(",")+"]";fs=eval(fs);var nav=getNavigator(id);for(var f of fs){var ret=f.call(nav);ret instanceof Constraints&&(constraints[id]=ret,ret.add())}}onload1(),onload2();var dx,dy,moving=void 0,movingName=void 0;function registerMove(t,e){var n=t+"."+e;$(n)||(console.log("WARNING:registerMove: could not find part %o",n),e="outline");var i=getWrapper(t+"."+e);i.elem.setAttribute("pointer-events","all"),i.elem.ontouchstart=i.elem.onmousedown=function(e){if(!moving){moving=i,svg.setAttribute("style","cursor: move"),debugEvents&&console.log("mousedown|touchstart %s at x=%d, y=%d",t,moving.x.variable.value,moving.y.variable.value),i.startMoving();var n=getPosition(e);return"circle"===i.elem.tagName?(dx=n.x-i.x.variable.value,dy=n.y-i.y.variable.value):(dx=n.x-i.elem.getBBox().x,dy=n.y-i.elem.getBBox().y),debugEvents&&console.log("mousedown|touchstart x=%d, y=%d ev@(%d, %d) dx=%d dy=%d",i.elem.getBoundingClientRect().left,moving.y.variable.value,n.x,n.y,dx,dy),solver.beginEdit(),e.preventDefault?e.preventDefault():e.defaultPrevented=!0,!0}}}function getPosition(t){return t.touches&&(debugEvents&&console.log("ev=%o ev.touches=%o",t,t.touches),t=t.touches.item(0)),t?{x:t.pageX,y:t.pageY}:void 0}function onload2(){var t={};for(var e in document.getElementsByTagName("use").forEach((function(e){var n=e.href.baseVal.replace(/^#/,"");t[n]||(t[n]=document.getElementById(n),debugJSConstraints&&console.log("template %o: %o",n,t[n]))})),t){applyConstraints("#"+e,applyInlineConstraints),$(e).children.some((function(t){return"constraints"===t.tagName}))&&applyConstraints("#"+e,applyOwnedConstraints);var n=$(e).getAttribute("movable");n&&(debugJSConstraints&&console.log("movable: %o",e),n.split(" ").forEach((function(t){applyConstraints("#"+e,(function(e){registerMove(e,t)}))})))}for(var e in t)$(e).children.some((function(t){return"settings"===t.tagName}))&&applyConstraints("#"+e,(function(t){applyOwnedConstraints(t,"settings")}));return svg=document.getElementsByTagName("svg")[0],svg.ontouchend=svg.onmouseup=function(t){svg.setAttribute("style","cursor: default");getPosition(t);return moving?(debugEvents&&console.log("mouseup|touchend x=%d, y=%d",moving.x.variable.value,moving.y.variable.value),solver.endEdit(),moving.onmouseup&&moving.onmouseup(t),moving=void 0):movingName&&(movingName=void 0),!0},svg.ontouchmove=svg.onmousemove=function(t){var e=getPosition(t);return moving?(debugEvents&&console.log("mousemove|touchmove x=%d, dx=%d, pos.x=%d",moving.x.variable.value,dx,e.x),function(t){debugEvents&&console.log("suggesting: %o=%o, %o=%o",moving.x.variable,t.x-dx,moving.y.variable,t.y-dy),moving.suggest(t.x-dx,t.y-dy)}(e),applySwitchConstraints(),move()):movingName&&(movingName.setAttribute("x",e.x-dx),movingName.setAttribute("y",e.y-dy)),!0},window.showStatus=function(t){var e=getWrapper(t);e&&console.log(t+": "+e.toString())},(debugInlineConstraints||times)&&console.log("created constraints in %oms.",(new Date).getTime()-startTime),window.solver.autoSolve=!0,solver.addEditVar(INTER_MESSAGE_MARGIN.variable),solver.suggestValue(INTER_MESSAGE_MARGIN.variable,30),solver.resolve(),move(),void((debugInlineConstraints||times)&&console.log("Initialization complete in %oms.",(new Date).getTime()-startTime))}var conditionalConstraints=[];function addConditionalConstraint(t){conditionalConstraints.push(t)}function applySwitchConstraints(){for(var t,e=0;e<conditionalConstraints.length;e++)(t=conditionalConstraints[e]()).add(),t.remove()}function placePortOnEdge(t,e){function n(t){return t.variable.value}return function(){var i=n(t.x)+n(t.width)/2,r=n(e.x),o=n(e.width),a=n(t.y)+n(t.height)/2,s=n(e.y),l=n(e.height),u=[{dist:Math.abs(i-r),cons:t.center.onSegment(e.left)},{dist:Math.abs(i-(r+o)),cons:t.center.onSegment(e.right)},{dist:Math.abs(a-s),cons:t.center.onSegment(e.top)},{dist:Math.abs(a-(s+l)),cons:t.center.onSegment(e.bottom)}];return(u=u.sort((function(t,e){return t.dist-e.dist})))[0].cons}}try{document.getElementsByTagName("defs")[0].innerHTML=templates}catch(t){}}]);